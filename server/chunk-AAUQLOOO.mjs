import './polyfills.server.mjs';
import{$ as Ps,A as Is,Aa as $s,B as Un,C as S,D as A,E as br,F as Cr,G as Er,H as wr,I as Ne,J as k,K as Hn,L as Bn,M as Ln,N as W,O as xr,P as Mt,Q as jn,R as Gn,S as Wn,T as Dt,U as Or,V as ks,X as Vs,a as Os,b as Ss,ba as Ts,c as Ms,d as Ds,da as zn,e as vr,ea as At,f as xt,fa as we,g as Vn,ga as Fs,h as tt,ha as $n,i as yr,j as Pn,ja as Rs,k as Q,ka as qs,l as Tn,la as Us,m as rt,ma as Hs,n as nt,na as Bs,o as As,oa as Ls,p as Fn,pa as js,q as Ot,qa as Gs,r as Rn,s as x,t as I,ta as Ws,u as qn,v as St,w as Ee,x as Ae,xa as zs,y as Ns,z as H}from"./chunk-P5QW7VY6.mjs";import{a as T,b as ie,c as p,e as h,g as dh,h as kn}from"./chunk-5XUXGTUW.mjs";var ke=h((bm,Qs)=>{"use strict";var fh=p("crypto"),Js="abcdefghijklmnopqrstuvwxyz012345";Qs.exports={string:function(e){for(var t=Js.length,r=fh.randomBytes(e),n=[],i=0;i<e;i++)n.push(Js.substr(r[i]%t,1));return n.join("")},number:function(e){return Math.floor(Math.random()*e)},numberString:function(e){var t=(""+(e-1)).length,r=new Array(t+1).join("0");return(r+this.number(e)).slice(-t)}}});var xe=h((Cm,Ir)=>{"use strict";var ph=ke(),st={},Kn=!1,Zs=global.chrome&&global.chrome.app&&global.chrome.app.runtime;Ir.exports={attachEvent:function(e,t){typeof global.addEventListener<"u"?global.addEventListener(e,t,!1):global.document&&global.attachEvent&&(global.document.attachEvent("on"+e,t),global.attachEvent("on"+e,t))},detachEvent:function(e,t){typeof global.addEventListener<"u"?global.removeEventListener(e,t,!1):global.document&&global.detachEvent&&(global.document.detachEvent("on"+e,t),global.detachEvent("on"+e,t))},unloadAdd:function(e){if(Zs)return null;var t=ph.string(8);return st[t]=e,Kn&&setTimeout(this.triggerUnloadCallbacks,0),t},unloadDel:function(e){e in st&&delete st[e]},triggerUnloadCallbacks:function(){for(var e in st)st[e](),delete st[e]}};var gh=function(){Kn||(Kn=!0,Ir.exports.triggerUnloadCallbacks())};Zs||Ir.exports.attachEvent("unload",gh)});var to=h((Em,eo)=>{"use strict";eo.exports=function(t,r){if(r=r.split(":")[0],t=+t,!t)return!1;switch(r){case"http":case"ws":return t!==80;case"https":case"wss":return t!==443;case"ftp":return t!==21;case"gopher":return t!==70;case"file":return!1}return t!==0}});var io=h(Xn=>{"use strict";var mh=Object.prototype.hasOwnProperty,_h;function ro(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch{return null}}function no(e){try{return encodeURIComponent(e)}catch{return null}}function vh(e){for(var t=/([^=?#&]+)=?([^&]*)/g,r={},n;n=t.exec(e);){var i=ro(n[1]),s=ro(n[2]);i===null||s===null||i in r||(r[i]=s)}return r}function yh(e,t){t=t||"";var r=[],n,i;typeof t!="string"&&(t="?");for(i in e)if(mh.call(e,i)){if(n=e[i],!n&&(n===null||n===_h||isNaN(n))&&(n=""),i=no(i),n=no(n),i===null||n===null)continue;r.push(i+"="+n)}return r.length?t+r.join("&"):""}Xn.stringify=yh;Xn.parse=vh});var Vr=h((xm,ho)=>{"use strict";var oo=to(),kr=io(),bh=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,ao=/[\n\r\t]/g,Ch=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,co=/:\d+$/,Eh=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,wh=/^[a-zA-Z]:/;function Jn(e){return(e||"").toString().replace(bh,"")}var Yn=[["#","hash"],["?","query"],function(t,r){return se(r.protocol)?t.replace(/\\/g,"/"):t},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],so={hash:1,query:1};function uo(e){var t;typeof window<"u"?t=window:typeof global<"u"?t=global:typeof self<"u"?t=self:t={};var r=t.location||{};e=e||r;var n={},i=typeof e,s;if(e.protocol==="blob:")n=new oe(unescape(e.pathname),{});else if(i==="string"){n=new oe(e,{});for(s in so)delete n[s]}else if(i==="object"){for(s in e)s in so||(n[s]=e[s]);n.slashes===void 0&&(n.slashes=Ch.test(e.href))}return n}function se(e){return e==="file:"||e==="ftp:"||e==="http:"||e==="https:"||e==="ws:"||e==="wss:"}function lo(e,t){e=Jn(e),e=e.replace(ao,""),t=t||{};var r=Eh.exec(e),n=r[1]?r[1].toLowerCase():"",i=!!r[2],s=!!r[3],o=0,a;return i?s?(a=r[2]+r[3]+r[4],o=r[2].length+r[3].length):(a=r[2]+r[4],o=r[2].length):s?(a=r[3]+r[4],o=r[3].length):a=r[4],n==="file:"?o>=2&&(a=a.slice(2)):se(n)?a=r[4]:n?i&&(a=a.slice(2)):o>=2&&se(t.protocol)&&(a=r[4]),{protocol:n,slashes:i||se(n),slashesCount:o,rest:a}}function xh(e,t){if(e==="")return t;for(var r=(t||"/").split("/").slice(0,-1).concat(e.split("/")),n=r.length,i=r[n-1],s=!1,o=0;n--;)r[n]==="."?r.splice(n,1):r[n]===".."?(r.splice(n,1),o++):o&&(n===0&&(s=!0),r.splice(n,1),o--);return s&&r.unshift(""),(i==="."||i==="..")&&r.push(""),r.join("/")}function oe(e,t,r){if(e=Jn(e),e=e.replace(ao,""),!(this instanceof oe))return new oe(e,t,r);var n,i,s,o,a,c,u=Yn.slice(),d=typeof t,l=this,g=0;for(d!=="object"&&d!=="string"&&(r=t,t=null),r&&typeof r!="function"&&(r=kr.parse),t=uo(t),i=lo(e||"",t),n=!i.protocol&&!i.slashes,l.slashes=i.slashes||n&&t.slashes,l.protocol=i.protocol||t.protocol||"",e=i.rest,(i.protocol==="file:"&&(i.slashesCount!==2||wh.test(e))||!i.slashes&&(i.protocol||i.slashesCount<2||!se(l.protocol)))&&(u[3]=[/(.*)/,"pathname"]);g<u.length;g++){if(o=u[g],typeof o=="function"){e=o(e,l);continue}s=o[0],c=o[1],s!==s?l[c]=e:typeof s=="string"?(a=s==="@"?e.lastIndexOf(s):e.indexOf(s),~a&&(typeof o[2]=="number"?(l[c]=e.slice(0,a),e=e.slice(a+o[2])):(l[c]=e.slice(a),e=e.slice(0,a)))):(a=s.exec(e))&&(l[c]=a[1],e=e.slice(0,a.index)),l[c]=l[c]||n&&o[3]&&t[c]||"",o[4]&&(l[c]=l[c].toLowerCase())}r&&(l.query=r(l.query)),n&&t.slashes&&l.pathname.charAt(0)!=="/"&&(l.pathname!==""||t.pathname!=="")&&(l.pathname=xh(l.pathname,t.pathname)),l.pathname.charAt(0)!=="/"&&se(l.protocol)&&(l.pathname="/"+l.pathname),oo(l.port,l.protocol)||(l.host=l.hostname,l.port=""),l.username=l.password="",l.auth&&(a=l.auth.indexOf(":"),~a?(l.username=l.auth.slice(0,a),l.username=encodeURIComponent(decodeURIComponent(l.username)),l.password=l.auth.slice(a+1),l.password=encodeURIComponent(decodeURIComponent(l.password))):l.username=encodeURIComponent(decodeURIComponent(l.auth)),l.auth=l.password?l.username+":"+l.password:l.username),l.origin=l.protocol!=="file:"&&se(l.protocol)&&l.host?l.protocol+"//"+l.host:"null",l.href=l.toString()}function Oh(e,t,r){var n=this;switch(e){case"query":typeof t=="string"&&t.length&&(t=(r||kr.parse)(t)),n[e]=t;break;case"port":n[e]=t,oo(t,n.protocol)?t&&(n.host=n.hostname+":"+t):(n.host=n.hostname,n[e]="");break;case"hostname":n[e]=t,n.port&&(t+=":"+n.port),n.host=t;break;case"host":n[e]=t,co.test(t)?(t=t.split(":"),n.port=t.pop(),n.hostname=t.join(":")):(n.hostname=t,n.port="");break;case"protocol":n.protocol=t.toLowerCase(),n.slashes=!r;break;case"pathname":case"hash":if(t){var i=e==="pathname"?"/":"#";n[e]=t.charAt(0)!==i?i+t:t}else n[e]=t;break;case"username":case"password":n[e]=encodeURIComponent(t);break;case"auth":var s=t.indexOf(":");~s?(n.username=t.slice(0,s),n.username=encodeURIComponent(decodeURIComponent(n.username)),n.password=t.slice(s+1),n.password=encodeURIComponent(decodeURIComponent(n.password))):n.username=encodeURIComponent(decodeURIComponent(t))}for(var o=0;o<Yn.length;o++){var a=Yn[o];a[4]&&(n[a[1]]=n[a[1]].toLowerCase())}return n.auth=n.password?n.username+":"+n.password:n.username,n.origin=n.protocol!=="file:"&&se(n.protocol)&&n.host?n.protocol+"//"+n.host:"null",n.href=n.toString(),n}function Sh(e){(!e||typeof e!="function")&&(e=kr.stringify);var t,r=this,n=r.host,i=r.protocol;i&&i.charAt(i.length-1)!==":"&&(i+=":");var s=i+(r.protocol&&r.slashes||se(r.protocol)?"//":"");return r.username?(s+=r.username,r.password&&(s+=":"+r.password),s+="@"):r.password?(s+=":"+r.password,s+="@"):r.protocol!=="file:"&&se(r.protocol)&&!n&&r.pathname!=="/"&&(s+="@"),(n[n.length-1]===":"||co.test(r.hostname)&&!r.port)&&(n+=":"),s+=n+r.pathname,t=typeof r.query=="object"?e(r.query):r.query,t&&(s+=t.charAt(0)!=="?"?"?"+t:t),r.hash&&(s+=r.hash),s}oe.prototype={set:Oh,toString:Sh};oe.extractProtocol=lo;oe.location=uo;oe.trimLeft=Jn;oe.qs=kr;ho.exports=oe});var po=h((Om,fo)=>{"use strict";var ot=1e3,at=ot*60,ct=at*60,Ve=ct*24,Mh=Ve*7,Dh=Ve*365.25;fo.exports=function(e,t){t=t||{};var r=typeof e;if(r==="string"&&e.length>0)return Ah(e);if(r==="number"&&isFinite(e))return t.long?Ih(e):Nh(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function Ah(e){if(e=String(e),!(e.length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var r=parseFloat(t[1]),n=(t[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*Dh;case"weeks":case"week":case"w":return r*Mh;case"days":case"day":case"d":return r*Ve;case"hours":case"hour":case"hrs":case"hr":case"h":return r*ct;case"minutes":case"minute":case"mins":case"min":case"m":return r*at;case"seconds":case"second":case"secs":case"sec":case"s":return r*ot;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function Nh(e){var t=Math.abs(e);return t>=Ve?Math.round(e/Ve)+"d":t>=ct?Math.round(e/ct)+"h":t>=at?Math.round(e/at)+"m":t>=ot?Math.round(e/ot)+"s":e+"ms"}function Ih(e){var t=Math.abs(e);return t>=Ve?Pr(e,t,Ve,"day"):t>=ct?Pr(e,t,ct,"hour"):t>=at?Pr(e,t,at,"minute"):t>=ot?Pr(e,t,ot,"second"):e+" ms"}function Pr(e,t,r,n){var i=t>=r*1.5;return Math.round(e/r)+" "+n+(i?"s":"")}});var Qn=h((Sm,go)=>{"use strict";function kh(e){r.debug=r,r.default=r,r.coerce=c,r.disable=o,r.enable=s,r.enabled=a,r.humanize=po(),Object.keys(e).forEach(function(u){r[u]=e[u]}),r.instances=[],r.names=[],r.skips=[],r.formatters={};function t(u){for(var d=0,l=0;l<u.length;l++)d=(d<<5)-d+u.charCodeAt(l),d|=0;return r.colors[Math.abs(d)%r.colors.length]}r.selectColor=t;function r(u){var d;function l(){if(l.enabled){for(var g=arguments.length,y=new Array(g),P=0;P<g;P++)y[P]=arguments[P];var J=l,b=Number(new Date),j=b-(d||b);J.diff=j,J.prev=d,J.curr=b,d=b,y[0]=r.coerce(y[0]),typeof y[0]!="string"&&y.unshift("%O");var q=0;y[0]=y[0].replace(/%([a-zA-Z%])/g,function(re,Ye){if(re==="%%")return re;q++;var U=r.formatters[Ye];if(typeof U=="function"){var ne=y[q];re=U.call(J,ne),y.splice(q,1),q--}return re}),r.formatArgs.call(J,y);var pe=J.log||r.log;pe.apply(J,y)}}return l.namespace=u,l.enabled=r.enabled(u),l.useColors=r.useColors(),l.color=t(u),l.destroy=n,l.extend=i,typeof r.init=="function"&&r.init(l),r.instances.push(l),l}function n(){var u=r.instances.indexOf(this);return u!==-1?(r.instances.splice(u,1),!0):!1}function i(u,d){return r(this.namespace+(typeof d>"u"?":":d)+u)}function s(u){r.save(u),r.names=[],r.skips=[];var d,l=(typeof u=="string"?u:"").split(/[\s,]+/),g=l.length;for(d=0;d<g;d++)l[d]&&(u=l[d].replace(/\*/g,".*?"),u[0]==="-"?r.skips.push(new RegExp("^"+u.substr(1)+"$")):r.names.push(new RegExp("^"+u+"$")));for(d=0;d<r.instances.length;d++){var y=r.instances[d];y.enabled=r.enabled(y.namespace)}}function o(){r.enable("")}function a(u){if(u[u.length-1]==="*")return!0;var d,l;for(d=0,l=r.skips.length;d<l;d++)if(r.skips[d].test(u))return!1;for(d=0,l=r.names.length;d<l;d++)if(r.names[d].test(u))return!0;return!1}function c(u){return u instanceof Error?u.stack||u.message:u}return r.enable(r.load()),r}go.exports=kh});var mo=h((z,Fr)=>{"use strict";function Tr(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Tr=function(r){return typeof r}:Tr=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Tr(e)}z.log=Th;z.formatArgs=Ph;z.save=Fh;z.load=Rh;z.useColors=Vh;z.storage=qh();z.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function Vh(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function Ph(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+Fr.exports.humanize(this.diff),!!this.useColors){var t="color: "+this.color;e.splice(1,0,t,"color: inherit");var r=0,n=0;e[0].replace(/%[a-zA-Z%]/g,function(i){i!=="%%"&&(r++,i==="%c"&&(n=r))}),e.splice(n,0,t)}}function Th(){var e;return(typeof console>"u"?"undefined":Tr(console))==="object"&&console.log&&(e=console).log.apply(e,arguments)}function Fh(e){try{e?z.storage.setItem("debug",e):z.storage.removeItem("debug")}catch{}}function Rh(){var e;try{e=z.storage.getItem("debug")}catch{}return!e&&typeof process<"u"&&"env"in process&&(e=process.env.DEBUG),e}function qh(){try{return localStorage}catch{}}Fr.exports=Qn()(z);var Uh=Fr.exports.formatters;Uh.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}});var vo=h((Mm,_o)=>{"use strict";_o.exports=(e,t=process.argv)=>{let r=e.startsWith("-")?"":e.length===1?"-":"--",n=t.indexOf(r+e),i=t.indexOf("--");return n!==-1&&(i===-1||n<i)}});var Co=h((Dm,bo)=>{"use strict";var Hh=p("os"),yo=p("tty"),$=vo(),{env:N}=process,Oe;$("no-color")||$("no-colors")||$("color=false")||$("color=never")?Oe=0:($("color")||$("colors")||$("color=true")||$("color=always"))&&(Oe=1);"FORCE_COLOR"in N&&(N.FORCE_COLOR==="true"?Oe=1:N.FORCE_COLOR==="false"?Oe=0:Oe=N.FORCE_COLOR.length===0?1:Math.min(parseInt(N.FORCE_COLOR,10),3));function Zn(e){return e===0?!1:{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}function ei(e,t){if(Oe===0)return 0;if($("color=16m")||$("color=full")||$("color=truecolor"))return 3;if($("color=256"))return 2;if(e&&!t&&Oe===void 0)return 0;let r=Oe||0;if(N.TERM==="dumb")return r;if(process.platform==="win32"){let n=Hh.release().split(".");return Number(n[0])>=10&&Number(n[2])>=10586?Number(n[2])>=14931?3:2:1}if("CI"in N)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some(n=>n in N)||N.CI_NAME==="codeship"?1:r;if("TEAMCITY_VERSION"in N)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(N.TEAMCITY_VERSION)?1:0;if(N.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in N){let n=parseInt((N.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(N.TERM_PROGRAM){case"iTerm.app":return n>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(N.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(N.TERM)||"COLORTERM"in N?1:r}function Bh(e){let t=ei(e,e&&e.isTTY);return Zn(t)}bo.exports={supportsColor:Bh,stdout:Zn(ei(!0,yo.isatty(1))),stderr:Zn(ei(!0,yo.isatty(2)))}});var wo=h((V,Ur)=>{"use strict";var Lh=p("tty"),qr=p("util");V.init=Xh;V.log=zh;V.formatArgs=Gh;V.save=$h;V.load=Kh;V.useColors=jh;V.colors=[6,2,3,4,5,1];try{Rr=Co(),Rr&&(Rr.stderr||Rr).level>=2&&(V.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}var Rr;V.inspectOpts=Object.keys(process.env).filter(function(e){return/^debug_/i.test(e)}).reduce(function(e,t){var r=t.substring(6).toLowerCase().replace(/_([a-z])/g,function(i,s){return s.toUpperCase()}),n=process.env[t];return/^(yes|on|true|enabled)$/i.test(n)?n=!0:/^(no|off|false|disabled)$/i.test(n)?n=!1:n==="null"?n=null:n=Number(n),e[r]=n,e},{});function jh(){return"colors"in V.inspectOpts?!!V.inspectOpts.colors:Lh.isatty(process.stderr.fd)}function Gh(e){var t=this.namespace,r=this.useColors;if(r){var n=this.color,i="\x1B[3"+(n<8?n:"8;5;"+n),s="  ".concat(i,";1m").concat(t," \x1B[0m");e[0]=s+e[0].split(`
`).join(`
`+s),e.push(i+"m+"+Ur.exports.humanize(this.diff)+"\x1B[0m")}else e[0]=Wh()+t+" "+e[0]}function Wh(){return V.inspectOpts.hideDate?"":new Date().toISOString()+" "}function zh(){return process.stderr.write(qr.format.apply(qr,arguments)+`
`)}function $h(e){e?process.env.DEBUG=e:delete process.env.DEBUG}function Kh(){return process.env.DEBUG}function Xh(e){e.inspectOpts={};for(var t=Object.keys(V.inspectOpts),r=0;r<t.length;r++)e.inspectOpts[t[r]]=V.inspectOpts[t[r]]}Ur.exports=Qn()(V);var Eo=Ur.exports.formatters;Eo.o=function(e){return this.inspectOpts.colors=this.useColors,qr.inspect(e,this.inspectOpts).split(`
`).map(function(t){return t.trim()}).join(" ")};Eo.O=function(e){return this.inspectOpts.colors=this.useColors,qr.inspect(e,this.inspectOpts)}});var E=h((Am,ti)=>{"use strict";typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?ti.exports=mo():ti.exports=wo()});var K=h((Nm,Oo)=>{"use strict";var Yh=Vr(),xo=function(){};process.env.NODE_ENV!=="production"&&(xo=E()("sockjs-client:utils:url"));Oo.exports={getOrigin:function(e){if(!e)return null;var t=new Yh(e);if(t.protocol==="file:")return null;var r=t.port;return r||(r=t.protocol==="https:"?"443":"80"),t.protocol+"//"+t.hostname+":"+r},isOriginEqual:function(e,t){var r=this.getOrigin(e)===this.getOrigin(t);return xo("same",e,t,r),r},isSchemeEqual:function(e,t){return e.split(":")[0]===t.split(":")[0]},addPath:function(e,t){var r=e.split("?");return r[0]+t+(r[1]?"?"+r[1]:"")},addQuery:function(e,t){return e+(e.indexOf("?")===-1?"?"+t:"&"+t)},isLoopbackAddr:function(e){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^\[::1\]$/.test(e)}}});var So=h((Im,ri)=>{"use strict";typeof Object.create=="function"?ri.exports=function(t,r){r&&(t.super_=r,t.prototype=Object.create(r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:ri.exports=function(t,r){if(r){t.super_=r;var n=function(){};n.prototype=r.prototype,t.prototype=new n,t.prototype.constructor=t}}});var _=h((km,ii)=>{"use strict";try{if(ni=p("util"),typeof ni.inherits!="function")throw"";ii.exports=ni.inherits}catch{ii.exports=So()}var ni});var ce=h((si,Do)=>{"use strict";var Hr=p("buffer"),ae=Hr.Buffer;function Mo(e,t){for(var r in e)t[r]=e[r]}ae.from&&ae.alloc&&ae.allocUnsafe&&ae.allocUnsafeSlow?Do.exports=Hr:(Mo(Hr,si),si.Buffer=Pe);function Pe(e,t,r){return ae(e,t,r)}Pe.prototype=Object.create(ae.prototype);Mo(ae,Pe);Pe.from=function(e,t,r){if(typeof e=="number")throw new TypeError("Argument must not be a number");return ae(e,t,r)};Pe.alloc=function(e,t,r){if(typeof e!="number")throw new TypeError("Argument must be a number");var n=ae(e);return t!==void 0?typeof r=="string"?n.fill(t,r):n.fill(t):n.fill(0),n};Pe.allocUnsafe=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return ae(e)};Pe.allocUnsafeSlow=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return Hr.SlowBuffer(e)}});var Io=h(oi=>{"use strict";var Ao=p("stream").Stream,No=p("util"),Te=function(e){this.readable=this.writable=!0,this._paused=!1,this._driver=e};No.inherits(Te,Ao);Te.prototype.pause=function(){this._paused=!0,this._driver.messages._paused=!0};Te.prototype.resume=function(){this._paused=!1,this.emit("drain");var e=this._driver.messages;e._paused=!1,e.emit("drain")};Te.prototype.write=function(e){return this.writable?(this._driver.parse(e),!this._paused):!1};Te.prototype.end=function(e){if(this.writable){e!==void 0&&this.write(e),this.writable=!1;var t=this._driver.messages;t.readable&&(t.readable=t.writable=!1,t.emit("end"))}};Te.prototype.destroy=function(){this.end()};var Fe=function(e){this.readable=this.writable=!0,this._paused=!1,this._driver=e};No.inherits(Fe,Ao);Fe.prototype.pause=function(){this._driver.io._paused=!0};Fe.prototype.resume=function(){this._driver.io._paused=!1,this._driver.io.emit("drain")};Fe.prototype.write=function(e){return this.writable?(typeof e=="string"?this._driver.text(e):this._driver.binary(e),!this._paused):!1};Fe.prototype.end=function(e){e!==void 0&&this.write(e)};Fe.prototype.destroy=function(){};oi.IO=Te;oi.Messages=Fe});var Br=h((Pm,ko)=>{"use strict";var ut=function(){this.clear()};ut.prototype.ALLOWED_DUPLICATES=["set-cookie","set-cookie2","warning","www-authenticate"];ut.prototype.clear=function(){this._sent={},this._lines=[]};ut.prototype.set=function(e,t){if(t!==void 0){e=this._strip(e),t=this._strip(t);var r=e.toLowerCase();(!this._sent.hasOwnProperty(r)||this.ALLOWED_DUPLICATES.indexOf(r)>=0)&&(this._sent[r]=!0,this._lines.push(e+": "+t+`\r
`))}};ut.prototype.toString=function(){return this._lines.join("")};ut.prototype._strip=function(e){return e.toString().replace(/^ */,"").replace(/ *$/,"")};ko.exports=ut});var Po=h((Tm,Vo)=>{"use strict";var Lr=ce().Buffer,jr=function(){this._queue=[],this._queueSize=0,this._offset=0};jr.prototype.put=function(e){!e||e.length===0||(Lr.isBuffer(e)||(e=Lr.from(e)),this._queue.push(e),this._queueSize+=e.length)};jr.prototype.read=function(e){if(e>this._queueSize)return null;if(e===0)return Lr.alloc(0);this._queueSize-=e;var t=this._queue,r=e,n=t[0],i,s;if(n.length>=e)return n.length===e?t.shift():(s=n.slice(0,e),t[0]=n.slice(e),s);for(var o=0,a=t.length;o<a&&!(r<t[o].length);o++)r-=t[o].length;return i=t.splice(0,o),r>0&&t.length>0&&(i.push(t[0].slice(0,r)),t[0]=t[0].slice(r)),Lr.concat(i,e)};jr.prototype.eachByte=function(e,t){for(var r,n,i;this._queue.length>0;){for(r=this._queue[0],n=r.length;this._offset<n;)i=this._offset,this._offset+=1,e.call(t,r[i]);this._offset=0,this._queue.shift()}};Vo.exports=jr});var Se=h((Fm,Ho)=>{"use strict";var To=ce().Buffer,qo=p("events").EventEmitter,Jh=p("util"),Fo=Io(),Uo=Br(),Qh=Po(),F=function(e,t,r){qo.call(this),F.validateOptions(r||{},["maxLength","masking","requireMasking","protocols"]),this._request=e,this._reader=new Qh,this._options=r||{},this._maxLength=this._options.maxLength||this.MAX_LENGTH,this._headers=new Uo,this.__queue=[],this.readyState=0,this.url=t,this.io=new Fo.IO(this),this.messages=new Fo.Messages(this),this._bindEventListeners()};Jh.inherits(F,qo);F.isWebSocket=function(e){var t=e.headers.connection||"",r=e.headers.upgrade||"";return e.method==="GET"&&t.toLowerCase().split(/ *, */).indexOf("upgrade")>=0&&r.toLowerCase()==="websocket"};F.validateOptions=function(e,t){for(var r in e)if(t.indexOf(r)<0)throw new Error("Unrecognized option: "+r)};var Ro={MAX_LENGTH:67108863,STATES:["connecting","open","closing","closed"],_bindEventListeners:function(){var e=this;this.messages.on("error",function(){}),this.on("message",function(t){var r=e.messages;r.readable&&r.emit("data",t.data)}),this.on("error",function(t){var r=e.messages;r.readable&&r.emit("error",t)}),this.on("close",function(){var t=e.messages;t.readable&&(t.readable=t.writable=!1,t.emit("end"))})},getState:function(){return this.STATES[this.readyState]||null},addExtension:function(e){return!1},setHeader:function(e,t){return this.readyState>0?!1:(this._headers.set(e,t),!0)},start:function(){if(this.readyState!==0)return!1;if(!F.isWebSocket(this._request))return this._failHandshake(new Error("Not a WebSocket request"));var e;try{e=this._handshakeResponse()}catch(t){return this._failHandshake(t)}return this._write(e),this._stage!==-1&&this._open(),!0},_failHandshake:function(e){var t=new Uo;return t.set("Content-Type","text/plain"),t.set("Content-Length",To.byteLength(e.message,"utf8")),t=["HTTP/1.1 400 Bad Request",t.toString(),e.message],this._write(To.from(t.join(`\r
`),"utf8")),this._fail("protocol_error",e.message),!1},text:function(e){return this.frame(e)},binary:function(e){return!1},ping:function(){return!1},pong:function(){return!1},close:function(e,t){return this.readyState!==1?!1:(this.readyState=3,this.emit("close",new F.CloseEvent(null,null)),!0)},_open:function(){this.readyState=1,this.__queue.forEach(function(e){this.frame.apply(this,e)},this),this.__queue=[],this.emit("open",new F.OpenEvent)},_queue:function(e){return this.__queue.push(e),!0},_write:function(e){var t=this.io;t.readable&&t.emit("data",e)},_fail:function(e,t){this.readyState=2,this.emit("error",new Error(t)),this.close()}};for(ai in Ro)F.prototype[ai]=Ro[ai];var ai;F.ConnectEvent=function(){};F.OpenEvent=function(){};F.CloseEvent=function(e,t){this.code=e,this.reason=t};F.MessageEvent=function(e){this.data=e};F.PingEvent=function(e){this.data=e};F.PongEvent=function(e){this.data=e};Ho.exports=F});var Wo=h(li=>{"use strict";li.HTTPParser=f;function f(e){if(e!==void 0&&e!==f.REQUEST&&e!==f.RESPONSE)throw new Error("type must be REQUEST or RESPONSE");e===void 0||this.initialize(e),this.maxHeaderSize=f.maxHeaderSize}f.prototype.initialize=function(e,t){if(e!==f.REQUEST&&e!==f.RESPONSE)throw new Error("type must be REQUEST or RESPONSE");this.type=e,this.state=e+"_LINE",this.info={headers:[],upgrade:!1},this.trailers=[],this.line="",this.isChunked=!1,this.connection="",this.headerSize=0,this.body_bytes=null,this.isUserCall=!1,this.hadError=!1};f.encoding="ascii";f.maxHeaderSize=80*1024;f.REQUEST="REQUEST";f.RESPONSE="RESPONSE";var Bo=f.kOnHeaders=1,ci=f.kOnHeadersComplete=2,Gr=f.kOnBody=3,ui=f.kOnMessageComplete=4;f.prototype[Bo]=f.prototype[ci]=f.prototype[Gr]=f.prototype[ui]=function(){};var Lo=!0;Object.defineProperty(f,"kOnExecute",{get:function(){return Lo=!1,99}});var jo=li.methods=f.methods=["DELETE","GET","HEAD","POST","PUT","CONNECT","OPTIONS","TRACE","COPY","LOCK","MKCOL","MOVE","PROPFIND","PROPPATCH","SEARCH","UNLOCK","BIND","REBIND","UNBIND","ACL","REPORT","MKACTIVITY","CHECKOUT","MERGE","M-SEARCH","NOTIFY","SUBSCRIBE","UNSUBSCRIBE","PATCH","PURGE","MKCALENDAR","LINK","UNLINK","SOURCE"],Go=jo.indexOf("CONNECT");f.prototype.reinitialize=f;f.prototype.close=f.prototype.pause=f.prototype.resume=f.prototype.remove=f.prototype.free=function(){};f.prototype._compatMode0_11=!1;f.prototype.getAsyncId=function(){return 0};var Zh={REQUEST_LINE:!0,RESPONSE_LINE:!0,HEADER:!0};f.prototype.execute=function(e,t,r){if(!(this instanceof f))throw new TypeError("not a HTTPParser");t=t||0,r=typeof r=="number"?r:e.length,this.chunk=e,this.offset=t;var n=this.end=t+r;try{for(;this.offset<n&&!this[this.state](););}catch(i){if(this.isUserCall)throw i;return this.hadError=!0,i}return this.chunk=null,r=this.offset-t,Zh[this.state]&&(this.headerSize+=r,this.headerSize>(this.maxHeaderSize||f.maxHeaderSize))?new Error("max header size exceeded"):r};var ed={REQUEST_LINE:!0,RESPONSE_LINE:!0,BODY_RAW:!0};f.prototype.finish=function(){if(!this.hadError){if(!ed[this.state])return new Error("invalid state for EOF");this.state==="BODY_RAW"&&this.userCall()(this[ui]())}};f.prototype.consume=f.prototype.unconsume=f.prototype.getCurrentBuffer=function(){};f.prototype.userCall=function(){this.isUserCall=!0;var e=this;return function(t){return e.isUserCall=!1,t}};f.prototype.nextRequest=function(){this.userCall()(this[ui]()),this.reinitialize(this.type)};f.prototype.consumeLine=function(){for(var e=this.end,t=this.chunk,r=this.offset;r<e;r++)if(t[r]===10){var n=this.line+t.toString(f.encoding,this.offset,r);return n.charAt(n.length-1)==="\r"&&(n=n.substr(0,n.length-1)),this.line="",this.offset=r+1,n}this.line+=t.toString(f.encoding,this.offset,this.end),this.offset=this.end};var td=/^([^: \t]+):[ \t]*((?:.*[^ \t])|)/,rd=/^[ \t]+(.*[^ \t])/;f.prototype.parseHeader=function(e,t){if(e.indexOf("\r")!==-1)throw Wr("HPE_LF_EXPECTED");var r=td.exec(e),n=r&&r[1];if(n)t.push(n),t.push(r[2]);else{var i=rd.exec(e);i&&t.length&&(t[t.length-1]&&(t[t.length-1]+=" "),t[t.length-1]+=i[1])}};var nd=/^([A-Z-]+) ([^ ]+) HTTP\/(\d)\.(\d)$/;f.prototype.REQUEST_LINE=function(){var e=this.consumeLine();if(e){var t=nd.exec(e);if(t===null)throw Wr("HPE_INVALID_CONSTANT");if(this.info.method=this._compatMode0_11?t[1]:jo.indexOf(t[1]),this.info.method===-1)throw new Error("invalid request method");this.info.url=t[2],this.info.versionMajor=+t[3],this.info.versionMinor=+t[4],this.body_bytes=0,this.state="HEADER"}};var id=/^HTTP\/(\d)\.(\d) (\d{3}) ?(.*)$/;f.prototype.RESPONSE_LINE=function(){var e=this.consumeLine();if(e){var t=id.exec(e);if(t===null)throw Wr("HPE_INVALID_CONSTANT");this.info.versionMajor=+t[1],this.info.versionMinor=+t[2];var r=this.info.statusCode=+t[3];this.info.statusMessage=t[4],((r/100|0)===1||r===204||r===304)&&(this.body_bytes=0),this.state="HEADER"}};f.prototype.shouldKeepAlive=function(){if(this.info.versionMajor>0&&this.info.versionMinor>0){if(this.connection.indexOf("close")!==-1)return!1}else if(this.connection.indexOf("keep-alive")===-1)return!1;return!!(this.body_bytes!==null||this.isChunked)};f.prototype.HEADER=function(){var e=this.consumeLine();if(e!==void 0){var t=this.info;if(e)this.parseHeader(e,t.headers);else{for(var r=t.headers,n=!1,i,s=!1,o=0;o<r.length;o+=2)switch(r[o].toLowerCase()){case"transfer-encoding":this.isChunked=r[o+1].toLowerCase()==="chunked";break;case"content-length":if(i=+r[o+1],n){if(i!==this.body_bytes)throw Wr("HPE_UNEXPECTED_CONTENT_LENGTH")}else n=!0,this.body_bytes=i;break;case"connection":this.connection+=r[o+1].toLowerCase();break;case"upgrade":s=!0;break}this.isChunked&&n&&(n=!1,this.body_bytes=null),s&&this.connection.indexOf("upgrade")!=-1?t.upgrade=this.type===f.REQUEST||t.statusCode===101:t.upgrade=t.method===Go,this.isChunked&&t.upgrade&&(this.isChunked=!1),t.shouldKeepAlive=this.shouldKeepAlive();var a;if(Lo?a=this.userCall()(this[ci](t)):a=this.userCall()(this[ci](t.versionMajor,t.versionMinor,t.headers,t.method,t.url,t.statusCode,t.statusMessage,t.upgrade,t.shouldKeepAlive)),a===2)return this.nextRequest(),!0;if(this.isChunked&&!a)this.state="BODY_CHUNKHEAD";else{if(a||this.body_bytes===0)return this.nextRequest(),t.upgrade;this.body_bytes===null?this.state="BODY_RAW":this.state="BODY_SIZED"}}}};f.prototype.BODY_CHUNKHEAD=function(){var e=this.consumeLine();e!==void 0&&(this.body_bytes=parseInt(e,16),this.body_bytes?this.state="BODY_CHUNK":this.state="BODY_CHUNKTRAILERS")};f.prototype.BODY_CHUNK=function(){var e=Math.min(this.end-this.offset,this.body_bytes);this.userCall()(this[Gr](this.chunk.slice(this.offset,this.offset+e),0,e)),this.offset+=e,this.body_bytes-=e,this.body_bytes||(this.state="BODY_CHUNKEMPTYLINE")};f.prototype.BODY_CHUNKEMPTYLINE=function(){var e=this.consumeLine();if(e!==void 0){if(e!=="")throw new Error("Expected empty line");this.state="BODY_CHUNKHEAD"}};f.prototype.BODY_CHUNKTRAILERS=function(){var e=this.consumeLine();e!==void 0&&(e?this.parseHeader(e,this.trailers):(this.trailers.length&&this.userCall()(this[Bo](this.trailers,"")),this.nextRequest()))};f.prototype.BODY_RAW=function(){this.userCall()(this[Gr](this.chunk.slice(this.offset,this.end),0,this.end-this.offset)),this.offset=this.end};f.prototype.BODY_SIZED=function(){var e=Math.min(this.end-this.offset,this.body_bytes);this.userCall()(this[Gr](this.chunk.slice(this.offset,this.offset+e),0,e)),this.offset+=e,this.body_bytes-=e,this.body_bytes||this.nextRequest()};["Headers","HeadersComplete","Body","MessageComplete"].forEach(function(e){var t=f["kOn"+e];Object.defineProperty(f.prototype,"on"+e,{get:function(){return this[t]},set:function(r){return this._compatMode0_11=!0,Go="CONNECT",this[t]=r}})});function Wr(e){var t=new Error("Parse Error");return t.code=e,t}});var $r=h((qm,$o)=>{"use strict";var zr=Wo().HTTPParser,sd=ce().Buffer,od={request:zr.REQUEST||"request",response:zr.RESPONSE||"response"},R=function(e){this._type=e,this._parser=new zr(od[e]),this._complete=!1,this.headers={};var t=null,r=this;this._parser.onHeaderField=function(n,i,s){t=n.toString("utf8",i,i+s).toLowerCase()},this._parser.onHeaderValue=function(n,i,s){var o=n.toString("utf8",i,i+s);r.headers.hasOwnProperty(t)?r.headers[t]+=", "+o:r.headers[t]=o},this._parser.onHeadersComplete=this._parser[zr.kOnHeadersComplete]=function(n,i,s,o,a,c){var u=arguments[0];if(typeof u=="object"&&(o=u.method,a=u.url,c=u.statusCode,s=u.headers),r.method=typeof o=="number"?R.METHODS[o]:o,r.statusCode=c,r.url=a,!!s){for(var d=0,l=s.length,g,y;d<l;d+=2)g=s[d].toLowerCase(),y=s[d+1],r.headers.hasOwnProperty(g)?r.headers[g]+=", "+y:r.headers[g]=y;r._complete=!0}}};R.METHODS={0:"DELETE",1:"GET",2:"HEAD",3:"POST",4:"PUT",5:"CONNECT",6:"OPTIONS",7:"TRACE",8:"COPY",9:"LOCK",10:"MKCOL",11:"MOVE",12:"PROPFIND",13:"PROPPATCH",14:"SEARCH",15:"UNLOCK",16:"BIND",17:"REBIND",18:"UNBIND",19:"ACL",20:"REPORT",21:"MKACTIVITY",22:"CHECKOUT",23:"MERGE",24:"M-SEARCH",25:"NOTIFY",26:"SUBSCRIBE",27:"UNSUBSCRIBE",28:"PATCH",29:"PURGE",30:"MKCALENDAR",31:"LINK",32:"UNLINK"};var zo=process.version?process.version.match(/[0-9]+/g).map(function(e){return parseInt(e,10)}):[];zo[0]===0&&zo[1]===12&&(R.METHODS[16]="REPORT",R.METHODS[17]="MKACTIVITY",R.METHODS[18]="CHECKOUT",R.METHODS[19]="MERGE",R.METHODS[20]="M-SEARCH",R.METHODS[21]="NOTIFY",R.METHODS[22]="SUBSCRIBE",R.METHODS[23]="UNSUBSCRIBE",R.METHODS[24]="PATCH",R.METHODS[25]="PURGE");R.prototype.isComplete=function(){return this._complete};R.prototype.parse=function(e){var t=this._parser.execute(e,0,e.length);if(typeof t!="number"){this.error=t,this._complete=!0;return}this._complete&&(this.body=t<e.length?e.slice(t):sd.alloc(0))};$o.exports=R});var Yo=h((Um,Xo)=>{"use strict";var hi=/([!#\$%&'\*\+\-\.\^_`\|~0-9A-Za-z]+)/,ad=/([^!#\$%&'\*\+\-\.\^_`\|~0-9A-Za-z])/g,cd=/"((?:\\[\x00-\x7f]|[^\x00-\x08\x0a-\x1f\x7f"\\])*)"/,di=new RegExp(hi.source+"(?:=(?:"+hi.source+"|"+cd.source+"))?"),fi=new RegExp(hi.source+"(?: *; *"+di.source+")*","g"),ud=new RegExp("^"+fi.source+"(?: *, *"+fi.source+")*$"),ld=/^-?(0|[1-9][0-9]*)(\.[0-9]+)?$/,Ko=Object.prototype.hasOwnProperty,hd={parseHeader:function(e){var t=new It;if(e===""||e===void 0)return t;if(!ud.test(e))throw new SyntaxError("Invalid Sec-WebSocket-Extensions header: "+e);var r=e.match(fi);return r.forEach(function(n){var i=n.match(new RegExp(di.source,"g")),s=i.shift(),o={};i.forEach(function(a){var c=a.match(di),u=c[1],d;c[2]!==void 0?d=c[2]:c[3]!==void 0?d=c[3].replace(/\\/g,""):d=!0,ld.test(d)&&(d=parseFloat(d)),Ko.call(o,u)?(o[u]=[].concat(o[u]),o[u].push(d)):o[u]=d},this),t.push(s,o)},this),t},serializeParams:function(e,t){var r=[],n=function(s,o){o instanceof Array?o.forEach(function(a){n(s,a)}):o===!0?r.push(s):typeof o=="number"?r.push(s+"="+o):ad.test(o)?r.push(s+'="'+o.replace(/"/g,'\\"')+'"'):r.push(s+"="+o)};for(var i in t)n(i,t[i]);return[e].concat(r).join("; ")}},It=function(){this._byName={},this._inOrder=[]};It.prototype.push=function(e,t){Ko.call(this._byName,e)||(this._byName[e]=[]),this._byName[e].push(t),this._inOrder.push({name:e,params:t})};It.prototype.eachOffer=function(e,t){for(var r=this._inOrder,n=0,i=r.length;n<i;n++)e.call(t,r[n].name,r[n].params)};It.prototype.byName=function(e){return this._byName[e]||[]};It.prototype.toArray=function(){return this._inOrder.slice()};Xo.exports=hd});var pi=h((Hm,Jo)=>{"use strict";var kt=function(e){this._bufferSize=e,this.clear()};kt.prototype.clear=function(){this._buffer=new Array(this._bufferSize),this._ringOffset=0,this._ringSize=this._bufferSize,this._head=0,this._tail=0,this.length=0};kt.prototype.push=function(e){var t=!1,r=!1;this._ringSize<this._bufferSize?t=this._tail===0:this._ringOffset===this._ringSize&&(t=!0,r=this._tail===0),t&&(this._tail=this._bufferSize,this._buffer=this._buffer.concat(new Array(this._bufferSize)),this._bufferSize=this._buffer.length,r&&(this._ringSize=this._bufferSize)),this._buffer[this._tail]=e,this.length+=1,this._tail<this._ringSize&&(this._ringOffset+=1),this._tail=(this._tail+1)%this._bufferSize};kt.prototype.peek=function(){if(this.length!==0)return this._buffer[this._head]};kt.prototype.shift=function(){if(this.length!==0){var e=this._buffer[this._head];return this._buffer[this._head]=void 0,this.length-=1,this._ringOffset-=1,this._ringOffset===0&&this.length>0?(this._head=this._ringSize,this._ringOffset=this.length,this._ringSize=this._bufferSize):this._head=(this._head+1)%this._ringSize,e}};Jo.exports=kt});var Zo=h((Bm,Qo)=>{"use strict";var dd=pi(),lt=function(e,t){this._session=e,this._method=t,this._queue=new dd(lt.QUEUE_SIZE),this._stopped=!1,this.pending=0};lt.QUEUE_SIZE=8;lt.prototype.call=function(e,t,r,n){if(!this._stopped){var i={error:e,message:t,callback:r,context:n,done:!1},s=!1,o=this;if(this._queue.push(i),i.error)return i.done=!0,this._stop(),this._flushQueue();var a=function(c,u){s^(s=!0)&&(c?(o._stop(),i.error=c,i.message=null):i.message=u,i.done=!0,o._flushQueue())};try{this._session[this._method](t,a)}catch(c){a(c)}}};lt.prototype._stop=function(){this.pending=this._queue.length,this._stopped=!0};lt.prototype._flushQueue=function(){for(var e=this._queue,t;e.length>0&&e.peek().done;)t=e.shift(),t.error?(this.pending=0,e.clear()):this.pending-=1,t.callback.call(t.context,t.error,t.message)};Qo.exports=lt});var gi=h((Lm,ea)=>{"use strict";var fd=pi(),Re=function(){this._complete=!1,this._callbacks=new fd(Re.QUEUE_SIZE)};Re.QUEUE_SIZE=4;Re.all=function(e){var t=new Re,r=e.length,n=r;for(r===0&&t.done();n--;)e[n].then(function(){r-=1,r===0&&t.done()});return t};Re.prototype.then=function(e){this._complete?e():this._callbacks.push(e)};Re.prototype.done=function(){this._complete=!0;for(var e=this._callbacks,t;t=e.shift();)t()};ea.exports=Re});var na=h((jm,ra)=>{"use strict";var ta=Zo(),pd=gi(),qe=function(e){this._ext=e[0],this._session=e[1],this._functors={incoming:new ta(this._session,"processIncomingMessage"),outgoing:new ta(this._session,"processOutgoingMessage")}};qe.prototype.pending=function(e){var t=this._functors[e];t._stopped||(t.pending+=1)};qe.prototype.incoming=function(e,t,r,n){this._exec("incoming",e,t,r,n)};qe.prototype.outgoing=function(e,t,r,n){this._exec("outgoing",e,t,r,n)};qe.prototype.close=function(){return this._closed=this._closed||new pd,this._doClose(),this._closed};qe.prototype._exec=function(e,t,r,n,i){this._functors[e].call(t,r,function(s,o){s&&(s.message=this._ext.name+": "+s.message),n.call(i,s,o),this._doClose()},this)};qe.prototype._doClose=function(){var e=this._functors.incoming,t=this._functors.outgoing;!this._closed||e.pending+t.pending!==0||(this._session&&this._session.close(),this._session=null,this._closed.done())};ra.exports=qe});var sa=h((Gm,ia)=>{"use strict";var gd=na(),md=gi(),Vt=function(e){this._cells=e.map(function(t){return new gd(t)}),this._stopped={incoming:!1,outgoing:!1}};Vt.prototype.processIncomingMessage=function(e,t,r){this._stopped.incoming||this._loop("incoming",this._cells.length-1,-1,-1,e,t,r)};Vt.prototype.processOutgoingMessage=function(e,t,r){this._stopped.outgoing||this._loop("outgoing",0,this._cells.length,1,e,t,r)};Vt.prototype.close=function(e,t){this._stopped={incoming:!0,outgoing:!0};var r=this._cells.map(function(n){return n.close()});e&&md.all(r).then(function(){e.call(t)})};Vt.prototype._loop=function(e,t,r,n,i,s,o){for(var a=this._cells,c=a.length,u=this;c--;)a[c].pending(e);var d=function(l,g,y){if(l===r)return s.call(o,g,y);a[l][e](g,y,function(P,J){P&&(u._stopped[e]=!0),d(l+n,P,J)})};d(t,null,i)};ia.exports=Vt});var ua=h((Wm,ca)=>{"use strict";var Pt=Yo(),oa=sa(),Kr=function(){this._rsv1=this._rsv2=this._rsv3=null,this._byName={},this._inOrder=[],this._sessions=[],this._index={}};Kr.MESSAGE_OPCODES=[1,2];var aa={add:function(e){if(typeof e.name!="string")throw new TypeError("extension.name must be a string");if(e.type!=="permessage")throw new TypeError('extension.type must be "permessage"');if(typeof e.rsv1!="boolean")throw new TypeError("extension.rsv1 must be true or false");if(typeof e.rsv2!="boolean")throw new TypeError("extension.rsv2 must be true or false");if(typeof e.rsv3!="boolean")throw new TypeError("extension.rsv3 must be true or false");if(this._byName.hasOwnProperty(e.name))throw new TypeError('An extension with name "'+e.name+'" is already registered');this._byName[e.name]=e,this._inOrder.push(e)},generateOffer:function(){var e=[],t=[],r={};return this._inOrder.forEach(function(n){var i=n.createClientSession();if(i){var s=[n,i];e.push(s),r[n.name]=s;var o=i.generateOffer();o=o?[].concat(o):[],o.forEach(function(a){t.push(Pt.serializeParams(n.name,a))},this)}},this),this._sessions=e,this._index=r,t.length>0?t.join(", "):null},activate:function(e){var t=Pt.parseHeader(e),r=[];t.eachOffer(function(n,i){var s=this._index[n];if(!s)throw new Error('Server sent an extension response for unknown extension "'+n+'"');var o=s[0],a=s[1],c=this._reserved(o);if(c)throw new Error("Server sent two extension responses that use the RSV"+c[0]+' bit: "'+c[1]+'" and "'+o.name+'"');if(a.activate(i)!==!0)throw new Error("Server sent unacceptable extension parameters: "+Pt.serializeParams(n,i));this._reserve(o),r.push(s)},this),this._sessions=r,this._pipeline=new oa(r)},generateResponse:function(e){var t=[],r=[],n=Pt.parseHeader(e);return this._inOrder.forEach(function(i){var s=n.byName(i.name);if(!(s.length===0||this._reserved(i))){var o=i.createServerSession(s);o&&(this._reserve(i),t.push([i,o]),r.push(Pt.serializeParams(i.name,o.generateResponse())))}},this),this._sessions=t,this._pipeline=new oa(t),r.length>0?r.join(", "):null},validFrameRsv:function(e){var t={rsv1:!1,rsv2:!1,rsv3:!1},r;if(Kr.MESSAGE_OPCODES.indexOf(e.opcode)>=0)for(var n=0,i=this._sessions.length;n<i;n++)r=this._sessions[n][0],t.rsv1=t.rsv1||r.rsv1,t.rsv2=t.rsv2||r.rsv2,t.rsv3=t.rsv3||r.rsv3;return(t.rsv1||!e.rsv1)&&(t.rsv2||!e.rsv2)&&(t.rsv3||!e.rsv3)},processIncomingMessage:function(e,t,r){this._pipeline.processIncomingMessage(e,t,r)},processOutgoingMessage:function(e,t,r){this._pipeline.processOutgoingMessage(e,t,r)},close:function(e,t){if(!this._pipeline)return e.call(t);this._pipeline.close(e,t)},_reserve:function(e){this._rsv1=this._rsv1||e.rsv1&&e.name,this._rsv2=this._rsv2||e.rsv2&&e.name,this._rsv3=this._rsv3||e.rsv3&&e.name},_reserved:function(e){return this._rsv1&&e.rsv1?[1,this._rsv1]:this._rsv2&&e.rsv2?[2,this._rsv2]:this._rsv3&&e.rsv3?[3,this._rsv3]:!1}};for(mi in aa)Kr.prototype[mi]=aa[mi];var mi;ca.exports=Kr});var fa=h((zm,da)=>{"use strict";var ha=function(){},la={final:!1,rsv1:!1,rsv2:!1,rsv3:!1,opcode:null,masked:!1,maskingKey:null,lengthBytes:1,length:0,payload:null};for(_i in la)ha.prototype[_i]=la[_i];var _i;da.exports=ha});var _a=h(($m,ma)=>{"use strict";var _d=ce().Buffer,ga=function(){this.rsv1=!1,this.rsv2=!1,this.rsv3=!1,this.opcode=null,this.length=0,this._chunks=[]},pa={read:function(){return this.data=this.data||_d.concat(this._chunks,this.length)},pushFrame:function(e){this.rsv1=this.rsv1||e.rsv1,this.rsv2=this.rsv2||e.rsv2,this.rsv3=this.rsv3||e.rsv3,this.opcode===null&&(this.opcode=e.opcode),this._chunks.push(e.payload),this.length+=e.length}};for(vi in pa)ga.prototype[vi]=pa[vi];var vi;ma.exports=ga});var bi=h((Km,Ea)=>{"use strict";var Tt=ce().Buffer,Ca=p("crypto"),vd=p("util"),yd=ua(),Ue=Se(),va=fa(),ya=_a(),B=function(e,t,r){if(Ue.apply(this,arguments),this._extensions=new yd,this._stage=0,this._masking=this._options.masking,this._protocols=this._options.protocols||[],this._requireMasking=this._options.requireMasking,this._pingCallbacks={},typeof this._protocols=="string"&&(this._protocols=this._protocols.split(/ *, */)),!!this._request){var n=this._request.headers["sec-websocket-protocol"],i=this._protocols;n!==void 0&&(typeof n=="string"&&(n=n.split(/ *, */)),this.protocol=n.filter(function(s){return i.indexOf(s)>=0})[0]),this.version="hybi-"+B.VERSION}};vd.inherits(B,Ue);B.VERSION="13";B.mask=function(e,t,r){if(!t||t.length===0)return e;r=r||0;for(var n=0,i=e.length-r;n<i;n++)e[r+n]=e[r+n]^t[n%4];return e};B.generateAccept=function(e){var t=Ca.createHash("sha1");return t.update(e+B.GUID),t.digest("base64")};B.GUID="258EAFA5-E914-47DA-95CA-C5AB0DC85B11";var ba={FIN:128,MASK:128,RSV1:64,RSV2:32,RSV3:16,OPCODE:15,LENGTH:127,OPCODES:{continuation:0,text:1,binary:2,close:8,ping:9,pong:10},OPCODE_CODES:[0,1,2,8,9,10],MESSAGE_OPCODES:[0,1,2],OPENING_OPCODES:[1,2],ERRORS:{normal_closure:1e3,going_away:1001,protocol_error:1002,unacceptable:1003,encoding_error:1007,policy_violation:1008,too_large:1009,extension_error:1010,unexpected_condition:1011},ERROR_CODES:[1e3,1001,1002,1003,1007,1008,1009,1010,1011],DEFAULT_ERROR_CODE:1e3,MIN_RESERVED_ERROR:3e3,MAX_RESERVED_ERROR:4999,UTF8_MATCH:/^([\x00-\x7F]|[\xC2-\xDF][\x80-\xBF]|\xE0[\xA0-\xBF][\x80-\xBF]|[\xE1-\xEC\xEE\xEF][\x80-\xBF]{2}|\xED[\x80-\x9F][\x80-\xBF]|\xF0[\x90-\xBF][\x80-\xBF]{2}|[\xF1-\xF3][\x80-\xBF]{3}|\xF4[\x80-\x8F][\x80-\xBF]{2})*$/,addExtension:function(e){return this._extensions.add(e),!0},parse:function(e){this._reader.put(e);for(var t=!0;t;)switch(this._stage){case 0:t=this._reader.read(1),t&&this._parseOpcode(t[0]);break;case 1:t=this._reader.read(1),t&&this._parseLength(t[0]);break;case 2:t=this._reader.read(this._frame.lengthBytes),t&&this._parseExtendedLength(t);break;case 3:t=this._reader.read(4),t&&(this._stage=4,this._frame.maskingKey=t);break;case 4:t=this._reader.read(this._frame.length),t&&(this._stage=0,this._emitFrame(t));break;default:t=null}},text:function(e){return this.readyState>1?!1:this.frame(e,"text")},binary:function(e){return this.readyState>1?!1:this.frame(e,"binary")},ping:function(e,t){return this.readyState>1?!1:(e=e||"",t&&(this._pingCallbacks[e]=t),this.frame(e,"ping"))},pong:function(e){return this.readyState>1?!1:(e=e||"",this.frame(e,"pong"))},close:function(e,t){return e=e||"",t=t||this.ERRORS.normal_closure,this.readyState<=0?(this.readyState=3,this.emit("close",new Ue.CloseEvent(t,e)),!0):this.readyState===1?(this.readyState=2,this._extensions.close(function(){this.frame(e,"close",t)},this),!0):!1},frame:function(e,t,r){if(this.readyState<=0)return this._queue([e,t,r]);if(this.readyState>2)return!1;e instanceof Array&&(e=Tt.from(e)),typeof e=="number"&&(e=e.toString());var n=new ya,i=typeof e=="string",s,o;n.rsv1=n.rsv2=n.rsv3=!1,n.opcode=this.OPCODES[t||(i?"text":"binary")],s=i?Tt.from(e,"utf8"):e,r&&(o=s,s=Tt.allocUnsafe(2+o.length),s.writeUInt16BE(r,0),o.copy(s,2)),n.data=s;var a=function(c){var u=new va;u.final=!0,u.rsv1=c.rsv1,u.rsv2=c.rsv2,u.rsv3=c.rsv3,u.opcode=c.opcode,u.masked=!!this._masking,u.length=c.data.length,u.payload=c.data,u.masked&&(u.maskingKey=Ca.randomBytes(4)),this._sendFrame(u)};return this.MESSAGE_OPCODES.indexOf(n.opcode)>=0?this._extensions.processOutgoingMessage(n,function(c,u){if(c)return this._fail("extension_error",c.message);a.call(this,u)},this):a.call(this,n),!0},_sendFrame:function(e){var t=e.length,r=t<=125?2:t<=65535?4:10,n=r+(e.masked?4:0),i=Tt.allocUnsafe(n+t),s=e.masked?this.MASK:0;i[0]=(e.final?this.FIN:0)|(e.rsv1?this.RSV1:0)|(e.rsv2?this.RSV2:0)|(e.rsv3?this.RSV3:0)|e.opcode,t<=125?i[1]=s|t:t<=65535?(i[1]=s|126,i.writeUInt16BE(t,2)):(i[1]=s|127,i.writeUInt32BE(Math.floor(t/4294967296),2),i.writeUInt32BE(t%4294967296,6)),e.payload.copy(i,n),e.masked&&(e.maskingKey.copy(i,r),B.mask(i,e.maskingKey,n)),this._write(i)},_handshakeResponse:function(){var e=this._request.headers["sec-websocket-key"],t=this._request.headers["sec-websocket-version"];if(t!==B.VERSION)throw new Error("Unsupported WebSocket version: "+t);if(typeof e!="string")throw new Error("Missing handshake request header: Sec-WebSocket-Key");this._headers.set("Upgrade","websocket"),this._headers.set("Connection","Upgrade"),this._headers.set("Sec-WebSocket-Accept",B.generateAccept(e)),this.protocol&&this._headers.set("Sec-WebSocket-Protocol",this.protocol);var r=this._extensions.generateResponse(this._request.headers["sec-websocket-extensions"]);r&&this._headers.set("Sec-WebSocket-Extensions",r);var n="HTTP/1.1 101 Switching Protocols",i=[n,this._headers.toString(),""];return Tt.from(i.join(`\r
`),"utf8")},_shutdown:function(e,t,r){delete this._frame,delete this._message,this._stage=5;var n=this.readyState===1;this.readyState=2,this._extensions.close(function(){n&&this.frame(t,"close",e),this.readyState=3,r&&this.emit("error",new Error(t)),this.emit("close",new Ue.CloseEvent(e,t))},this)},_fail:function(e,t){this.readyState>1||this._shutdown(this.ERRORS[e],t,!0)},_parseOpcode:function(e){var t=[this.RSV1,this.RSV2,this.RSV3].map(function(n){return(e&n)===n}),r=this._frame=new va;if(r.final=(e&this.FIN)===this.FIN,r.rsv1=t[0],r.rsv2=t[1],r.rsv3=t[2],r.opcode=e&this.OPCODE,this._stage=1,!this._extensions.validFrameRsv(r))return this._fail("protocol_error","One or more reserved bits are on: reserved1 = "+(r.rsv1?1:0)+", reserved2 = "+(r.rsv2?1:0)+", reserved3 = "+(r.rsv3?1:0));if(this.OPCODE_CODES.indexOf(r.opcode)<0)return this._fail("protocol_error","Unrecognized frame opcode: "+r.opcode);if(this.MESSAGE_OPCODES.indexOf(r.opcode)<0&&!r.final)return this._fail("protocol_error","Received fragmented control frame: opcode = "+r.opcode);if(this._message&&this.OPENING_OPCODES.indexOf(r.opcode)>=0)return this._fail("protocol_error","Received new data frame but previous continuous frame is unfinished")},_parseLength:function(e){var t=this._frame;if(t.masked=(e&this.MASK)===this.MASK,t.length=e&this.LENGTH,t.length>=0&&t.length<=125){if(this._stage=t.masked?3:4,!this._checkFrameLength())return}else this._stage=2,t.lengthBytes=t.length===126?2:8;if(this._requireMasking&&!t.masked)return this._fail("unacceptable","Received unmasked frame but masking is required")},_parseExtendedLength:function(e){var t=this._frame;if(t.length=this._readUInt(e),this._stage=t.masked?3:4,this.MESSAGE_OPCODES.indexOf(t.opcode)<0&&t.length>125)return this._fail("protocol_error","Received control frame having too long payload: "+t.length);this._checkFrameLength()},_checkFrameLength:function(){var e=this._message?this._message.length:0;return e+this._frame.length>this._maxLength?(this._fail("too_large","WebSocket frame length too large"),!1):!0},_emitFrame:function(e){var t=this._frame,r=t.payload=B.mask(e,t.maskingKey),n=t.opcode,i,s,o,a,c;if(delete this._frame,n===this.OPCODES.continuation){if(!this._message)return this._fail("protocol_error","Received unexpected continuation frame");this._message.pushFrame(t)}if((n===this.OPCODES.text||n===this.OPCODES.binary)&&(this._message=new ya,this._message.pushFrame(t)),t.final&&this.MESSAGE_OPCODES.indexOf(n)>=0)return this._emitMessage(this._message);n===this.OPCODES.close&&(s=r.length>=2?r.readUInt16BE(0):null,o=r.length>2?this._encode(r.slice(2)):null,r.length!==0&&!(s!==null&&s>=this.MIN_RESERVED_ERROR&&s<=this.MAX_RESERVED_ERROR)&&this.ERROR_CODES.indexOf(s)<0&&(s=this.ERRORS.protocol_error),(r.length>125||r.length>2&&!o)&&(s=this.ERRORS.protocol_error),this._shutdown(s||this.DEFAULT_ERROR_CODE,o||"")),n===this.OPCODES.ping&&(this.frame(r,"pong"),this.emit("ping",new Ue.PingEvent(r.toString()))),n===this.OPCODES.pong&&(a=this._pingCallbacks,i=this._encode(r),c=a[i],delete a[i],c&&c(),this.emit("pong",new Ue.PongEvent(r.toString())))},_emitMessage:function(t){var t=this._message;t.read(),delete this._message,this._extensions.processIncomingMessage(t,function(r,n){if(r)return this._fail("extension_error",r.message);var i=n.data;if(n.opcode===this.OPCODES.text&&(i=this._encode(i)),i===null)return this._fail("encoding_error","Could not decode a text frame as UTF-8");this.emit("message",new Ue.MessageEvent(i))},this)},_encode:function(e){try{var t=e.toString("binary",0,e.length);if(!this.UTF8_MATCH.test(t))return null}catch{}return e.toString("utf8",0,e.length)},_readUInt:function(e){return e.length===2?e.readUInt16BE(0):e.readUInt32BE(0)*4294967296+e.readUInt32BE(4)}};for(yi in ba)B.prototype[yi]=ba[yi];var yi;Ea.exports=B});var Ma=h((Xm,Sa)=>{"use strict";var Oa=ce().Buffer,bd=p("stream").Stream,wa=p("url"),Cd=p("util"),Ed=Se(),wd=Br(),xd=$r(),Od={"ws:":80,"wss:":443},Ei=function(e,t,r){this._client=e,this._http=new xd("response"),this._origin=typeof e.url=="object"?e.url:wa.parse(e.url),this._url=typeof t=="object"?t:wa.parse(t),this._options=r||{},this._state=0,this.readable=this.writable=!0,this._paused=!1,this._headers=new wd,this._headers.set("Host",this._origin.host),this._headers.set("Connection","keep-alive"),this._headers.set("Proxy-Connection","keep-alive");var n=this._url.auth&&Oa.from(this._url.auth,"utf8").toString("base64");n&&this._headers.set("Proxy-Authorization","Basic "+n)};Cd.inherits(Ei,bd);var xa={setHeader:function(e,t){return this._state!==0?!1:(this._headers.set(e,t),!0)},start:function(){if(this._state!==0)return!1;this._state=1;var e=this._origin,t=e.port||Od[e.protocol],r="CONNECT "+e.hostname+":"+t+" HTTP/1.1",n=[r,this._headers.toString(),""];return this.emit("data",Oa.from(n.join(`\r
`),"utf8")),!0},pause:function(){this._paused=!0},resume:function(){this._paused=!1,this.emit("drain")},write:function(e){if(!this.writable)return!1;if(this._http.parse(e),!this._http.isComplete())return!this._paused;if(this.statusCode=this._http.statusCode,this.headers=this._http.headers,this.statusCode===200)this.emit("connect",new Ed.ConnectEvent);else{var t="Can't establish a connection to the server at "+this._origin.href;this.emit("error",new Error(t))}return this.end(),!this._paused},end:function(e){this.writable&&(e!==void 0&&this.write(e),this.readable=this.writable=!1,this.emit("close"),this.emit("end"))},destroy:function(){this.end()}};for(Ci in xa)Ei.prototype[Ci]=xa[Ci];var Ci;Sa.exports=Ei});var Ia=h((Ym,Na)=>{"use strict";var Aa=ce().Buffer,Sd=p("crypto"),Md=p("url"),Dd=p("util"),Ad=$r(),Nd=Se(),ht=bi(),Id=Ma(),Ft=function(e,t){this.version="hybi-"+ht.VERSION,ht.call(this,null,e,t),this.readyState=-1,this._key=Ft.generateKey(),this._accept=ht.generateAccept(this._key),this._http=new Ad("response");var r=Md.parse(this.url),n=r.auth&&Aa.from(r.auth,"utf8").toString("base64");if(this.VALID_PROTOCOLS.indexOf(r.protocol)<0)throw new Error(this.url+" is not a valid WebSocket URL");this._pathname=(r.pathname||"/")+(r.search||""),this._headers.set("Host",r.host),this._headers.set("Upgrade","websocket"),this._headers.set("Connection","Upgrade"),this._headers.set("Sec-WebSocket-Key",this._key),this._headers.set("Sec-WebSocket-Version",ht.VERSION),this._protocols.length>0&&this._headers.set("Sec-WebSocket-Protocol",this._protocols.join(", ")),n&&this._headers.set("Authorization","Basic "+n)};Dd.inherits(Ft,ht);Ft.generateKey=function(){return Sd.randomBytes(16).toString("base64")};var Da={VALID_PROTOCOLS:["ws:","wss:"],proxy:function(e,t){return new Id(this,e,t)},start:function(){return this.readyState!==-1?!1:(this._write(this._handshakeRequest()),this.readyState=0,!0)},parse:function(e){if(this.readyState!==3){if(this.readyState>0)return ht.prototype.parse.call(this,e);this._http.parse(e),this._http.isComplete()&&(this._validateHandshake(),this.readyState!==3&&(this._open(),this.parse(this._http.body)))}},_handshakeRequest:function(){var e=this._extensions.generateOffer();e&&this._headers.set("Sec-WebSocket-Extensions",e);var t="GET "+this._pathname+" HTTP/1.1",r=[t,this._headers.toString(),""];return Aa.from(r.join(`\r
`),"utf8")},_failHandshake:function(e){e="Error during WebSocket handshake: "+e,this.readyState=3,this.emit("error",new Error(e)),this.emit("close",new Nd.CloseEvent(this.ERRORS.protocol_error,e))},_validateHandshake:function(){if(this.statusCode=this._http.statusCode,this.headers=this._http.headers,this._http.error)return this._failHandshake(this._http.error.message);if(this._http.statusCode!==101)return this._failHandshake("Unexpected response code: "+this._http.statusCode);var e=this._http.headers,t=e.upgrade||"",r=e.connection||"",n=e["sec-websocket-accept"]||"",i=e["sec-websocket-protocol"]||"";if(t==="")return this._failHandshake("'Upgrade' header is missing");if(t.toLowerCase()!=="websocket")return this._failHandshake("'Upgrade' header value is not 'WebSocket'");if(r==="")return this._failHandshake("'Connection' header is missing");if(r.toLowerCase()!=="upgrade")return this._failHandshake("'Connection' header value is not 'Upgrade'");if(n!==this._accept)return this._failHandshake("Sec-WebSocket-Accept mismatch");if(this.protocol=null,i!==""){if(this._protocols.indexOf(i)<0)return this._failHandshake("Sec-WebSocket-Protocol mismatch");this.protocol=i}try{this._extensions.activate(this.headers["sec-websocket-extensions"])}catch(s){return this._failHandshake(s.message)}}};for(wi in Da)Ft.prototype[wi]=Da[wi];var wi;Na.exports=Ft});var Si=h((Jm,Va)=>{"use strict";var Xr=ce().Buffer,Yr=Se(),kd=p("util"),Oi=function(e,t,r){Yr.apply(this,arguments),this._stage=0,this.version="hixie-75",this._headers.set("Upgrade","WebSocket"),this._headers.set("Connection","Upgrade"),this._headers.set("WebSocket-Origin",this._request.headers.origin),this._headers.set("WebSocket-Location",this.url)};kd.inherits(Oi,Yr);var ka={close:function(){return this.readyState===3?!1:(this.readyState=3,this.emit("close",new Yr.CloseEvent(null,null)),!0)},parse:function(e){this.readyState>1||(this._reader.put(e),this._reader.eachByte(function(t){var r;switch(this._stage){case-1:this._body.push(t),this._sendHandshakeBody();break;case 0:this._parseLeadingByte(t);break;case 1:if(this._length=(t&127)+128*this._length,this._closing&&this._length===0)return this.close();(t&128)!==128&&(this._length===0?this._stage=0:(this._skipped=0,this._stage=2));break;case 2:if(t===255)this._stage=0,r=Xr.from(this._buffer).toString("utf8",0,this._buffer.length),this.emit("message",new Yr.MessageEvent(r));else if(this._length)this._skipped+=1,this._skipped===this._length&&(this._stage=0);else if(this._buffer.push(t),this._buffer.length>this._maxLength)return this.close();break}},this))},frame:function(e){if(this.readyState===0)return this._queue([e]);if(this.readyState>1)return!1;typeof e!="string"&&(e=e.toString());var t=Xr.byteLength(e),r=Xr.allocUnsafe(t+2);return r[0]=0,r.write(e,1),r[r.length-1]=255,this._write(r),!0},_handshakeResponse:function(){var e="HTTP/1.1 101 Web Socket Protocol Handshake",t=[e,this._headers.toString(),""];return Xr.from(t.join(`\r
`),"utf8")},_parseLeadingByte:function(e){(e&128)===128?(this._length=0,this._stage=1):(delete this._length,delete this._skipped,this._buffer=[],this._stage=2)}};for(xi in ka)Oi.prototype[xi]=ka[xi];var xi;Va.exports=Oi});var qa=h((Qm,Ra)=>{"use strict";var Rt=ce().Buffer,Vd=Se(),Jr=Si(),Pd=p("crypto"),Td=p("util"),Pa=function(e){return parseInt((e.match(/[0-9]/g)||[]).join(""),10)},Ta=function(e){return(e.match(/ /g)||[]).length},Di=function(e,t,r){Jr.apply(this,arguments),this._stage=-1,this._body=[],this.version="hixie-76",this._headers.clear(),this._headers.set("Upgrade","WebSocket"),this._headers.set("Connection","Upgrade"),this._headers.set("Sec-WebSocket-Origin",this._request.headers.origin),this._headers.set("Sec-WebSocket-Location",this.url)};Td.inherits(Di,Jr);var Fa={BODY_SIZE:8,start:function(){return Jr.prototype.start.call(this)?(this._started=!0,this._sendHandshakeBody(),!0):!1},close:function(){return this.readyState===3?!1:(this.readyState===1&&this._write(Rt.from([255,0])),this.readyState=3,this.emit("close",new Vd.CloseEvent(null,null)),!0)},_handshakeResponse:function(){var a=this._request.headers,e=a["sec-websocket-key1"],t=a["sec-websocket-key2"];if(!e)throw new Error("Missing required header: Sec-WebSocket-Key1");if(!t)throw new Error("Missing required header: Sec-WebSocket-Key2");var r=Pa(e),n=Ta(e),i=Pa(t),s=Ta(t);if(r%n!==0||i%s!==0)throw new Error("Client sent invalid Sec-WebSocket-Key headers");this._keyValues=[r/n,i/s];var o="HTTP/1.1 101 WebSocket Protocol Handshake",a=[o,this._headers.toString(),""];return Rt.from(a.join(`\r
`),"binary")},_handshakeSignature:function(){if(this._body.length<this.BODY_SIZE)return null;var e=Pd.createHash("md5"),t=Rt.allocUnsafe(8+this.BODY_SIZE);return t.writeUInt32BE(this._keyValues[0],0),t.writeUInt32BE(this._keyValues[1],4),Rt.from(this._body).copy(t,8,0,this.BODY_SIZE),e.update(t),Rt.from(e.digest("binary"),"binary")},_sendHandshakeBody:function(){if(this._started){var e=this._handshakeSignature();e&&(this._write(e),this._stage=0,this._open(),this._body.length>this.BODY_SIZE&&this.parse(this._body.slice(this.BODY_SIZE)))}},_parseLeadingByte:function(e){if(e!==255)return Jr.prototype._parseLeadingByte.call(this,e);this._closing=!0,this._length=0,this._stage=1}};for(Mi in Fa)Di.prototype[Mi]=Fa[Mi];var Mi;Ra.exports=Di});var Ha=h((Zm,Ua)=>{"use strict";var Fd=p("util"),Rd=$r(),Ii=Se(),qd=Si(),Ud=qa(),Hd=bi(),He=function(e){Ii.call(this,null,null,e),this._http=new Rd("request")};Fd.inherits(He,Ii);var Ni={EVENTS:["open","message","error","close","ping","pong"],_bindEventListeners:function(){this.messages.on("error",function(){}),this.on("error",function(){})},parse:function(e){if(this._delegate)return this._delegate.parse(e);if(this._http.parse(e),!!this._http.isComplete()){this.method=this._http.method,this.url=this._http.url,this.headers=this._http.headers,this.body=this._http.body;var t=this;this._delegate=He.http(this,this._options),this._delegate.messages=this.messages,this._delegate.io=this.io,this._open(),this.EVENTS.forEach(function(r){this._delegate.on(r,function(n){t.emit(r,n)})},this),this.protocol=this._delegate.protocol,this.version=this._delegate.version,this.parse(this._http.body),this.emit("connect",new Ii.ConnectEvent)}},_open:function(){this.__queue.forEach(function(e){this._delegate[e[0]].apply(this._delegate,e[1])},this),this.__queue=[]}};["addExtension","setHeader","start","frame","text","binary","ping","close"].forEach(function(e){Ni[e]=function(){return this._delegate?this._delegate[e].apply(this._delegate,arguments):(this.__queue.push([e,arguments]),!0)}});for(Ai in Ni)He.prototype[Ai]=Ni[Ai];var Ai;He.isSecureRequest=function(e){if(e.connection&&e.connection.authorized!==void 0||e.socket&&e.socket.secure)return!0;var t=e.headers;return t?t.https==="on"||t["x-forwarded-ssl"]==="on"||t["x-forwarded-scheme"]==="https"||t["x-forwarded-proto"]==="https":!1};He.determineUrl=function(e){var t=this.isSecureRequest(e)?"wss:":"ws:";return t+"//"+e.headers.host+e.url};He.http=function(e,t){t=t||{},t.requireMasking===void 0&&(t.requireMasking=!0);var r=e.headers,n=r["sec-websocket-version"],i=r["sec-websocket-key"],s=r["sec-websocket-key1"],o=r["sec-websocket-key2"],a=this.determineUrl(e);return n||i?new Hd(e,a,t):s||o?new Ud(e,a,t):new qd(e,a,t)};Ua.exports=He});var qt=h((e_,La)=>{"use strict";var Ba=Se(),Bd=Ia(),Qr=Ha(),Ld={client:function(e,t){return t=t||{},t.masking===void 0&&(t.masking=!0),new Bd(e,t)},server:function(e){return e=e||{},e.requireMasking===void 0&&(e.requireMasking=!0),new Qr(e)},http:function(){return Qr.http.apply(Qr,arguments)},isSecureRequest:function(e){return Qr.isSecureRequest(e)},isWebSocket:function(e){return Ba.isWebSocket(e)},validateOptions:function(e,t){Ba.validateOptions(e,t)}};La.exports=Ld});var Ut=h((t_,ja)=>{"use strict";var Be=function(e,t){this.type=e;for(var r in t)this[r]=t[r]};Be.prototype.initEvent=function(e,t,r){this.type=e,this.bubbles=t,this.cancelable=r};Be.prototype.stopPropagation=function(){};Be.prototype.preventDefault=function(){};Be.CAPTURING_PHASE=1;Be.AT_TARGET=2;Be.BUBBLING_PHASE=3;ja.exports=Be});var ki=h((r_,Ga)=>{"use strict";var jd=Ut(),Gd={onopen:null,onmessage:null,onerror:null,onclose:null,addEventListener:function(e,t,r){this.on(e,t)},removeEventListener:function(e,t,r){this.removeListener(e,t)},dispatchEvent:function(e){e.target=e.currentTarget=this,e.eventPhase=jd.AT_TARGET,this["on"+e.type]&&this["on"+e.type](e),this.emit(e.type,e)}};Ga.exports=Gd});var en=h((n_,$a)=>{"use strict";var Wd=p("stream").Stream,zd=p("util"),$d=qt(),Wa=ki(),Zr=Ut(),C=function(e){e=e||{},$d.validateOptions(e,["headers","extensions","maxLength","ping","proxy","tls","ca"]),this.readable=this.writable=!0;var t=e.headers;if(t)for(var r in t)this._driver.setHeader(r,t[r]);var n=e.extensions;n&&[].concat(n).forEach(this._driver.addExtension,this._driver),this._ping=e.ping,this._pingId=0,this.readyState=C.CONNECTING,this.bufferedAmount=0,this.protocol="",this.url=this._driver.url,this.version=this._driver.version;var i=this;this._driver.on("open",function(s){i._open()}),this._driver.on("message",function(s){i._receiveMessage(s.data)}),this._driver.on("close",function(s){i._beginClose(s.reason,s.code)}),this._driver.on("error",function(s){i._emitError(s.message)}),this.on("error",function(){}),this._driver.messages.on("drain",function(){i.emit("drain")}),this._ping&&(this._pingTimer=setInterval(function(){i._pingId+=1,i.ping(i._pingId.toString())},this._ping*1e3)),this._configureStream(),this._proxy||(this._stream.pipe(this._driver.io),this._driver.io.pipe(this._stream))};zd.inherits(C,Wd);C.CONNECTING=0;C.OPEN=1;C.CLOSING=2;C.CLOSED=3;C.CLOSE_TIMEOUT=3e4;var za={write:function(e){return this.send(e)},end:function(e){e!==void 0&&this.send(e),this.close()},pause:function(){return this._driver.messages.pause()},resume:function(){return this._driver.messages.resume()},send:function(e){return this.readyState>C.OPEN?!1:(e instanceof Buffer||(e=String(e)),this._driver.messages.write(e))},ping:function(e,t){return this.readyState>C.OPEN?!1:this._driver.ping(e,t)},close:function(e,t){if(e===void 0&&(e=1e3),t===void 0&&(t=""),e!==1e3&&(e<3e3||e>4999))throw new Error("Failed to execute 'close' on WebSocket: The code must be either 1000, or between 3000 and 4999. "+e+" is neither.");if(this.readyState<C.CLOSING){var r=this;this._closeTimer=setTimeout(function(){r._beginClose("",1006)},C.CLOSE_TIMEOUT)}this.readyState!==C.CLOSED&&(this.readyState=C.CLOSING),this._driver.close(t,e)},_configureStream:function(){var e=this;this._stream.setTimeout(0),this._stream.setNoDelay(!0),["close","end"].forEach(function(t){this._stream.on(t,function(){e._finalizeClose()})},this),this._stream.on("error",function(t){e._emitError("Network error: "+e.url+": "+t.message),e._finalizeClose()})},_open:function(){if(this.readyState===C.CONNECTING){this.readyState=C.OPEN,this.protocol=this._driver.protocol||"";var e=new Zr("open");e.initEvent("open",!1,!1),this.dispatchEvent(e)}},_receiveMessage:function(e){if(this.readyState>C.OPEN)return!1;this.readable&&this.emit("data",e);var t=new Zr("message",{data:e});t.initEvent("message",!1,!1),this.dispatchEvent(t)},_emitError:function(e){if(!(this.readyState>=C.CLOSING)){var t=new Zr("error",{message:e});t.initEvent("error",!1,!1),this.dispatchEvent(t)}},_beginClose:function(e,t){this.readyState!==C.CLOSED&&(this.readyState=C.CLOSING,this._closeParams=[e,t],this._stream&&(this._stream.destroy(),this._stream.readable||this._finalizeClose()))},_finalizeClose:function(){if(this.readyState!==C.CLOSED){this.readyState=C.CLOSED,this._closeTimer&&clearTimeout(this._closeTimer),this._pingTimer&&clearInterval(this._pingTimer),this._stream&&this._stream.end(),this.readable&&this.emit("end"),this.readable=this.writable=!1;var e=this._closeParams?this._closeParams[0]:"",t=this._closeParams?this._closeParams[1]:1006,r=new Zr("close",{code:t,reason:e});r.initEvent("close",!1,!1),this.dispatchEvent(r)}}};for(Vi in za)C.prototype[Vi]=za[Vi];var Vi;for(Pi in Wa)C.prototype[Pi]=Wa[Pi];var Pi;$a.exports=C});var Za=h((s_,Qa)=>{"use strict";var Kd=p("util"),Xd=p("net"),Ka=p("tls"),Xa=p("url"),Yd=qt(),Ya=en(),i_=Ut(),Jd={"http:":80,"https:":443,"ws:":80,"wss:":443},Ja=["https:","wss:"],tn=function(e,t,r){r=r||{},this.url=e,this._driver=Yd.client(this.url,{maxLength:r.maxLength,protocols:t}),["open","error"].forEach(function(g){this._driver.on(g,function(){l.headers=l._driver.headers,l.statusCode=l._driver.statusCode})},this);var n=r.proxy||{},i=Xa.parse(n.origin||this.url),s=i.port||Jd[i.protocol],o=Ja.indexOf(i.protocol)>=0,a=function(){l._onConnect()},c=r.net||{},u=r.tls||{},d=n.origin?n.tls||{}:u,l=this;c.host=d.host=i.hostname,c.port=d.port=s,u.ca=u.ca||r.ca,d.servername=d.servername||i.hostname,this._stream=o?Ka.connect(d,a):Xd.connect(c,a),n.origin&&this._configureProxy(n,u),Ya.call(this,r)};Kd.inherits(tn,Ya);tn.prototype._onConnect=function(){var e=this._proxy||this._driver;e.start()};tn.prototype._configureProxy=function(e,t){var r=Xa.parse(this.url),n=Ja.indexOf(r.protocol)>=0,i=this,s;if(this._proxy=this._driver.proxy(e.origin),e.headers)for(s in e.headers)this._proxy.setHeader(s,e.headers[s]);this._proxy.pipe(this._stream,{end:!1}),this._stream.pipe(this._proxy),this._proxy.on("connect",function(){if(n){var o={socket:i._stream,servername:r.hostname};for(s in t)o[s]=t[s];i._stream=Ka.connect(o),i._configureStream()}i._driver.io.pipe(i._stream),i._stream.pipe(i._driver.io),i._driver.start()}),this._proxy.on("error",function(o){i._driver.emit("error",o)})};Qa.exports=tn});var ic=h((o_,nc)=>{"use strict";var Qd=p("stream").Stream,Zd=p("util"),ef=qt(),tf=Br(),dt=en(),ec=ki(),tc=Ut(),Ht=function(e,t,r){this.writable=!0,r=r||{},this._stream=t.socket,this._ping=r.ping||this.DEFAULT_PING,this._retry=r.retry||this.DEFAULT_RETRY;var n=ef.isSecureRequest(e)?"https:":"http:";this.url=n+"//"+e.headers.host+e.url,this.lastEventId=e.headers["last-event-id"]||"",this.readyState=dt.CONNECTING;var i=new tf,s=this;if(r.headers)for(var o in r.headers)i.set(o,r.headers[o]);if(!(!this._stream||!this._stream.writable)){process.nextTick(function(){s._open()}),this._stream.setTimeout(0),this._stream.setNoDelay(!0);var a=`HTTP/1.1 200 OK\r
Content-Type: text/event-stream\r
Cache-Control: no-cache, no-store\r
Connection: close\r
`+i.toString()+`\r
retry: `+Math.floor(this._retry*1e3)+`\r
\r
`;this._write(a),this._stream.on("drain",function(){s.emit("drain")}),this._ping&&(this._pingTimer=setInterval(function(){s.ping()},this._ping*1e3)),["error","end"].forEach(function(c){s._stream.on(c,function(){s.close()})})}};Zd.inherits(Ht,Qd);Ht.isEventSource=function(e){if(e.method!=="GET")return!1;var t=(e.headers.accept||"").split(/\s*,\s*/);return t.indexOf("text/event-stream")>=0};var rc={DEFAULT_PING:10,DEFAULT_RETRY:5,_write:function(e){if(!this.writable)return!1;try{return this._stream.write(e,"utf8")}catch{return!1}},_open:function(){if(this.readyState===dt.CONNECTING){this.readyState=dt.OPEN;var e=new tc("open");e.initEvent("open",!1,!1),this.dispatchEvent(e)}},write:function(e){return this.send(e)},end:function(e){e!==void 0&&this.write(e),this.close()},send:function(e,t){if(this.readyState>dt.OPEN)return!1;e=String(e).replace(/(\r\n|\r|\n)/g,"$1data: "),t=t||{};var r="";return t.event&&(r+="event: "+t.event+`\r
`),t.id&&(r+="id: "+t.id+`\r
`),r+="data: "+e+`\r
\r
`,this._write(r)},ping:function(){return this._write(`:\r
\r
`)},close:function(){if(this.readyState>dt.OPEN)return!1;this.readyState=dt.CLOSED,this.writable=!1,this._pingTimer&&clearInterval(this._pingTimer),this._stream&&this._stream.end();var e=new tc("close");return e.initEvent("close",!1,!1),this.dispatchEvent(e),!0}};for(Ti in rc)Ht.prototype[Ti]=rc[Ti];var Ti;for(Fi in ec)Ht.prototype[Fi]=ec[Fi];var Fi;nc.exports=Ht});var ac=h((a_,oc)=>{"use strict";var rf=p("util"),Ri=qt(),sc=en(),Me=function(e,t,r,n,i){i=i||{},this._stream=t,this._driver=Ri.http(e,{maxLength:i.maxLength,protocols:n});var s=this;if(!(!this._stream||!this._stream.writable)){if(!this._stream.readable)return this._stream.end();var o=function(){s._stream.removeListener("data",o)};this._stream.on("data",o),sc.call(this,i),process.nextTick(function(){s._driver.start(),s._driver.io.write(r)})}};rf.inherits(Me,sc);Me.isWebSocket=function(e){return Ri.isWebSocket(e)};Me.validateOptions=function(e,t){Ri.validateOptions(e,t)};Me.WebSocket=Me;Me.Client=Za();Me.EventSource=ic();oc.exports=Me});var uc=h((c_,cc)=>{"use strict";cc.exports=ac().Client});var pc=h((u_,fc)=>{"use strict";var lc=xe(),nf=K(),sf=_(),hc=p("events").EventEmitter,dc=uc(),ue=function(){};process.env.NODE_ENV!=="production"&&(ue=E()("sockjs-client:websocket"));function _e(e,t,r){if(!_e.enabled())throw new Error("Transport created when disabled");hc.call(this),ue("constructor",e);var n=this,i=nf.addPath(e,"/websocket");i.slice(0,5)==="https"?i="wss"+i.slice(5):i="ws"+i.slice(4),this.url=i,this.ws=new dc(this.url,[],r),this.ws.onmessage=function(s){ue("message event",s.data),n.emit("message",s.data)},this.unloadRef=lc.unloadAdd(function(){ue("unload"),n.ws.close()}),this.ws.onclose=function(s){ue("close event",s.code,s.reason),n.emit("close",s.code,s.reason),n._cleanup()},this.ws.onerror=function(s){ue("error event",s),n.emit("close",1006,"WebSocket connection broken"),n._cleanup()}}sf(_e,hc);_e.prototype.send=function(e){var t="["+e+"]";ue("send",t),this.ws.send(t)};_e.prototype.close=function(){ue("close");var e=this.ws;this._cleanup(),e&&e.close()};_e.prototype._cleanup=function(){ue("_cleanup");var e=this.ws;e&&(e.onmessage=e.onclose=e.onerror=null),lc.unloadDel(this.unloadRef),this.unloadRef=this.ws=null,this.removeAllListeners()};_e.enabled=function(){return ue("enabled"),!!dc};_e.transportName="websocket";_e.roundTrips=2;fc.exports=_e});var _c=h((l_,mc)=>{"use strict";var of=_(),gc=p("events").EventEmitter,le=function(){};process.env.NODE_ENV!=="production"&&(le=E()("sockjs-client:buffered-sender"));function Le(e,t){le(e),gc.call(this),this.sendBuffer=[],this.sender=t,this.url=e}of(Le,gc);Le.prototype.send=function(e){le("send",e),this.sendBuffer.push(e),this.sendStop||this.sendSchedule()};Le.prototype.sendScheduleWait=function(){le("sendScheduleWait");var e=this,t;this.sendStop=function(){le("sendStop"),e.sendStop=null,clearTimeout(t)},t=setTimeout(function(){le("timeout"),e.sendStop=null,e.sendSchedule()},25)};Le.prototype.sendSchedule=function(){le("sendSchedule",this.sendBuffer.length);var e=this;if(this.sendBuffer.length>0){var t="["+this.sendBuffer.join(",")+"]";this.sendStop=this.sender(this.url,t,function(r){e.sendStop=null,r?(le("error",r),e.emit("close",r.code||1006,"Sending error: "+r),e.close()):e.sendScheduleWait()}),this.sendBuffer=[]}};Le.prototype._cleanup=function(){le("_cleanup"),this.removeAllListeners()};Le.prototype.close=function(){le("close"),this._cleanup(),this.sendStop&&(this.sendStop(),this.sendStop=null)};mc.exports=Le});var bc=h((h_,yc)=>{"use strict";var af=_(),vc=p("events").EventEmitter,ft=function(){};process.env.NODE_ENV!=="production"&&(ft=E()("sockjs-client:polling"));function rn(e,t,r){ft(t),vc.call(this),this.Receiver=e,this.receiveUrl=t,this.AjaxObject=r,this._scheduleReceiver()}af(rn,vc);rn.prototype._scheduleReceiver=function(){ft("_scheduleReceiver");var e=this,t=this.poll=new this.Receiver(this.receiveUrl,this.AjaxObject);t.on("message",function(r){ft("message",r),e.emit("message",r)}),t.once("close",function(r,n){ft("close",r,n,e.pollIsClosing),e.poll=t=null,e.pollIsClosing||(n==="network"?e._scheduleReceiver():(e.emit("close",r||1006,n),e.removeAllListeners()))})};rn.prototype.abort=function(){ft("abort"),this.removeAllListeners(),this.pollIsClosing=!0,this.poll&&this.poll.abort()};yc.exports=rn});var Hi=h((d_,Cc)=>{"use strict";var cf=_(),uf=K(),qi=_c(),lf=bc(),Bt=function(){};process.env.NODE_ENV!=="production"&&(Bt=E()("sockjs-client:sender-receiver"));function Ui(e,t,r,n,i){var s=uf.addPath(e,t);Bt(s);var o=this;qi.call(this,e,r),this.poll=new lf(n,s,i),this.poll.on("message",function(a){Bt("poll message",a),o.emit("message",a)}),this.poll.once("close",function(a,c){Bt("poll close",a,c),o.poll=null,o.emit("close",a,c),o.close()})}cf(Ui,qi);Ui.prototype.close=function(){qi.prototype.close.call(this),Bt("close"),this.removeAllListeners(),this.poll&&(this.poll.abort(),this.poll=null)};Cc.exports=Ui});var je=h((f_,xc)=>{"use strict";var hf=_(),df=K(),Ec=Hi(),nn=function(){};process.env.NODE_ENV!=="production"&&(nn=E()("sockjs-client:ajax-based"));function ff(e){return function(t,r,n){nn("create ajax sender",t,r);var i={};typeof r=="string"&&(i.headers={"Content-type":"text/plain"});var s=df.addPath(t,"/xhr_send"),o=new e("POST",s,r,i);return o.once("finish",function(a){if(nn("finish",a),o=null,a!==200&&a!==204)return n(new Error("http status "+a));n()}),function(){nn("abort"),o.close(),o=null;var a=new Error("Aborted");a.code=1e3,n(a)}}}function wc(e,t,r,n){Ec.call(this,e,t,ff(n),r,n)}hf(wc,Ec);xc.exports=wc});var jt=h((p_,Sc)=>{"use strict";var pf=_(),Oc=p("events").EventEmitter,ve=function(){};process.env.NODE_ENV!=="production"&&(ve=E()("sockjs-client:receiver:xhr"));function Lt(e,t){ve(e),Oc.call(this);var r=this;this.bufferPosition=0,this.xo=new t("POST",e,null),this.xo.on("chunk",this._chunkHandler.bind(this)),this.xo.once("finish",function(n,i){ve("finish",n,i),r._chunkHandler(n,i),r.xo=null;var s=n===200?"network":"permanent";ve("close",s),r.emit("close",null,s),r._cleanup()})}pf(Lt,Oc);Lt.prototype._chunkHandler=function(e,t){if(ve("_chunkHandler",e),!(e!==200||!t))for(var r=-1;;this.bufferPosition+=r+1){var n=t.slice(this.bufferPosition);if(r=n.indexOf(`
`),r===-1)break;var i=n.slice(0,r);i&&(ve("message",i),this.emit("message",i))}};Lt.prototype._cleanup=function(){ve("_cleanup"),this.removeAllListeners()};Lt.prototype.abort=function(){ve("abort"),this.xo&&(this.xo.close(),ve("close"),this.emit("close",null,"user"),this.xo=null),this._cleanup()};Sc.exports=Lt});var Bi=h((g_,Dc)=>{"use strict";var Mc=p("events").EventEmitter,gf=_(),mf=p("http"),_f=p("https"),vf=Vr(),pt=function(){};process.env.NODE_ENV!=="production"&&(pt=E()("sockjs-client:driver:xhr"));function Gt(e,t,r,n){pt(e,t,r);var i=this;Mc.call(this);var s=new vf(t),o={method:e,hostname:s.hostname.replace(/\[|\]/g,""),port:s.port,path:s.pathname+(s.query||""),headers:n&&n.headers},a=s.protocol==="https:"?_f:mf;this.req=a.request(o,function(c){c.setEncoding("utf8");var u="";c.on("data",function(d){pt("data",d),u+=d,i.emit("chunk",200,u)}),c.once("end",function(){pt("end"),i.emit("finish",c.statusCode,u),i.req=null})}),this.req.on("error",function(c){pt("error",c),i.emit("finish",0,c.message)}),r&&this.req.write(r),this.req.end()}gf(Gt,Mc);Gt.prototype.close=function(){pt("close"),this.removeAllListeners(),this.req&&(this.req.abort(),this.req=null)};Gt.enabled=!0;Gt.supportsCORS=!0;Dc.exports=Gt});var Wt=h((m_,Ac)=>{"use strict";var yf=_(),sn=Bi();function Li(e,t,r,n){sn.call(this,e,t,r,n)}yf(Li,sn);Li.enabled=sn.enabled&&sn.supportsCORS;Ac.exports=Li});var gt=h((__,Nc)=>{"use strict";var bf=_(),ji=Bi();function Gi(e,t,r){ji.call(this,e,t,r,{noCredentials:!0})}bf(Gi,ji);Gi.enabled=ji.enabled;Nc.exports=Gi});var mt=h((v_,Ic)=>{"use strict";Ic.exports={isOpera:function(){return global.navigator&&/opera/i.test(global.navigator.userAgent)},isKonqueror:function(){return global.navigator&&/konqueror/i.test(global.navigator.userAgent)},hasDomain:function(){if(!global.document)return!0;try{return!!global.document.domain}catch{return!1}}}});var Pc=h((y_,Vc)=>{"use strict";var Cf=_(),kc=je(),Ef=jt(),Wi=Wt(),wf=gt(),xf=mt();function _t(e){if(!wf.enabled&&!Wi.enabled)throw new Error("Transport created when disabled");kc.call(this,e,"/xhr_streaming",Ef,Wi)}Cf(_t,kc);_t.enabled=function(e){return e.nullOrigin||xf.isOpera()?!1:Wi.enabled};_t.transportName="xhr-streaming";_t.roundTrips=2;_t.needBody=!!global.document;Vc.exports=_t});var on=h((b_,Rc)=>{"use strict";var Tc=p("events").EventEmitter,Of=_(),Fc=xe(),Sf=mt(),Mf=K(),ye=function(){};process.env.NODE_ENV!=="production"&&(ye=E()("sockjs-client:sender:xdr"));function Ge(e,t,r){ye(e,t);var n=this;Tc.call(this),setTimeout(function(){n._start(e,t,r)},0)}Of(Ge,Tc);Ge.prototype._start=function(e,t,r){ye("_start");var n=this,i=new global.XDomainRequest;t=Mf.addQuery(t,"t="+ +new Date),i.onerror=function(){ye("onerror"),n._error()},i.ontimeout=function(){ye("ontimeout"),n._error()},i.onprogress=function(){ye("progress",i.responseText),n.emit("chunk",200,i.responseText)},i.onload=function(){ye("load"),n.emit("finish",200,i.responseText),n._cleanup(!1)},this.xdr=i,this.unloadRef=Fc.unloadAdd(function(){n._cleanup(!0)});try{this.xdr.open(e,t),this.timeout&&(this.xdr.timeout=this.timeout),this.xdr.send(r)}catch{this._error()}};Ge.prototype._error=function(){this.emit("finish",0,""),this._cleanup(!1)};Ge.prototype._cleanup=function(e){if(ye("cleanup",e),!!this.xdr){if(this.removeAllListeners(),Fc.unloadDel(this.unloadRef),this.xdr.ontimeout=this.xdr.onerror=this.xdr.onprogress=this.xdr.onload=null,e)try{this.xdr.abort()}catch{}this.unloadRef=this.xdr=null}};Ge.prototype.close=function(){ye("close"),this._cleanup(!0)};Ge.enabled=!!(global.XDomainRequest&&Sf.hasDomain());Rc.exports=Ge});var $i=h((C_,Uc)=>{"use strict";var Df=_(),qc=je(),Af=jt(),zi=on();function zt(e){if(!zi.enabled)throw new Error("Transport created when disabled");qc.call(this,e,"/xhr_streaming",Af,zi)}Df(zt,qc);zt.enabled=function(e){return e.cookie_needed||e.nullOrigin?!1:zi.enabled&&e.sameScheme};zt.transportName="xdr-streaming";zt.roundTrips=2;Uc.exports=zt});var Ki=h((E_,Gc)=>{"use strict";var Hc=p("url").parse,Nf=p("events"),If=p("https"),kf=p("http"),Vf=p("util"),Pf=["pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","secureProtocol","servername","checkServerIdentity"],jc=[239,187,191],Tf=58,Ff=32,Bc=10,Rf=13,Lc=1024*256,qf=/^(cookie|authorization)$/i;function Uf(e){return jc.every(function(t,r){return e[r]===t})}function w(e,t){var r=w.CONNECTING,n=t&&t.headers,i=!1;Object.defineProperty(this,"readyState",{get:function(){return r}}),Object.defineProperty(this,"url",{get:function(){return e}});var s=this;s.reconnectInterval=1e3,s.connectionInProgress=!1;function o(b){r!==w.CLOSED&&(r=w.CONNECTING,P("error",new $t("error",{message:b})),g&&(e=g,g=null,i=!1),setTimeout(function(){r!==w.CONNECTING||s.connectionInProgress||(s.connectionInProgress=!0,y())},s.reconnectInterval))}var a,c="";n&&n["Last-Event-ID"]&&(c=n["Last-Event-ID"],delete n["Last-Event-ID"]);var u=!1,d="",l="",g=null;function y(){var b=Hc(e),j=b.protocol==="https:";if(b.headers={"Cache-Control":"no-cache",Accept:"text/event-stream"},c&&(b.headers["Last-Event-ID"]=c),n){var q=i?Bf(n):n;for(var pe in q){var re=q[pe];re&&(b.headers[pe]=re)}}b.rejectUnauthorized=!(t&&!t.rejectUnauthorized),t&&t.createConnection!==void 0&&(b.createConnection=t.createConnection);var Ye=t&&t.proxy;if(Ye){var U=Hc(t.proxy);j=U.protocol==="https:",b.protocol=j?"https:":"http:",b.path=e,b.headers.Host=b.host,b.hostname=U.hostname,b.host=U.host,b.port=U.port}if(t&&t.https){for(var ne in t.https)if(Pf.indexOf(ne)!==-1){var fr=t.https[ne];fr!==void 0&&(b[ne]=fr)}}t&&t.withCredentials!==void 0&&(b.withCredentials=t.withCredentials),a=(j?If:kf).request(b,function(v){if(s.connectionInProgress=!1,v.statusCode===500||v.statusCode===502||v.statusCode===503||v.statusCode===504){P("error",new $t("error",{status:v.statusCode,message:v.statusMessage})),o();return}if(v.statusCode===301||v.statusCode===302||v.statusCode===307){var Je=v.headers.location;if(!Je){P("error",new $t("error",{status:v.statusCode,message:v.statusMessage}));return}var lh=new URL(e).origin,hh=new URL(Je).origin;i=lh!==hh,v.statusCode===307&&(g=e),e=Je,process.nextTick(y);return}if(v.statusCode!==200)return P("error",new $t("error",{status:v.statusCode,message:v.statusMessage})),s.close();r=w.OPEN,v.on("close",function(){v.removeAllListeners("close"),v.removeAllListeners("end"),o()}),v.on("end",function(){v.removeAllListeners("close"),v.removeAllListeners("end"),o()}),P("open",new $t("open"));var M,An,Nn=0,In=-1,pr=0,ge=0;v.on("data",function(Qe){M?(Qe.length>M.length-ge&&(pr=M.length*2+Qe.length,pr>Lc&&(pr=M.length+Qe.length+Lc),An=Buffer.alloc(pr),M.copy(An,0,0,ge),M=An),Qe.copy(M,ge),ge+=Qe.length):(M=Qe,Uf(M)&&(M=M.slice(jc.length)),ge=M.length);for(var G=0,gr=ge;G<gr;){u&&(M[G]===Bc&&++G,u=!1);for(var Ze=-1,mr=In,_r,et=Nn;Ze<0&&et<gr;++et)_r=M[et],_r===Tf?mr<0&&(mr=et-G):_r===Rf?(u=!0,Ze=et-G):_r===Bc&&(Ze=et-G);if(Ze<0){Nn=gr-G,In=mr;break}else Nn=0,In=-1;J(M,G,mr,Ze),G+=Ze+1}G===gr?(M=void 0,ge=0):G>0&&(M=M.slice(G,ge),ge=M.length)})}),a.on("error",function(v){s.connectionInProgress=!1,o(v.message)}),a.setNoDelay&&a.setNoDelay(!0),a.end()}y();function P(){s.listeners(arguments[0]).length>0&&s.emit.apply(s,arguments)}this._close=function(){r!==w.CLOSED&&(r=w.CLOSED,a.abort&&a.abort(),a.xhr&&a.xhr.abort&&a.xhr.abort())};function J(b,j,q,pe){if(pe===0){if(d.length>0){var re=l||"message";P(re,new Hf(re,{data:d.slice(0,-1),lastEventId:c,origin:new URL(e).origin})),d=""}l=void 0}else if(q>0){var Ye=q<0,U=0,ne=b.slice(j,j+(Ye?pe:q)).toString();Ye?U=pe:b[j+q+1]!==Ff?U=q+1:U=q+2,j+=U;var fr=pe-U,v=b.slice(j,j+fr).toString();if(ne==="data")d+=v+`
`;else if(ne==="event")l=v;else if(ne==="id")c=v;else if(ne==="retry"){var Je=parseInt(v,10);Number.isNaN(Je)||(s.reconnectInterval=Je)}}}}Gc.exports=w;Vf.inherits(w,Nf.EventEmitter);w.prototype.constructor=w;["open","error","message"].forEach(function(e){Object.defineProperty(w.prototype,"on"+e,{get:function(){var r=this.listeners(e)[0];return r?r._listener?r._listener:r:void 0},set:function(r){this.removeAllListeners(e),this.addEventListener(e,r)}})});Object.defineProperty(w,"CONNECTING",{enumerable:!0,value:0});Object.defineProperty(w,"OPEN",{enumerable:!0,value:1});Object.defineProperty(w,"CLOSED",{enumerable:!0,value:2});w.prototype.CONNECTING=0;w.prototype.OPEN=1;w.prototype.CLOSED=2;w.prototype.close=function(){this._close()};w.prototype.addEventListener=function(t,r){typeof r=="function"&&(r._listener=r,this.on(t,r))};w.prototype.dispatchEvent=function(t){if(!t.type)throw new Error("UNSPECIFIED_EVENT_TYPE_ERR");this.emit(t.type,t.detail)};w.prototype.removeEventListener=function(t,r){typeof r=="function"&&(r._listener=void 0,this.removeListener(t,r))};function $t(e,t){if(Object.defineProperty(this,"type",{writable:!1,value:e,enumerable:!0}),t)for(var r in t)t.hasOwnProperty(r)&&Object.defineProperty(this,r,{writable:!1,value:t[r],enumerable:!0})}function Hf(e,t){Object.defineProperty(this,"type",{writable:!1,value:e,enumerable:!0});for(var r in t)t.hasOwnProperty(r)&&Object.defineProperty(this,r,{writable:!1,value:t[r],enumerable:!0})}function Bf(e){var t={};for(var r in e)qf.test(r)||(t[r]=e[r]);return t}});var $c=h((w_,zc)=>{"use strict";var Lf=_(),Wc=p("events").EventEmitter,jf=Ki(),We=function(){};process.env.NODE_ENV!=="production"&&(We=E()("sockjs-client:receiver:eventsource"));function Kt(e){We(e),Wc.call(this);var t=this,r=this.es=new jf(e);r.onmessage=function(n){We("message",n.data),t.emit("message",decodeURI(n.data))},r.onerror=function(n){We("error",r.readyState,n);var i=r.readyState!==2?"network":"permanent";t._cleanup(),t._close(i)}}Lf(Kt,Wc);Kt.prototype.abort=function(){We("abort"),this._cleanup(),this._close("user")};Kt.prototype._cleanup=function(){We("cleanup");var e=this.es;e&&(e.onmessage=e.onerror=null,e.close(),this.es=null)};Kt.prototype._close=function(e){We("close",e);var t=this;setTimeout(function(){t.emit("close",null,e),t.removeAllListeners()},200)};zc.exports=Kt});var Xi=h((x_,Xc)=>{"use strict";var Gf=_(),Kc=je(),Wf=$c(),zf=Wt(),$f=Ki();function vt(e){if(!vt.enabled())throw new Error("Transport created when disabled");Kc.call(this,e,"/eventsource",Wf,zf)}Gf(vt,Kc);vt.enabled=function(){return!!$f};vt.transportName="eventsource";vt.roundTrips=2;Xc.exports=vt});var Yi=h((O_,Yc)=>{"use strict";Yc.exports="1.6.1"});var yt=h((S_,be)=>{"use strict";var an=xe(),Kf=mt(),De=function(){};process.env.NODE_ENV!=="production"&&(De=E()("sockjs-client:utils:iframe"));be.exports={WPrefix:"_jp",currentWindowId:null,polluteGlobalNamespace:function(){be.exports.WPrefix in global||(global[be.exports.WPrefix]={})},postMessage:function(e,t){global.parent!==global?global.parent.postMessage(JSON.stringify({windowId:be.exports.currentWindowId,type:e,data:t||""}),"*"):De("Cannot postMessage, no parent window.",e,t)},createIframe:function(e,t){var r=global.document.createElement("iframe"),n,i,s=function(){De("unattach"),clearTimeout(n);try{r.onload=null}catch{}r.onerror=null},o=function(){De("cleanup"),r&&(s(),setTimeout(function(){r&&r.parentNode.removeChild(r),r=null},0),an.unloadDel(i))},a=function(u){De("onerror",u),r&&(o(),t(u))},c=function(u,d){De("post",u,d),setTimeout(function(){try{r&&r.contentWindow&&r.contentWindow.postMessage(u,d)}catch{}},0)};return r.src=e,r.style.display="none",r.style.position="absolute",r.onerror=function(){a("onerror")},r.onload=function(){De("onload"),clearTimeout(n),n=setTimeout(function(){a("onload timeout")},2e3)},global.document.body.appendChild(r),n=setTimeout(function(){a("timeout")},15e3),i=an.unloadAdd(o),{post:c,cleanup:o,loaded:s}},createHtmlfile:function(e,t){var r=["Active"].concat("Object").join("X"),n=new global[r]("htmlfile"),i,s,o,a=function(){clearTimeout(i),o.onerror=null},c=function(){n&&(a(),an.unloadDel(s),o.parentNode.removeChild(o),o=n=null,CollectGarbage())},u=function(g){De("onerror",g),n&&(c(),t(g))},d=function(g,y){try{setTimeout(function(){o&&o.contentWindow&&o.contentWindow.postMessage(g,y)},0)}catch{}};n.open(),n.write('<html><script>document.domain="'+global.document.domain+'";</script></html>'),n.close(),n.parentWindow[be.exports.WPrefix]=global[be.exports.WPrefix];var l=n.createElement("div");return n.body.appendChild(l),o=n.createElement("iframe"),l.appendChild(o),o.src=e,o.onerror=function(){u("onerror")},i=setTimeout(function(){u("timeout")},15e3),s=an.unloadAdd(c),{post:d,cleanup:c,loaded:a}}};be.exports.iframeEnabled=!1;global.document&&(be.exports.iframeEnabled=(typeof global.postMessage=="function"||typeof global.postMessage=="object")&&!Kf.isKonqueror())});var Qi=h((M_,eu)=>{"use strict";var Xf=_(),Jc=p("events").EventEmitter,Yf=Yi(),Ji=K(),Qc=yt(),Zc=xe(),Jf=ke(),ee=function(){};process.env.NODE_ENV!=="production"&&(ee=E()("sockjs-client:transport:iframe"));function he(e,t,r){if(!he.enabled())throw new Error("Transport created when disabled");Jc.call(this);var n=this;this.origin=Ji.getOrigin(r),this.baseUrl=r,this.transUrl=t,this.transport=e,this.windowId=Jf.string(8);var i=Ji.addPath(r,"/iframe.html")+"#"+this.windowId;ee(e,t,i),this.iframeObj=Qc.createIframe(i,function(s){ee("err callback"),n.emit("close",1006,"Unable to load an iframe ("+s+")"),n.close()}),this.onmessageCallback=this._message.bind(this),Zc.attachEvent("message",this.onmessageCallback)}Xf(he,Jc);he.prototype.close=function(){if(ee("close"),this.removeAllListeners(),this.iframeObj){Zc.detachEvent("message",this.onmessageCallback);try{this.postMessage("c")}catch{}this.iframeObj.cleanup(),this.iframeObj=null,this.onmessageCallback=this.iframeObj=null}};he.prototype._message=function(e){if(ee("message",e.data),!Ji.isOriginEqual(e.origin,this.origin)){ee("not same origin",e.origin,this.origin);return}var t;try{t=JSON.parse(e.data)}catch{ee("bad json",e.data);return}if(t.windowId!==this.windowId){ee("mismatched window id",t.windowId,this.windowId);return}switch(t.type){case"s":this.iframeObj.loaded(),this.postMessage("s",JSON.stringify([Yf,this.transport,this.transUrl,this.baseUrl]));break;case"t":this.emit("message",t.data);break;case"c":var r;try{r=JSON.parse(t.data)}catch{ee("bad json",t.data);return}this.emit("close",r[0],r[1]),this.close();break}};he.prototype.postMessage=function(e,t){ee("postMessage",e,t),this.iframeObj.post(JSON.stringify({windowId:this.windowId,type:e,data:t||""}),this.origin)};he.prototype.send=function(e){ee("send",e),this.postMessage("m",e)};he.enabled=function(){return Qc.iframeEnabled};he.transportName="iframe";he.roundTrips=2;eu.exports=he});var cn=h((D_,tu)=>{"use strict";tu.exports={isObject:function(e){var t=typeof e;return t==="function"||t==="object"&&!!e},extend:function(e){if(!this.isObject(e))return e;for(var t,r,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}}});var ln=h((A_,ru)=>{"use strict";var Qf=_(),un=Qi(),Zf=cn();ru.exports=function(e){function t(r,n){un.call(this,e.transportName,r,n)}return Qf(t,un),t.enabled=function(r,n){if(!global.document)return!1;var i=Zf.extend({},n);return i.sameOrigin=!0,e.enabled(i)&&un.enabled()},t.transportName="iframe-"+e.transportName,t.needBody=!0,t.roundTrips=un.roundTrips+e.roundTrips-1,t.facadeTransport=e,t}});var ou=h((N_,su)=>{"use strict";var ep=_(),ze=yt(),tp=K(),iu=p("events").EventEmitter,rp=ke(),de=function(){};process.env.NODE_ENV!=="production"&&(de=E()("sockjs-client:receiver:htmlfile"));function te(e){de(e),iu.call(this);var t=this;ze.polluteGlobalNamespace(),this.id="a"+rp.string(6),e=tp.addQuery(e,"c="+decodeURIComponent(ze.WPrefix+"."+this.id)),de("using htmlfile",te.htmlfileEnabled);var r=te.htmlfileEnabled?ze.createHtmlfile:ze.createIframe;global[ze.WPrefix][this.id]={start:function(){de("start"),t.iframeObj.loaded()},message:function(n){de("message",n),t.emit("message",n)},stop:function(){de("stop"),t._cleanup(),t._close("network")}},this.iframeObj=r(e,function(){de("callback"),t._cleanup(),t._close("permanent")})}ep(te,iu);te.prototype.abort=function(){de("abort"),this._cleanup(),this._close("user")};te.prototype._cleanup=function(){de("_cleanup"),this.iframeObj&&(this.iframeObj.cleanup(),this.iframeObj=null),delete global[ze.WPrefix][this.id]};te.prototype._close=function(e){de("_close",e),this.emit("close",null,e),this.removeAllListeners()};te.htmlfileEnabled=!1;var nu=["Active"].concat("Object").join("X");if(nu in global)try{te.htmlfileEnabled=!!new global[nu]("htmlfile")}catch{}te.enabled=te.htmlfileEnabled||ze.iframeEnabled;su.exports=te});var es=h((I_,cu)=>{"use strict";var np=_(),Zi=ou(),ip=gt(),au=je();function Xt(e){if(!Zi.enabled)throw new Error("Transport created when disabled");au.call(this,e,"/htmlfile",Zi,ip)}np(Xt,au);Xt.enabled=function(e){return Zi.enabled&&e.sameOrigin};Xt.transportName="htmlfile";Xt.roundTrips=2;cu.exports=Xt});var rs=h((k_,hu)=>{"use strict";var sp=_(),uu=je(),op=jt(),ts=Wt(),lu=gt();function Yt(e){if(!lu.enabled&&!ts.enabled)throw new Error("Transport created when disabled");uu.call(this,e,"/xhr",op,ts)}sp(Yt,uu);Yt.enabled=function(e){return e.nullOrigin?!1:lu.enabled&&e.sameOrigin?!0:ts.enabled};Yt.transportName="xhr-polling";Yt.roundTrips=2;hu.exports=Yt});var gu=h((V_,pu)=>{"use strict";var ap=_(),fu=je(),cp=$i(),up=jt(),du=on();function Jt(e){if(!du.enabled)throw new Error("Transport created when disabled");fu.call(this,e,"/xhr",up,du)}ap(Jt,fu);Jt.enabled=cp.enabled;Jt.transportName="xdr-polling";Jt.roundTrips=2;pu.exports=Jt});var yu=h((P_,vu)=>{"use strict";var Qt=yt(),mu=ke(),lp=mt(),hp=K(),dp=_(),_u=p("events").EventEmitter,X=function(){};process.env.NODE_ENV!=="production"&&(X=E()("sockjs-client:receiver:jsonp"));function Y(e){X(e);var t=this;_u.call(this),Qt.polluteGlobalNamespace(),this.id="a"+mu.string(6);var r=hp.addQuery(e,"c="+encodeURIComponent(Qt.WPrefix+"."+this.id));global[Qt.WPrefix][this.id]=this._callback.bind(this),this._createScript(r),this.timeoutId=setTimeout(function(){X("timeout"),t._abort(new Error("JSONP script loaded abnormally (timeout)"))},Y.timeout)}dp(Y,_u);Y.prototype.abort=function(){if(X("abort"),global[Qt.WPrefix][this.id]){var e=new Error("JSONP user aborted read");e.code=1e3,this._abort(e)}};Y.timeout=35e3;Y.scriptErrorTimeout=1e3;Y.prototype._callback=function(e){X("_callback",e),this._cleanup(),!this.aborting&&(e&&(X("message",e),this.emit("message",e)),this.emit("close",null,"network"),this.removeAllListeners())};Y.prototype._abort=function(e){X("_abort",e),this._cleanup(),this.aborting=!0,this.emit("close",e.code,e.message),this.removeAllListeners()};Y.prototype._cleanup=function(){if(X("_cleanup"),clearTimeout(this.timeoutId),this.script2&&(this.script2.parentNode.removeChild(this.script2),this.script2=null),this.script){var e=this.script;e.parentNode.removeChild(e),e.onreadystatechange=e.onerror=e.onload=e.onclick=null,this.script=null}delete global[Qt.WPrefix][this.id]};Y.prototype._scriptError=function(){X("_scriptError");var e=this;this.errorTimer||(this.errorTimer=setTimeout(function(){e.loadedOkay||e._abort(new Error("JSONP script loaded abnormally (onerror)"))},Y.scriptErrorTimeout))};Y.prototype._createScript=function(e){X("_createScript",e);var t=this,r=this.script=global.document.createElement("script"),n;if(r.id="a"+mu.string(8),r.src=e,r.type="text/javascript",r.charset="UTF-8",r.onerror=this._scriptError.bind(this),r.onload=function(){X("onload"),t._abort(new Error("JSONP script loaded abnormally (onload)"))},r.onreadystatechange=function(){if(X("onreadystatechange",r.readyState),/loaded|closed/.test(r.readyState)){if(r&&r.htmlFor&&r.onclick){t.loadedOkay=!0;try{r.onclick()}catch{}}r&&t._abort(new Error("JSONP script loaded abnormally (onreadystatechange)"))}},typeof r.async>"u"&&global.document.attachEvent)if(lp.isOpera())n=this.script2=global.document.createElement("script"),n.text="try{var a = document.getElementById('"+r.id+"'); if(a)a.onerror();}catch(x){};",r.async=n.async=!1;else{try{r.htmlFor=r.id,r.event="onclick"}catch{}r.async=!0}typeof r.async<"u"&&(r.async=!0);var i=global.document.getElementsByTagName("head")[0];i.insertBefore(r,i.firstChild),n&&i.insertBefore(n,i.firstChild)};vu.exports=Y});var Eu=h((T_,Cu)=>{"use strict";var fp=ke(),bu=K(),fe=function(){};process.env.NODE_ENV!=="production"&&(fe=E()("sockjs-client:sender:jsonp"));var L,Zt;function pp(e){fe("createIframe",e);try{return global.document.createElement('<iframe name="'+e+'">')}catch{var t=global.document.createElement("iframe");return t.name=e,t}}function gp(){fe("createForm"),L=global.document.createElement("form"),L.style.display="none",L.style.position="absolute",L.method="POST",L.enctype="application/x-www-form-urlencoded",L.acceptCharset="UTF-8",Zt=global.document.createElement("textarea"),Zt.name="d",L.appendChild(Zt),global.document.body.appendChild(L)}Cu.exports=function(e,t,r){fe(e,t),L||gp();var n="a"+fp.string(8);L.target=n,L.action=bu.addQuery(bu.addPath(e,"/jsonp_send"),"i="+n);var i=pp(n);i.id=n,i.style.display="none",L.appendChild(i);try{Zt.value=t}catch{}L.submit();var s=function(o){fe("completed",n,o),i.onerror&&(i.onreadystatechange=i.onerror=i.onload=null,setTimeout(function(){fe("cleaning up",n),i.parentNode.removeChild(i),i=null},500),Zt.value="",r(o))};return i.onerror=function(){fe("onerror",n),s()},i.onload=function(){fe("onload",n),s()},i.onreadystatechange=function(o){fe("onreadystatechange",n,i.readyState,o),i.readyState==="complete"&&s()},function(){fe("aborted",n),s(new Error("Aborted"))}}});var Ou=h((F_,xu)=>{"use strict";var mp=_(),wu=Hi(),_p=yu(),vp=Eu();function $e(e){if(!$e.enabled())throw new Error("Transport created when disabled");wu.call(this,e,"/jsonp",vp,_p)}mp($e,wu);$e.enabled=function(){return!!global.document};$e.transportName="jsonp-polling";$e.roundTrips=1;$e.needBody=!0;xu.exports=$e});var Mu=h((R_,Su)=>{"use strict";Su.exports=[pc(),Pc(),$i(),Xi(),ln()(Xi()),es(),ln()(es()),rs(),gu(),ln()(rs()),Ou()]});var Pu=h(()=>{"use strict";var er=Array.prototype,os=Object.prototype,yp=Function.prototype,tr=String.prototype,ns=er.slice,as=os.toString,Nu=function(e){return os.toString.call(e)==="[object Function]"},bp=function(t){return as.call(t)==="[object Array]"},Iu=function(t){return as.call(t)==="[object String]"},Cp=Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),!0}catch{return!1}}(),ss;Cp?ss=function(e,t,r,n){!n&&t in e||Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:!0,value:r})}:ss=function(e,t,r,n){!n&&t in e||(e[t]=r)};var rr=function(e,t,r){for(var n in t)os.hasOwnProperty.call(t,n)&&ss(e,n,t[n],r)},ku=function(e){if(e==null)throw new TypeError("can't convert "+e+" to object");return Object(e)};function Ep(e){var t=+e;return t!==t?t=0:t!==0&&t!==1/0&&t!==-1/0&&(t=(t>0||-1)*Math.floor(Math.abs(t))),t}function wp(e){return e>>>0}function is(){}rr(yp,{bind:function(t){var r=this;if(!Nu(r))throw new TypeError("Function.prototype.bind called on incompatible "+r);for(var n=ns.call(arguments,1),i=function(){if(this instanceof c){var u=r.apply(this,n.concat(ns.call(arguments)));return Object(u)===u?u:this}else return r.apply(t,n.concat(ns.call(arguments)))},s=Math.max(0,r.length-n.length),o=[],a=0;a<s;a++)o.push("$"+a);var c=Function("binder","return function ("+o.join(",")+"){ return binder.apply(this, arguments); }")(i);return r.prototype&&(is.prototype=r.prototype,c.prototype=new is,is.prototype=null),c}});rr(Array,{isArray:bp});var Du=Object("a"),Vu=Du[0]!=="a"||!(0 in Du),xp=function(t){var r=!0,n=!0;return t&&(t.call("foo",function(i,s,o){typeof o!="object"&&(r=!1)}),t.call([1],function(){"use strict";n=typeof this=="string"},"x")),!!t&&r&&n};rr(er,{forEach:function(t){var r=ku(this),n=Vu&&Iu(this)?this.split(""):r,i=arguments[1],s=-1,o=n.length>>>0;if(!Nu(t))throw new TypeError;for(;++s<o;)s in n&&t.call(i,n[s],s,r)}},!xp(er.forEach));var Op=Array.prototype.indexOf&&[0,1].indexOf(1,2)!==-1;rr(er,{indexOf:function(t){var r=Vu&&Iu(this)?this.split(""):ku(this),n=r.length>>>0;if(!n)return-1;var i=0;for(arguments.length>1&&(i=Ep(arguments[1])),i=i>=0?i:Math.max(0,n+i);i<n;i++)if(i in r&&r[i]===t)return i;return-1}},Op);var Au=tr.split;"ab".split(/(?:ab)*/).length!==2||".".split(/(.?)(.?)/).length!==4||"tesst".split(/(s)*/)[1]==="t"||"test".split(/(?:)/,-1).length!==4||"".split(/.?/).length||".".split(/()()/).length>1?function(){var e=/()??/.exec("")[1]===void 0;tr.split=function(t,r){var n=this;if(t===void 0&&r===0)return[];if(as.call(t)!=="[object RegExp]")return Au.call(this,t,r);var i=[],s=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.extended?"x":"")+(t.sticky?"y":""),o=0,a,c,u,d;for(t=new RegExp(t.source,s+"g"),n+="",e||(a=new RegExp("^"+t.source+"$(?!\\s)",s)),r=r===void 0?-1>>>0:wp(r);(c=t.exec(n))&&(u=c.index+c[0].length,!(u>o&&(i.push(n.slice(o,c.index)),!e&&c.length>1&&c[0].replace(a,function(){for(var l=1;l<arguments.length-2;l++)arguments[l]===void 0&&(c[l]=void 0)}),c.length>1&&c.index<n.length&&er.push.apply(i,c.slice(1)),d=c[0].length,o=u,i.length>=r)));)t.lastIndex===c.index&&t.lastIndex++;return o===n.length?(d||!t.test(""))&&i.push(""):i.push(n.slice(o)),i.length>r?i.slice(0,r):i}}():"0".split(void 0,0).length&&(tr.split=function(t,r){return t===void 0&&r===0?[]:Au.call(this,t,r)});var Sp=tr.substr,Mp="".substr&&"0b".substr(-1)!=="b";rr(tr,{substr:function(t,r){return Sp.call(this,t<0&&(t=this.length+t)<0?0:t,r)}},Mp)});var Fu=h((H_,Tu)=>{"use strict";var hn=/[\x00-\x1f\ud800-\udfff\ufffe\uffff\u0300-\u0333\u033d-\u0346\u034a-\u034c\u0350-\u0352\u0357-\u0358\u035c-\u0362\u0374\u037e\u0387\u0591-\u05af\u05c4\u0610-\u0617\u0653-\u0654\u0657-\u065b\u065d-\u065e\u06df-\u06e2\u06eb-\u06ec\u0730\u0732-\u0733\u0735-\u0736\u073a\u073d\u073f-\u0741\u0743\u0745\u0747\u07eb-\u07f1\u0951\u0958-\u095f\u09dc-\u09dd\u09df\u0a33\u0a36\u0a59-\u0a5b\u0a5e\u0b5c-\u0b5d\u0e38-\u0e39\u0f43\u0f4d\u0f52\u0f57\u0f5c\u0f69\u0f72-\u0f76\u0f78\u0f80-\u0f83\u0f93\u0f9d\u0fa2\u0fa7\u0fac\u0fb9\u1939-\u193a\u1a17\u1b6b\u1cda-\u1cdb\u1dc0-\u1dcf\u1dfc\u1dfe\u1f71\u1f73\u1f75\u1f77\u1f79\u1f7b\u1f7d\u1fbb\u1fbe\u1fc9\u1fcb\u1fd3\u1fdb\u1fe3\u1feb\u1fee-\u1fef\u1ff9\u1ffb\u1ffd\u2000-\u2001\u20d0-\u20d1\u20d4-\u20d7\u20e7-\u20e9\u2126\u212a-\u212b\u2329-\u232a\u2adc\u302b-\u302c\uaab2-\uaab3\uf900-\ufa0d\ufa10\ufa12\ufa15-\ufa1e\ufa20\ufa22\ufa25-\ufa26\ufa2a-\ufa2d\ufa30-\ufa6d\ufa70-\ufad9\ufb1d\ufb1f\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufb4e\ufff0-\uffff]/g,cs,Dp=function(e){var t,r={},n=[];for(t=0;t<65536;t++)n.push(String.fromCharCode(t));return e.lastIndex=0,n.join("").replace(e,function(i){return r[i]="\\u"+("0000"+i.charCodeAt(0).toString(16)).slice(-4),""}),e.lastIndex=0,r};Tu.exports={quote:function(e){var t=JSON.stringify(e);return hn.lastIndex=0,hn.test(t)?(cs||(cs=Dp(hn)),t.replace(hn,function(r){return cs[r]})):t}}});var qu=h((B_,Ru)=>{"use strict";var nr=function(){};process.env.NODE_ENV!=="production"&&(nr=E()("sockjs-client:utils:transport"));Ru.exports=function(e){return{filterToEnabled:function(t,r){var n={main:[],facade:[]};return t?typeof t=="string"&&(t=[t]):t=[],e.forEach(function(i){if(i){if(i.transportName==="websocket"&&r.websocket===!1){nr("disabled from server","websocket");return}if(t.length&&t.indexOf(i.transportName)===-1){nr("not in whitelist",i.transportName);return}i.enabled(r)?(nr("enabled",i.transportName),n.main.push(i),i.facadeTransport&&n.facade.push(i.facadeTransport)):nr("disabled",i.transportName)}}),n}}}});var Hu=h((L_,Uu)=>{"use strict";var us={};["log","debug","warn"].forEach(function(e){var t;try{t=global.console&&global.console[e]&&global.console[e].apply}catch{}us[e]=t?function(){return global.console[e].apply(global.console,arguments)}:e==="log"?function(){}:us.log});Uu.exports=us});var dn=h((j_,Bu)=>{"use strict";function Ke(e){this.type=e}Ke.prototype.initEvent=function(e,t,r){return this.type=e,this.bubbles=t,this.cancelable=r,this.timeStamp=+new Date,this};Ke.prototype.stopPropagation=function(){};Ke.prototype.preventDefault=function(){};Ke.CAPTURING_PHASE=1;Ke.AT_TARGET=2;Ke.BUBBLING_PHASE=3;Bu.exports=Ke});var ju=h((G_,Lu)=>{"use strict";function fn(){this._listeners={}}fn.prototype.addEventListener=function(e,t){e in this._listeners||(this._listeners[e]=[]);var r=this._listeners[e];r.indexOf(t)===-1&&(r=r.concat([t])),this._listeners[e]=r};fn.prototype.removeEventListener=function(e,t){var r=this._listeners[e];if(r){var n=r.indexOf(t);if(n!==-1){r.length>1?this._listeners[e]=r.slice(0,n).concat(r.slice(n+1)):delete this._listeners[e];return}}};fn.prototype.dispatchEvent=function(){var e=arguments[0],t=e.type,r=arguments.length===1?[e]:Array.apply(null,arguments);if(this["on"+t]&&this["on"+t].apply(this,r),t in this._listeners)for(var n=this._listeners[t],i=0;i<n.length;i++)n[i].apply(this,r)};Lu.exports=fn});var ls=h((W_,Gu)=>{"use strict";Gu.exports=global.location||{origin:"http://localhost:80",protocol:"http:",host:"localhost",port:80,href:"http://localhost/",hash:""}});var Ku=h((z_,$u)=>{"use strict";var Ap=_(),Wu=dn();function zu(){Wu.call(this),this.initEvent("close",!1,!1),this.wasClean=!1,this.code=0,this.reason=""}Ap(zu,Wu);$u.exports=zu});var Qu=h(($_,Ju)=>{"use strict";var Np=_(),Xu=dn();function Yu(e){Xu.call(this),this.initEvent("message",!1,!1),this.data=e}Np(Yu,Xu);Ju.exports=Yu});var tl=h((K_,el)=>{"use strict";var Zu=p("events").EventEmitter,Ip=_();function ir(){var e=this;Zu.call(this),this.to=setTimeout(function(){e.emit("finish",200,"{}")},ir.timeout)}Ip(ir,Zu);ir.prototype.close=function(){clearTimeout(this.to)};ir.timeout=2e3;el.exports=ir});var ds=h((X_,il)=>{"use strict";var rl=p("events").EventEmitter,kp=_(),Vp=cn(),nl=function(){};process.env.NODE_ENV!=="production"&&(nl=E()("sockjs-client:info-ajax"));function hs(e,t){rl.call(this);var r=this,n=+new Date;this.xo=new t("GET",e),this.xo.once("finish",function(i,s){var o,a;if(i===200){if(a=+new Date-n,s)try{o=JSON.parse(s)}catch{nl("bad json",s)}Vp.isObject(o)||(o={})}r.emit("finish",o,a),r.removeAllListeners()})}kp(hs,rl);hs.prototype.close=function(){this.removeAllListeners(),this.xo.close()};il.exports=hs});var fs=h((Y_,ol)=>{"use strict";var Pp=_(),sl=p("events").EventEmitter,Tp=gt(),Fp=ds();function pn(e){var t=this;sl.call(this),this.ir=new Fp(e,Tp),this.ir.once("finish",function(r,n){t.ir=null,t.emit("message",JSON.stringify([r,n]))})}Pp(pn,sl);pn.transportName="iframe-info-receiver";pn.prototype.close=function(){this.ir&&(this.ir.close(),this.ir=null),this.removeAllListeners()};ol.exports=pn});var hl=h((J_,ll)=>{"use strict";var al=p("events").EventEmitter,Rp=_(),qp=xe(),cl=Qi(),Up=fs(),ul=function(){};process.env.NODE_ENV!=="production"&&(ul=E()("sockjs-client:info-iframe"));function gn(e,t){var r=this;al.call(this);var n=function(){var i=r.ifr=new cl(Up.transportName,t,e);i.once("message",function(s){if(s){var o;try{o=JSON.parse(s)}catch{ul("bad json",s),r.emit("finish"),r.close();return}var a=o[0],c=o[1];r.emit("finish",a,c)}r.close()}),i.once("close",function(){r.emit("finish"),r.close()})};global.document.body?n():qp.attachEvent("load",n)}Rp(gn,al);gn.enabled=function(){return cl.enabled()};gn.prototype.close=function(){this.ifr&&this.ifr.close(),this.removeAllListeners(),this.ifr=null};ll.exports=gn});var _l=h((Q_,ml)=>{"use strict";var gl=p("events").EventEmitter,Hp=_(),Bp=K(),dl=on(),fl=Wt(),Lp=gt(),jp=tl(),pl=hl(),mn=ds(),Xe=function(){};process.env.NODE_ENV!=="production"&&(Xe=E()("sockjs-client:info-receiver"));function Ce(e,t){Xe(e);var r=this;gl.call(this),setTimeout(function(){r.doXhr(e,t)},0)}Hp(Ce,gl);Ce._getReceiver=function(e,t,r){return r.sameOrigin?new mn(t,Lp):fl.enabled?new mn(t,fl):dl.enabled&&r.sameScheme?new mn(t,dl):pl.enabled()?new pl(e,t):new mn(t,jp)};Ce.prototype.doXhr=function(e,t){var r=this,n=Bp.addPath(e,"/info");Xe("doXhr",n),this.xo=Ce._getReceiver(e,n,t),this.timeoutRef=setTimeout(function(){Xe("timeout"),r._cleanup(!1),r.emit("finish")},Ce.timeout),this.xo.once("finish",function(i,s){Xe("finish",i,s),r._cleanup(!0),r.emit("finish",i,s)})};Ce.prototype._cleanup=function(e){Xe("_cleanup"),clearTimeout(this.timeoutRef),this.timeoutRef=null,!e&&this.xo&&this.xo.close(),this.xo=null};Ce.prototype.close=function(){Xe("close"),this.removeAllListeners(),this._cleanup(!1)};Ce.timeout=8e3;ml.exports=Ce});var bl=h((Z_,yl)=>{"use strict";var vl=yt();function sr(e){this._transport=e,e.on("message",this._transportMessage.bind(this)),e.on("close",this._transportClose.bind(this))}sr.prototype._transportClose=function(e,t){vl.postMessage("c",JSON.stringify([e,t]))};sr.prototype._transportMessage=function(e){vl.postMessage("t",e)};sr.prototype._send=function(e){this._transport.send(e)};sr.prototype._close=function(){this._transport.close(),this._transport.removeAllListeners()};yl.exports=sr});var xl=h((ev,wl)=>{"use strict";var Cl=K(),Gp=xe(),Wp=bl(),El=fs(),ps=yt(),_n=ls(),vn=function(){};process.env.NODE_ENV!=="production"&&(vn=E()("sockjs-client:iframe-bootstrap"));wl.exports=function(e,t){var r={};t.forEach(function(i){i.facadeTransport&&(r[i.facadeTransport.transportName]=i.facadeTransport)}),r[El.transportName]=El;var n;e.bootstrap_iframe=function(){var i;ps.currentWindowId=_n.hash.slice(1);var s=function(o){if(o.source===parent&&(typeof n>"u"&&(n=o.origin),o.origin===n)){var a;try{a=JSON.parse(o.data)}catch{vn("bad json",o.data);return}if(a.windowId===ps.currentWindowId)switch(a.type){case"s":var c;try{c=JSON.parse(a.data)}catch{vn("bad json",a.data);break}var u=c[0],d=c[1],l=c[2],g=c[3];if(vn(u,d,l,g),u!==e.version)throw new Error('Incompatible SockJS! Main site uses: "'+u+'", the iframe: "'+e.version+'".');if(!Cl.isOriginEqual(l,_n.href)||!Cl.isOriginEqual(g,_n.href))throw new Error("Can't connect to different domain from within an iframe. ("+_n.href+", "+l+", "+g+")");i=new Wp(new r[d](l,g));break;case"m":i._send(a.data);break;case"c":i&&i._close(),i=null;break}}};Gp.attachEvent("message",s),ps.postMessage("s")}}});var Il=h((tv,Nl)=>{"use strict";Pu();var zp=Vr(),$p=_(),Ol=ke(),Kp=Fu(),or=K(),Xp=xe(),Yp=qu(),Jp=cn(),Qp=mt(),Zp=Hu(),gs=dn(),Ml=ju(),yn=ls(),eg=Ku(),Sl=Qu(),tg=_l(),O=function(){};process.env.NODE_ENV!=="production"&&(O=E()("sockjs-client:main"));var Dl;function m(e,t,r){if(!(this instanceof m))return new m(e,t,r);if(arguments.length<1)throw new TypeError("Failed to construct 'SockJS: 1 argument required, but only 0 present");Ml.call(this),this.readyState=m.CONNECTING,this.extensions="",this.protocol="",r=r||{},r.protocols_whitelist&&Zp.warn("'protocols_whitelist' is DEPRECATED. Use 'transports' instead."),this._transportsWhitelist=r.transports,this._transportOptions=r.transportOptions||{},this._timeout=r.timeout||0;var n=r.sessionId||8;if(typeof n=="function")this._generateSessionId=n;else if(typeof n=="number")this._generateSessionId=function(){return Ol.string(n)};else throw new TypeError("If sessionId is used in the options, it needs to be a number or a function.");this._server=r.server||Ol.numberString(1e3);var i=new zp(e);if(!i.host||!i.protocol)throw new SyntaxError("The URL '"+e+"' is invalid");if(i.hash)throw new SyntaxError("The URL must not contain a fragment");if(i.protocol!=="http:"&&i.protocol!=="https:")throw new SyntaxError("The URL's scheme must be either 'http:' or 'https:'. '"+i.protocol+"' is not allowed.");var s=i.protocol==="https:";if(yn.protocol==="https:"&&!s&&!or.isLoopbackAddr(i.hostname))throw new Error("SecurityError: An insecure SockJS connection may not be initiated from a page loaded over HTTPS");t?Array.isArray(t)||(t=[t]):t=[];var o=t.sort();o.forEach(function(c,u){if(!c)throw new SyntaxError("The protocols entry '"+c+"' is invalid.");if(u<o.length-1&&c===o[u+1])throw new SyntaxError("The protocols entry '"+c+"' is duplicated.")});var a=or.getOrigin(yn.href);this._origin=a?a.toLowerCase():null,i.set("pathname",i.pathname.replace(/\/+$/,"")),this.url=i.href,O("using url",this.url),this._urlInfo={nullOrigin:!Qp.hasDomain(),sameOrigin:or.isOriginEqual(this.url,yn.href),sameScheme:or.isSchemeEqual(this.url,yn.href)},this._ir=new tg(this.url,this._urlInfo),this._ir.once("finish",this._receiveInfo.bind(this))}$p(m,Ml);function Al(e){return e===1e3||e>=3e3&&e<=4999}m.prototype.close=function(e,t){if(e&&!Al(e))throw new Error("InvalidAccessError: Invalid code");if(t&&t.length>123)throw new SyntaxError("reason argument has an invalid length");if(!(this.readyState===m.CLOSING||this.readyState===m.CLOSED)){var r=!0;this._close(e||1e3,t||"Normal closure",r)}};m.prototype.send=function(e){if(typeof e!="string"&&(e=""+e),this.readyState===m.CONNECTING)throw new Error("InvalidStateError: The connection has not been established yet");this.readyState===m.OPEN&&this._transport.send(Kp.quote(e))};m.version=Yi();m.CONNECTING=0;m.OPEN=1;m.CLOSING=2;m.CLOSED=3;m.prototype._receiveInfo=function(e,t){if(O("_receiveInfo",t),this._ir=null,!e){this._close(1002,"Cannot connect to server");return}this._rto=this.countRTO(t),this._transUrl=e.base_url?e.base_url:this.url,e=Jp.extend(e,this._urlInfo),O("info",e);var r=Dl.filterToEnabled(this._transportsWhitelist,e);this._transports=r.main,O(this._transports.length+" enabled transports"),this._connect()};m.prototype._connect=function(){for(var e=this._transports.shift();e;e=this._transports.shift()){if(O("attempt",e.transportName),e.needBody&&(!global.document.body||typeof global.document.readyState<"u"&&global.document.readyState!=="complete"&&global.document.readyState!=="interactive")){O("waiting for body"),this._transports.unshift(e),Xp.attachEvent("load",this._connect.bind(this));return}var t=Math.max(this._timeout,this._rto*e.roundTrips||5e3);this._transportTimeoutId=setTimeout(this._transportTimeout.bind(this),t),O("using timeout",t);var r=or.addPath(this._transUrl,"/"+this._server+"/"+this._generateSessionId()),n=this._transportOptions[e.transportName];O("transport url",r);var i=new e(r,this._transUrl,n);i.on("message",this._transportMessage.bind(this)),i.once("close",this._transportClose.bind(this)),i.transportName=e.transportName,this._transport=i;return}this._close(2e3,"All transports failed",!1)};m.prototype._transportTimeout=function(){O("_transportTimeout"),this.readyState===m.CONNECTING&&(this._transport&&this._transport.close(),this._transportClose(2007,"Transport timed out"))};m.prototype._transportMessage=function(e){O("_transportMessage",e);var t=this,r=e.slice(0,1),n=e.slice(1),i;switch(r){case"o":this._open();return;case"h":this.dispatchEvent(new gs("heartbeat")),O("heartbeat",this.transport);return}if(n)try{i=JSON.parse(n)}catch{O("bad json",n)}if(typeof i>"u"){O("empty payload",n);return}switch(r){case"a":Array.isArray(i)&&i.forEach(function(s){O("message",t.transport,s),t.dispatchEvent(new Sl(s))});break;case"m":O("message",this.transport,i),this.dispatchEvent(new Sl(i));break;case"c":Array.isArray(i)&&i.length===2&&this._close(i[0],i[1],!0);break}};m.prototype._transportClose=function(e,t){if(O("_transportClose",this.transport,e,t),this._transport&&(this._transport.removeAllListeners(),this._transport=null,this.transport=null),!Al(e)&&e!==2e3&&this.readyState===m.CONNECTING){this._connect();return}this._close(e,t)};m.prototype._open=function(){O("_open",this._transport&&this._transport.transportName,this.readyState),this.readyState===m.CONNECTING?(this._transportTimeoutId&&(clearTimeout(this._transportTimeoutId),this._transportTimeoutId=null),this.readyState=m.OPEN,this.transport=this._transport.transportName,this.dispatchEvent(new gs("open")),O("connected",this.transport)):this._close(1006,"Server lost session")};m.prototype._close=function(e,t,r){O("_close",this.transport,e,t,r,this.readyState);var n=!1;if(this._ir&&(n=!0,this._ir.close(),this._ir=null),this._transport&&(this._transport.close(),this._transport=null,this.transport=null),this.readyState===m.CLOSED)throw new Error("InvalidStateError: SockJS has already been closed");this.readyState=m.CLOSING,setTimeout(function(){this.readyState=m.CLOSED,n&&this.dispatchEvent(new gs("error"));var i=new eg("close");i.wasClean=r||!1,i.code=e||1e3,i.reason=t,this.dispatchEvent(i),this.onmessage=this.onclose=this.onerror=null,O("disconnected")}.bind(this),0)};m.prototype.countRTO=function(e){return e>100?4*e:300+e};Nl.exports=function(e){return Dl=Yp(e),xl()(m,e),m}});var Vl=h((rv,kl)=>{"use strict";var rg=Mu();kl.exports=Il()(rg);"_sockjs_onload"in global&&setTimeout(global._sockjs_onload,1)});var Xs=(()=>{class e{title="Socket-UI";static \u0275fac=function(n){return new(n||e)};static \u0275cmp=yr({type:e,selectors:[["app-root"]],standalone:!0,features:[Or],decls:1,vars:0,template:function(n,i){n&1&&br(0,"router-outlet")},dependencies:[zs],styles:['*[_ngcontent-%COMP%]{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}html[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{height:100%;overflow:hidden}body[_ngcontent-%COMP%]{margin:0;padding:0;font-weight:400;font-family:Helvetica Neue,Helvetica,Arial,sans-serif;font-size:1rem;line-height:1.58;color:#333;background-color:#f4f4f4;height:100%}.clearfix[_ngcontent-%COMP%]:after{display:block;content:"";clear:both}.hidden[_ngcontent-%COMP%]{display:none}.form-control[_ngcontent-%COMP%]{width:100%;min-height:38px;font-size:15px;border:1px solid #c8c8c8}.form-group[_ngcontent-%COMP%]{margin-bottom:15px}input[_ngcontent-%COMP%]{padding-left:10px;outline:none}h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%], h5[_ngcontent-%COMP%], h6[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:20px}h1[_ngcontent-%COMP%]{font-size:1.7em}a[_ngcontent-%COMP%]{color:#6db33f}button[_ngcontent-%COMP%]{box-shadow:none;border:1px solid transparent;font-size:14px;outline:none;line-height:100%;white-space:nowrap;vertical-align:middle;padding:.6rem 1rem;border-radius:2px;transition:all .2s ease-in-out;cursor:pointer;min-height:38px}button.default[_ngcontent-%COMP%]{background-color:#e8e8e8;color:#333;box-shadow:0 2px 2px #0000001f}button.primary[_ngcontent-%COMP%], button.accent[_ngcontent-%COMP%]{background-color:#6db33f;box-shadow:0 2px 2px #0000001f;color:#fff}#username-page[_ngcontent-%COMP%]{text-align:center}.username-page-container[_ngcontent-%COMP%]{background:#fff;box-shadow:0 1px 11px #00000045;border-radius:2px;width:100%;max-width:500px;display:inline-block;vertical-align:middle;position:relative;padding:35px 55px;min-height:250px;position:absolute;top:50%;left:0;right:0;margin:-160px auto 0}.username-page-container[_ngcontent-%COMP%]   .username-submit[_ngcontent-%COMP%]{margin-top:10px}#chat-page[_ngcontent-%COMP%]{position:relative;height:100%}.chat-container[_ngcontent-%COMP%]{max-width:700px;margin-left:auto;margin-right:auto;background-color:#fff;box-shadow:0 1px 11px #00000045;margin-top:30px;height:calc(100% - 60px);max-height:600px;position:relative}#chat-page[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style-type:none;background-color:#fff;margin:0;overflow:auto;overflow-y:scroll;padding:0 20px;height:calc(100% - 150px)}#chat-page[_ngcontent-%COMP%]   #messageForm[_ngcontent-%COMP%]{padding:25px}#chat-page[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{line-height:1.5rem;padding:10px 20px;margin:0;border-bottom:1px solid #f4f4f4}#chat-page[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}#chat-page[_ngcontent-%COMP%]   .event-message[_ngcontent-%COMP%]{width:100%;text-align:center;clear:both}#chat-page[_ngcontent-%COMP%]   .event-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#777;font-size:14px;word-wrap:break-word}#chat-page[_ngcontent-%COMP%]   .chat-message[_ngcontent-%COMP%]{padding-left:68px;position:relative}#chat-page[_ngcontent-%COMP%]   .chat-message[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{position:absolute;width:42px;height:42px;overflow:hidden;left:10px;display:inline-block;vertical-align:middle;font-size:18px;line-height:42px;color:#fff;text-align:center;border-radius:50%;font-style:normal;text-transform:uppercase}#chat-page[_ngcontent-%COMP%]   .chat-message[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#333;font-weight:600}#chat-page[_ngcontent-%COMP%]   .chat-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#43464b}#messageForm[_ngcontent-%COMP%]{display:flex;padding:15px;background-color:#fff;border-top:1px solid #ececec;box-shadow:0 -2px 5px #0000001a}#messageForm[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{width:100%;margin:0}#messageForm[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}#messageForm[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex-grow:1;padding:10px;border:1px solid #ccc;border-radius:20px;outline:none;font-size:14px;transition:border-color .3s ease}#messageForm[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:#4caf50}#messageForm[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:10px 20px;background-color:#4caf50;color:#fff;border:none;border-radius:20px;font-size:14px;cursor:pointer;transition:background-color .3s ease,transform .2s ease}#messageForm[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#45a049;transform:scale(1.05)}@media screen and (max-width: 480px){#messageForm[_ngcontent-%COMP%]{padding:10px}#messageForm[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]{flex-direction:column;gap:5px}#messageForm[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], #messageForm[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}}.chat-header[_ngcontent-%COMP%]{text-align:center;padding:0% 20px;background-color:#fff;border-bottom:1px solid #ececec}.chat-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-weight:500}.connecting[_ngcontent-%COMP%]{padding-top:5px;text-align:center;color:#777;position:absolute;top:200px;width:100%}.header-actions[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:10px;margin-top:10px}.header-actions[_ngcontent-%COMP%]   #onlineUsers[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#333}.header-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:5px 10px;font-size:14px;border:none;border-radius:4px;background-color:#4caf50;color:#fff;cursor:pointer;transition:background-color .3s ease}.header-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#45a049}@media screen and (max-width: 730px){.chat-container[_ngcontent-%COMP%]{margin-left:10px;margin-right:10px;margin-top:10px}}@media screen and (max-width: 480px){.chat-container[_ngcontent-%COMP%]{height:calc(100% - 30px)}.username-page-container[_ngcontent-%COMP%]{width:auto;margin-left:15px;margin-right:15px;padding:25px}#chat-page[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{height:calc(100% - 120px)}.chat-header[_ngcontent-%COMP%]{padding:10px}.connecting[_ngcontent-%COMP%]{top:200px}.chat-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.1em}}']})}return e})();function Ys(e,t){e.terminate=function(){let r=()=>{};this.onerror=r,this.onmessage=r,this.onopen=r;let n=new Date,i=Math.random().toString().substring(2,8),s=this.onclose;this.onclose=o=>{let a=new Date().getTime()-n.getTime();t(`Discarded socket (#${i})  closed after ${a}ms, with code/reason: ${o.code}/${o.reason}`)},this.close(),s?.call(e,{code:4001,reason:`Quick discarding socket (#${i}) without waiting for the shutdown sequence.`,wasClean:!1})}}var Ie={LF:`
`,NULL:"\0"};var Nt=class e{get body(){return!this._body&&this.isBinaryBody&&(this._body=new TextDecoder().decode(this._binaryBody)),this._body||""}get binaryBody(){return!this._binaryBody&&!this.isBinaryBody&&(this._binaryBody=new TextEncoder().encode(this._body)),this._binaryBody}constructor(t){let{command:r,headers:n,body:i,binaryBody:s,escapeHeaderValues:o,skipContentLengthHeader:a}=t;this.command=r,this.headers=Object.assign({},n||{}),s?(this._binaryBody=s,this.isBinaryBody=!0):(this._body=i||"",this.isBinaryBody=!1),this.escapeHeaderValues=o||!1,this.skipContentLengthHeader=a||!1}static fromRawFrame(t,r){let n={},i=s=>s.replace(/^\s+|\s+$/g,"");for(let s of t.headers.reverse()){let o=s.indexOf(":"),a=i(s[0]),c=i(s[1]);r&&t.command!=="CONNECT"&&t.command!=="CONNECTED"&&(c=e.hdrValueUnEscape(c)),n[a]=c}return new e({command:t.command,headers:n,binaryBody:t.binaryBody,escapeHeaderValues:r})}toString(){return this.serializeCmdAndHeaders()}serialize(){let t=this.serializeCmdAndHeaders();return this.isBinaryBody?e.toUnit8Array(t,this._binaryBody).buffer:t+this._body+Ie.NULL}serializeCmdAndHeaders(){let t=[this.command];this.skipContentLengthHeader&&delete this.headers["content-length"];for(let r of Object.keys(this.headers||{})){let n=this.headers[r];this.escapeHeaderValues&&this.command!=="CONNECT"&&this.command!=="CONNECTED"?t.push(`${r}:${e.hdrValueEscape(`${n}`)}`):t.push(`${r}:${n}`)}return(this.isBinaryBody||!this.isBodyEmpty()&&!this.skipContentLengthHeader)&&t.push(`content-length:${this.bodyLength()}`),t.join(Ie.LF)+Ie.LF+Ie.LF}isBodyEmpty(){return this.bodyLength()===0}bodyLength(){let t=this.binaryBody;return t?t.length:0}static sizeOfUTF8(t){return t?new TextEncoder().encode(t).length:0}static toUnit8Array(t,r){let n=new TextEncoder().encode(t),i=new Uint8Array([0]),s=new Uint8Array(n.length+r.length+i.length);return s.set(n),s.set(r,n.length),s.set(i,n.length+r.length),s}static marshall(t){return new e(t).serialize()}static hdrValueEscape(t){return t.replace(/\\/g,"\\\\").replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/:/g,"\\c")}static hdrValueUnEscape(t){return t.replace(/\\r/g,"\r").replace(/\\n/g,`
`).replace(/\\c/g,":").replace(/\\\\/g,"\\")}};var Sr=class{constructor(t,r){this.onFrame=t,this.onIncomingPing=r,this._encoder=new TextEncoder,this._decoder=new TextDecoder,this._token=[],this._initState()}parseChunk(t,r=!1){let n;if(typeof t=="string"?n=this._encoder.encode(t):n=new Uint8Array(t),r&&n[n.length-1]!==0){let i=new Uint8Array(n.length+1);i.set(n,0),i[n.length]=0,n=i}for(let i=0;i<n.length;i++){let s=n[i];this._onByte(s)}}_collectFrame(t){if(t!==0&&t!==13){if(t===10){this.onIncomingPing();return}this._onByte=this._collectCommand,this._reinjectByte(t)}}_collectCommand(t){if(t!==13){if(t===10){this._results.command=this._consumeTokenAsUTF8(),this._onByte=this._collectHeaders;return}this._consumeByte(t)}}_collectHeaders(t){if(t!==13){if(t===10){this._setupCollectBody();return}this._onByte=this._collectHeaderKey,this._reinjectByte(t)}}_reinjectByte(t){this._onByte(t)}_collectHeaderKey(t){if(t===58){this._headerKey=this._consumeTokenAsUTF8(),this._onByte=this._collectHeaderValue;return}this._consumeByte(t)}_collectHeaderValue(t){if(t!==13){if(t===10){this._results.headers.push([this._headerKey,this._consumeTokenAsUTF8()]),this._headerKey=void 0,this._onByte=this._collectHeaders;return}this._consumeByte(t)}}_setupCollectBody(){let t=this._results.headers.filter(r=>r[0]==="content-length")[0];t?(this._bodyBytesRemaining=parseInt(t[1],10),this._onByte=this._collectBodyFixedSize):this._onByte=this._collectBodyNullTerminated}_collectBodyNullTerminated(t){if(t===0){this._retrievedBody();return}this._consumeByte(t)}_collectBodyFixedSize(t){if(this._bodyBytesRemaining--===0){this._retrievedBody();return}this._consumeByte(t)}_retrievedBody(){this._results.binaryBody=this._consumeTokenAsRaw();try{this.onFrame(this._results)}catch(t){console.log("Ignoring an exception thrown by a frame handler. Original exception: ",t)}this._initState()}_consumeByte(t){this._token.push(t)}_consumeTokenAsUTF8(){return this._decoder.decode(this._consumeTokenAsRaw())}_consumeTokenAsRaw(){let t=new Uint8Array(this._token);return this._token=[],t}_initState(){this._results={command:void 0,headers:[],binaryBody:void 0},this._token=[],this._headerKey=void 0,this._onByte=this._collectFrame}};var me=function(e){return e[e.CONNECTING=0]="CONNECTING",e[e.OPEN=1]="OPEN",e[e.CLOSING=2]="CLOSING",e[e.CLOSED=3]="CLOSED",e}(me||{}),Z=function(e){return e[e.ACTIVE=0]="ACTIVE",e[e.DEACTIVATING=1]="DEACTIVATING",e[e.INACTIVE=2]="INACTIVE",e}(Z||{}),Mr=function(e){return e[e.LINEAR=0]="LINEAR",e[e.EXPONENTIAL=1]="EXPONENTIAL",e}(Mr||{}),it=function(e){return e.Interval="interval",e.Worker="worker",e}(it||{});var Dr=class{constructor(t,r=it.Interval,n){this._interval=t,this._strategy=r,this._debug=n,this._workerScript=`
    var startTime = Date.now();
    setInterval(function() {
        self.postMessage(Date.now() - startTime);
    }, ${this._interval});
  `}start(t){this.stop(),this.shouldUseWorker()?this.runWorker(t):this.runInterval(t)}stop(){this.disposeWorker(),this.disposeInterval()}shouldUseWorker(){return typeof Worker<"u"&&this._strategy===it.Worker}runWorker(t){this._debug("Using runWorker for outgoing pings"),this._worker||(this._worker=new Worker(URL.createObjectURL(new Blob([this._workerScript],{type:"text/javascript"}))),this._worker.onmessage=r=>t(r.data))}runInterval(t){if(this._debug("Using runInterval for outgoing pings"),!this._timer){let r=Date.now();this._timer=setInterval(()=>{t(Date.now()-r)},this._interval)}}disposeWorker(){this._worker&&(this._worker.terminate(),delete this._worker,this._debug("Outgoing ping disposeWorker"))}disposeInterval(){this._timer&&(clearInterval(this._timer),delete this._timer,this._debug("Outgoing ping disposeInterval"))}};var D=class{constructor(t){this.versions=t}supportedVersions(){return this.versions.join(",")}protocolVersions(){return this.versions.map(t=>`v${t.replace(".","")}.stomp`)}};D.V1_0="1.0";D.V1_1="1.1";D.V1_2="1.2";D.default=new D([D.V1_2,D.V1_1,D.V1_0]);var Ar=class{get connectedVersion(){return this._connectedVersion}get connected(){return this._connected}constructor(t,r,n){this._client=t,this._webSocket=r,this._connected=!1,this._serverFrameHandlers={CONNECTED:i=>{this.debug(`connected to server ${i.headers.server}`),this._connected=!0,this._connectedVersion=i.headers.version,this._connectedVersion===D.V1_2&&(this._escapeHeaderValues=!0),this._setupHeartbeat(i.headers),this.onConnect(i)},MESSAGE:i=>{let s=i.headers.subscription,o=this._subscriptions[s]||this.onUnhandledMessage,a=i,c=this,u=this._connectedVersion===D.V1_2?a.headers.ack:a.headers["message-id"];a.ack=(d={})=>c.ack(u,s,d),a.nack=(d={})=>c.nack(u,s,d),o(a)},RECEIPT:i=>{let s=this._receiptWatchers[i.headers["receipt-id"]];s?(s(i),delete this._receiptWatchers[i.headers["receipt-id"]]):this.onUnhandledReceipt(i)},ERROR:i=>{this.onStompError(i)}},this._counter=0,this._subscriptions={},this._receiptWatchers={},this._partialData="",this._escapeHeaderValues=!1,this._lastServerActivityTS=Date.now(),this.debug=n.debug,this.stompVersions=n.stompVersions,this.connectHeaders=n.connectHeaders,this.disconnectHeaders=n.disconnectHeaders,this.heartbeatIncoming=n.heartbeatIncoming,this.heartbeatOutgoing=n.heartbeatOutgoing,this.splitLargeFrames=n.splitLargeFrames,this.maxWebSocketChunkSize=n.maxWebSocketChunkSize,this.forceBinaryWSFrames=n.forceBinaryWSFrames,this.logRawCommunication=n.logRawCommunication,this.appendMissingNULLonIncoming=n.appendMissingNULLonIncoming,this.discardWebsocketOnCommFailure=n.discardWebsocketOnCommFailure,this.onConnect=n.onConnect,this.onDisconnect=n.onDisconnect,this.onStompError=n.onStompError,this.onWebSocketClose=n.onWebSocketClose,this.onWebSocketError=n.onWebSocketError,this.onUnhandledMessage=n.onUnhandledMessage,this.onUnhandledReceipt=n.onUnhandledReceipt,this.onUnhandledFrame=n.onUnhandledFrame}start(){let t=new Sr(r=>{let n=Nt.fromRawFrame(r,this._escapeHeaderValues);this.logRawCommunication||this.debug(`<<< ${n}`),(this._serverFrameHandlers[n.command]||this.onUnhandledFrame)(n)},()=>{this.debug("<<< PONG")});this._webSocket.onmessage=r=>{if(this.debug("Received data"),this._lastServerActivityTS=Date.now(),this.logRawCommunication){let n=r.data instanceof ArrayBuffer?new TextDecoder().decode(r.data):r.data;this.debug(`<<< ${n}`)}t.parseChunk(r.data,this.appendMissingNULLonIncoming)},this._webSocket.onclose=r=>{this.debug(`Connection closed to ${this._webSocket.url}`),this._cleanUp(),this.onWebSocketClose(r)},this._webSocket.onerror=r=>{this.onWebSocketError(r)},this._webSocket.onopen=()=>{let r=Object.assign({},this.connectHeaders);this.debug("Web Socket Opened..."),r["accept-version"]=this.stompVersions.supportedVersions(),r["heart-beat"]=[this.heartbeatOutgoing,this.heartbeatIncoming].join(","),this._transmit({command:"CONNECT",headers:r})}}_setupHeartbeat(t){if(t.version!==D.V1_1&&t.version!==D.V1_2||!t["heart-beat"])return;let[r,n]=t["heart-beat"].split(",").map(i=>parseInt(i,10));if(this.heartbeatOutgoing!==0&&n!==0){let i=Math.max(this.heartbeatOutgoing,n);this.debug(`send PING every ${i}ms`),this._pinger=new Dr(i,this._client.heartbeatStrategy,this.debug),this._pinger.start(()=>{this._webSocket.readyState===me.OPEN&&(this._webSocket.send(Ie.LF),this.debug(">>> PING"))})}if(this.heartbeatIncoming!==0&&r!==0){let i=Math.max(this.heartbeatIncoming,r);this.debug(`check PONG every ${i}ms`),this._ponger=setInterval(()=>{let s=Date.now()-this._lastServerActivityTS;s>i*2&&(this.debug(`did not receive server activity for the last ${s}ms`),this._closeOrDiscardWebsocket())},i)}}_closeOrDiscardWebsocket(){this.discardWebsocketOnCommFailure?(this.debug("Discarding websocket, the underlying socket may linger for a while"),this.discardWebsocket()):(this.debug("Issuing close on the websocket"),this._closeWebsocket())}forceDisconnect(){this._webSocket&&(this._webSocket.readyState===me.CONNECTING||this._webSocket.readyState===me.OPEN)&&this._closeOrDiscardWebsocket()}_closeWebsocket(){this._webSocket.onmessage=()=>{},this._webSocket.close()}discardWebsocket(){typeof this._webSocket.terminate!="function"&&Ys(this._webSocket,t=>this.debug(t)),this._webSocket.terminate()}_transmit(t){let{command:r,headers:n,body:i,binaryBody:s,skipContentLengthHeader:o}=t,a=new Nt({command:r,headers:n,body:i,binaryBody:s,escapeHeaderValues:this._escapeHeaderValues,skipContentLengthHeader:o}),c=a.serialize();if(this.logRawCommunication?this.debug(`>>> ${c}`):this.debug(`>>> ${a}`),this.forceBinaryWSFrames&&typeof c=="string"&&(c=new TextEncoder().encode(c)),typeof c!="string"||!this.splitLargeFrames)this._webSocket.send(c);else{let u=c;for(;u.length>0;){let d=u.substring(0,this.maxWebSocketChunkSize);u=u.substring(this.maxWebSocketChunkSize),this._webSocket.send(d),this.debug(`chunk sent = ${d.length}, remaining = ${u.length}`)}}}dispose(){if(this.connected)try{let t=Object.assign({},this.disconnectHeaders);t.receipt||(t.receipt=`close-${this._counter++}`),this.watchForReceipt(t.receipt,r=>{this._closeWebsocket(),this._cleanUp(),this.onDisconnect(r)}),this._transmit({command:"DISCONNECT",headers:t})}catch(t){this.debug(`Ignoring error during disconnect ${t}`)}else(this._webSocket.readyState===me.CONNECTING||this._webSocket.readyState===me.OPEN)&&this._closeWebsocket()}_cleanUp(){this._connected=!1,this._pinger&&(this._pinger.stop(),this._pinger=void 0),this._ponger&&(clearInterval(this._ponger),this._ponger=void 0)}publish(t){let{destination:r,headers:n,body:i,binaryBody:s,skipContentLengthHeader:o}=t,a=Object.assign({destination:r},n);this._transmit({command:"SEND",headers:a,body:i,binaryBody:s,skipContentLengthHeader:o})}watchForReceipt(t,r){this._receiptWatchers[t]=r}subscribe(t,r,n={}){n=Object.assign({},n),n.id||(n.id=`sub-${this._counter++}`),n.destination=t,this._subscriptions[n.id]=r,this._transmit({command:"SUBSCRIBE",headers:n});let i=this;return{id:n.id,unsubscribe(s){return i.unsubscribe(n.id,s)}}}unsubscribe(t,r={}){r=Object.assign({},r),delete this._subscriptions[t],r.id=t,this._transmit({command:"UNSUBSCRIBE",headers:r})}begin(t){let r=t||`tx-${this._counter++}`;this._transmit({command:"BEGIN",headers:{transaction:r}});let n=this;return{id:r,commit(){n.commit(r)},abort(){n.abort(r)}}}commit(t){this._transmit({command:"COMMIT",headers:{transaction:t}})}abort(t){this._transmit({command:"ABORT",headers:{transaction:t}})}ack(t,r,n={}){n=Object.assign({},n),this._connectedVersion===D.V1_2?n.id=t:n["message-id"]=t,n.subscription=r,this._transmit({command:"ACK",headers:n})}nack(t,r,n={}){return n=Object.assign({},n),this._connectedVersion===D.V1_2?n.id=t:n["message-id"]=t,n.subscription=r,this._transmit({command:"NACK",headers:n})}};var Nr=class{get webSocket(){return this._stompHandler?._webSocket}get disconnectHeaders(){return this._disconnectHeaders}set disconnectHeaders(t){this._disconnectHeaders=t,this._stompHandler&&(this._stompHandler.disconnectHeaders=this._disconnectHeaders)}get connected(){return!!this._stompHandler&&this._stompHandler.connected}get connectedVersion(){return this._stompHandler?this._stompHandler.connectedVersion:void 0}get active(){return this.state===Z.ACTIVE}_changeState(t){this.state=t,this.onChangeState(t)}constructor(t={}){this.stompVersions=D.default,this.connectionTimeout=0,this.reconnectDelay=5e3,this._nextReconnectDelay=0,this.maxReconnectDelay=15*60*1e3,this.reconnectTimeMode=Mr.LINEAR,this.heartbeatIncoming=1e4,this.heartbeatOutgoing=1e4,this.heartbeatStrategy=it.Interval,this.splitLargeFrames=!1,this.maxWebSocketChunkSize=8*1024,this.forceBinaryWSFrames=!1,this.appendMissingNULLonIncoming=!1,this.discardWebsocketOnCommFailure=!1,this.state=Z.INACTIVE;let r=()=>{};this.debug=r,this.beforeConnect=r,this.onConnect=r,this.onDisconnect=r,this.onUnhandledMessage=r,this.onUnhandledReceipt=r,this.onUnhandledFrame=r,this.onStompError=r,this.onWebSocketClose=r,this.onWebSocketError=r,this.logRawCommunication=!1,this.onChangeState=r,this.connectHeaders={},this._disconnectHeaders={},this.configure(t)}configure(t){Object.assign(this,t),this.maxReconnectDelay>0&&this.maxReconnectDelay<this.reconnectDelay&&(this.debug(`Warning: maxReconnectDelay (${this.maxReconnectDelay}ms) is less than reconnectDelay (${this.reconnectDelay}ms). Using reconnectDelay as the maxReconnectDelay delay.`),this.maxReconnectDelay=this.reconnectDelay)}activate(){let t=()=>{if(this.active){this.debug("Already ACTIVE, ignoring request to activate");return}this._changeState(Z.ACTIVE),this._nextReconnectDelay=this.reconnectDelay,this._connect()};this.state===Z.DEACTIVATING?(this.debug("Waiting for deactivation to finish before activating"),this.deactivate().then(()=>{t()})):t()}_connect(){return kn(this,null,function*(){if(yield this.beforeConnect(this),this._stompHandler){this.debug("There is already a stompHandler, skipping the call to connect");return}if(!this.active){this.debug("Client has been marked inactive, will not attempt to connect");return}this.connectionTimeout>0&&(this._connectionWatcher&&clearTimeout(this._connectionWatcher),this._connectionWatcher=setTimeout(()=>{this.connected||(this.debug(`Connection not established in ${this.connectionTimeout}ms, closing socket`),this.forceDisconnect())},this.connectionTimeout)),this.debug("Opening Web Socket...");let t=this._createWebSocket();this._stompHandler=new Ar(this,t,{debug:this.debug,stompVersions:this.stompVersions,connectHeaders:this.connectHeaders,disconnectHeaders:this._disconnectHeaders,heartbeatIncoming:this.heartbeatIncoming,heartbeatOutgoing:this.heartbeatOutgoing,heartbeatStrategy:this.heartbeatStrategy,splitLargeFrames:this.splitLargeFrames,maxWebSocketChunkSize:this.maxWebSocketChunkSize,forceBinaryWSFrames:this.forceBinaryWSFrames,logRawCommunication:this.logRawCommunication,appendMissingNULLonIncoming:this.appendMissingNULLonIncoming,discardWebsocketOnCommFailure:this.discardWebsocketOnCommFailure,onConnect:r=>{if(this._connectionWatcher&&(clearTimeout(this._connectionWatcher),this._connectionWatcher=void 0),!this.active){this.debug("STOMP got connected while deactivate was issued, will disconnect now"),this._disposeStompHandler();return}this.onConnect(r)},onDisconnect:r=>{this.onDisconnect(r)},onStompError:r=>{this.onStompError(r)},onWebSocketClose:r=>{this._stompHandler=void 0,this.state===Z.DEACTIVATING&&this._changeState(Z.INACTIVE),this.onWebSocketClose(r),this.active&&this._schedule_reconnect()},onWebSocketError:r=>{this.onWebSocketError(r)},onUnhandledMessage:r=>{this.onUnhandledMessage(r)},onUnhandledReceipt:r=>{this.onUnhandledReceipt(r)},onUnhandledFrame:r=>{this.onUnhandledFrame(r)}}),this._stompHandler.start()})}_createWebSocket(){let t;if(this.webSocketFactory)t=this.webSocketFactory();else if(this.brokerURL)t=new WebSocket(this.brokerURL,this.stompVersions.protocolVersions());else throw new Error("Either brokerURL or webSocketFactory must be provided");return t.binaryType="arraybuffer",t}_schedule_reconnect(){this._nextReconnectDelay>0&&(this.debug(`STOMP: scheduling reconnection in ${this._nextReconnectDelay}ms`),this._reconnector=setTimeout(()=>{this.reconnectTimeMode===Mr.EXPONENTIAL&&(this._nextReconnectDelay=this._nextReconnectDelay*2,this.maxReconnectDelay!==0&&(this._nextReconnectDelay=Math.min(this._nextReconnectDelay,this.maxReconnectDelay))),this._connect()},this._nextReconnectDelay))}deactivate(){return kn(this,arguments,function*(t={}){let r=t.force||!1,n=this.active,i;if(this.state===Z.INACTIVE)return this.debug("Already INACTIVE, nothing more to do"),Promise.resolve();if(this._changeState(Z.DEACTIVATING),this._nextReconnectDelay=0,this._reconnector&&(clearTimeout(this._reconnector),this._reconnector=void 0),this._stompHandler&&this.webSocket.readyState!==me.CLOSED){let s=this._stompHandler.onWebSocketClose;i=new Promise((o,a)=>{this._stompHandler.onWebSocketClose=c=>{s(c),o()}})}else return this._changeState(Z.INACTIVE),Promise.resolve();return r?this._stompHandler?.discardWebsocket():n&&this._disposeStompHandler(),i})}forceDisconnect(){this._stompHandler&&this._stompHandler.forceDisconnect()}_disposeStompHandler(){this._stompHandler&&this._stompHandler.dispose()}publish(t){this._checkConnection(),this._stompHandler.publish(t)}_checkConnection(){if(!this.connected)throw new TypeError("There is no underlying STOMP connection")}watchForReceipt(t,r){this._checkConnection(),this._stompHandler.watchForReceipt(t,r)}subscribe(t,r,n={}){return this._checkConnection(),this._stompHandler.subscribe(t,r,n)}unsubscribe(t,r={}){this._checkConnection(),this._stompHandler.unsubscribe(t,r)}begin(t){return this._checkConnection(),this._stompHandler.begin(t)}commit(t){this._checkConnection(),this._stompHandler.commit(t)}abort(t){this._checkConnection(),this._stompHandler.abort(t)}ack(t,r,n={}){this._checkConnection(),this._stompHandler.ack(t,r,n)}nack(t,r,n={}){this._checkConnection(),this._stompHandler.nack(t,r,n)}};var sh=dh(Vl());var Ll=(()=>{class e{constructor(r,n){this._renderer=r,this._elementRef=n,this.onChange=i=>{},this.onTouched=()=>{}}setProperty(r,n){this._renderer.setProperty(this._elementRef.nativeElement,r,n)}registerOnTouched(r){this.onTouched=r}registerOnChange(r){this.onChange=r}setDisabledState(r){this.setProperty("disabled",r)}static{this.\u0275fac=function(n){return new(n||e)(I(qn),I(Rn))}}static{this.\u0275dir=Q({type:e})}}return e})(),ng=(()=>{class e extends Ll{static{this.\u0275fac=(()=>{let r;return function(i){return(r||(r=Fn(e)))(i||e)}})()}static{this.\u0275dir=Q({type:e,features:[Ee]})}}return e})(),jl=new tt("");var ig={provide:jl,useExisting:xt(()=>Mn),multi:!0};function sg(){let e=$n()?$n().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}var og=new tt(""),Mn=(()=>{class e extends Ll{constructor(r,n,i){super(r,n),this._compositionMode=i,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!sg())}writeValue(r){let n=r??"";this.setProperty("value",n)}_handleInput(r){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(r)}_compositionStart(){this._composing=!0}_compositionEnd(r){this._composing=!1,this._compositionMode&&this.onChange(r)}static{this.\u0275fac=function(n){return new(n||e)(I(qn),I(Rn),I(og,8))}}static{this.\u0275dir=Q({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(n,i){n&1&&Ne("input",function(o){return i._handleInput(o.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(o){return i._compositionEnd(o.target.value)})},features:[Dt([ig]),Ee]})}}return e})();function ag(e){return e==null||(typeof e=="string"||Array.isArray(e))&&e.length===0}var _s=new tt(""),Gl=new tt("");function cg(e){return ag(e.value)?{required:!0}:null}function Pl(e){return null}function Wl(e){return e!=null}function zl(e){return Vs(e)?Ss(e):e}function $l(e){let t={};return e.forEach(r=>{t=r!=null?T(T({},t),r):t}),Object.keys(t).length===0?null:t}function Kl(e,t){return t.map(r=>r(e))}function ug(e){return!e.validate}function Xl(e){return e.map(t=>ug(t)?t:r=>t.validate(r))}function lg(e){if(!e)return null;let t=e.filter(Wl);return t.length==0?null:function(r){return $l(Kl(r,t))}}function vs(e){return e!=null?lg(Xl(e)):null}function hg(e){if(!e)return null;let t=e.filter(Wl);return t.length==0?null:function(r){let n=Kl(r,t).map(zl);return Ds(n).pipe(Ms($l))}}function ys(e){return e!=null?hg(Xl(e)):null}function Tl(e,t){return e===null?[t]:Array.isArray(e)?[...e,t]:[e,t]}function dg(e){return e._rawValidators}function fg(e){return e._rawAsyncValidators}function ms(e){return e?Array.isArray(e)?e:[e]:[]}function Cn(e,t){return Array.isArray(e)?e.includes(t):e===t}function Fl(e,t){let r=ms(t);return ms(e).forEach(i=>{Cn(r,i)||r.push(i)}),r}function Rl(e,t){return ms(t).filter(r=>!Cn(e,r))}var En=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=vs(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=ys(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t=void 0){this.control&&this.control.reset(t)}hasError(t,r){return this.control?this.control.hasError(t,r):!1}getError(t,r){return this.control?this.control.getError(t,r):null}},Et=class extends En{get formDirective(){return null}get path(){return null}},dr=class extends En{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},wn=class{constructor(t){this._cd=t}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},pg={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},Ev=ie(T({},pg),{"[class.ng-submitted]":"isSubmitted"}),Yl=(()=>{class e extends wn{constructor(r){super(r)}static{this.\u0275fac=function(n){return new(n||e)(I(dr,2))}}static{this.\u0275dir=Q({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(n,i){n&2&&Un("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},features:[Ee]})}}return e})(),Jl=(()=>{class e extends wn{constructor(r){super(r)}static{this.\u0275fac=function(n){return new(n||e)(I(Et,10))}}static{this.\u0275dir=Q({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(n,i){n&2&&Un("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},features:[Ee]})}}return e})();var ar="VALID",bn="INVALID",bt="PENDING",cr="DISABLED",wt=class{},xn=class extends wt{constructor(t,r){super(),this.value=t,this.source=r}},lr=class extends wt{constructor(t,r){super(),this.pristine=t,this.source=r}},hr=class extends wt{constructor(t,r){super(),this.touched=t,this.source=r}},Ct=class extends wt{constructor(t,r){super(),this.status=t,this.source=r}};function Ql(e){return(Dn(e)?e.validators:e)||null}function gg(e){return Array.isArray(e)?vs(e):e||null}function Zl(e,t){return(Dn(t)?t.asyncValidators:e)||null}function mg(e){return Array.isArray(e)?ys(e):e||null}function Dn(e){return e!=null&&!Array.isArray(e)&&typeof e=="object"}function _g(e,t,r){let n=e.controls;if(!(t?Object.keys(n):n).length)throw new vr(1e3,"");if(!n[r])throw new vr(1001,"")}function vg(e,t,r){e._forEachChild((n,i)=>{if(r[i]===void 0)throw new vr(1002,"")})}var On=class{constructor(t,r){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=null,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this._status=At(()=>this.statusReactive()),this.statusReactive=St(void 0),this._pristine=At(()=>this.pristineReactive()),this.pristineReactive=St(!0),this._touched=At(()=>this.touchedReactive()),this.touchedReactive=St(!1),this._events=new Os,this.events=this._events.asObservable(),this._onDisabledChange=[],this._assignValidators(t),this._assignAsyncValidators(r)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get status(){return we(this.statusReactive)}set status(t){we(()=>this.statusReactive.set(t))}get valid(){return this.status===ar}get invalid(){return this.status===bn}get pending(){return this.status==bt}get disabled(){return this.status===cr}get enabled(){return this.status!==cr}get pristine(){return we(this.pristineReactive)}set pristine(t){we(()=>this.pristineReactive.set(t))}get dirty(){return!this.pristine}get touched(){return we(this.touchedReactive)}set touched(t){we(()=>this.touchedReactive.set(t))}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._assignValidators(t)}setAsyncValidators(t){this._assignAsyncValidators(t)}addValidators(t){this.setValidators(Fl(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(Fl(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(Rl(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(Rl(t,this._rawAsyncValidators))}hasValidator(t){return Cn(this._rawValidators,t)}hasAsyncValidator(t){return Cn(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){let r=this.touched===!1;this.touched=!0;let n=t.sourceControl??this;this._parent&&!t.onlySelf&&this._parent.markAsTouched(ie(T({},t),{sourceControl:n})),r&&t.emitEvent!==!1&&this._events.next(new hr(!0,n))}markAllAsTouched(t={}){this.markAsTouched({onlySelf:!0,emitEvent:t.emitEvent,sourceControl:this}),this._forEachChild(r=>r.markAllAsTouched(t))}markAsUntouched(t={}){let r=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let n=t.sourceControl??this;this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0,emitEvent:t.emitEvent,sourceControl:n})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t,n),r&&t.emitEvent!==!1&&this._events.next(new hr(!1,n))}markAsDirty(t={}){let r=this.pristine===!0;this.pristine=!1;let n=t.sourceControl??this;this._parent&&!t.onlySelf&&this._parent.markAsDirty(ie(T({},t),{sourceControl:n})),r&&t.emitEvent!==!1&&this._events.next(new lr(!1,n))}markAsPristine(t={}){let r=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let n=t.sourceControl??this;this._forEachChild(i=>{i.markAsPristine({onlySelf:!0,emitEvent:t.emitEvent})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t,n),r&&t.emitEvent!==!1&&this._events.next(new lr(!0,n))}markAsPending(t={}){this.status=bt;let r=t.sourceControl??this;t.emitEvent!==!1&&(this._events.next(new Ct(this.status,r)),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.markAsPending(ie(T({},t),{sourceControl:r}))}disable(t={}){let r=this._parentMarkedDirty(t.onlySelf);this.status=cr,this.errors=null,this._forEachChild(i=>{i.disable(ie(T({},t),{onlySelf:!0}))}),this._updateValue();let n=t.sourceControl??this;t.emitEvent!==!1&&(this._events.next(new xn(this.value,n)),this._events.next(new Ct(this.status,n)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(ie(T({},t),{skipPristineCheck:r}),this),this._onDisabledChange.forEach(i=>i(!0))}enable(t={}){let r=this._parentMarkedDirty(t.onlySelf);this.status=ar,this._forEachChild(n=>{n.enable(ie(T({},t),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(ie(T({},t),{skipPristineCheck:r}),this),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(t,r){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine({},r),this._parent._updateTouched({},r))}setParent(t){this._parent=t}getRawValue(){return this.value}updateValueAndValidity(t={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let n=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===ar||this.status===bt)&&this._runAsyncValidator(n,t.emitEvent)}let r=t.sourceControl??this;t.emitEvent!==!1&&(this._events.next(new xn(this.value,r)),this._events.next(new Ct(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(ie(T({},t),{sourceControl:r}))}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(r=>r._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?cr:ar}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t,r){if(this.asyncValidator){this.status=bt,this._hasOwnPendingAsyncValidator={emitEvent:r!==!1};let n=zl(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(i=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(i,{emitEvent:r,shouldHaveEmitted:t})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let t=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,t}return!1}setErrors(t,r={}){this.errors=t,this._updateControlsErrors(r.emitEvent!==!1,this,r.shouldHaveEmitted)}get(t){let r=t;return r==null||(Array.isArray(r)||(r=r.split(".")),r.length===0)?null:r.reduce((n,i)=>n&&n._find(i),this)}getError(t,r){let n=r?this.get(r):this;return n&&n.errors?n.errors[t]:null}hasError(t,r){return!!this.getError(t,r)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t,r,n){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),(t||n)&&this._events.next(new Ct(this.status,r)),this._parent&&this._parent._updateControlsErrors(t,r,n)}_initObservables(){this.valueChanges=new Ot,this.statusChanges=new Ot}_calculateStatus(){return this._allControlsDisabled()?cr:this.errors?bn:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(bt)?bt:this._anyControlsHaveStatus(bn)?bn:ar}_anyControlsHaveStatus(t){return this._anyControls(r=>r.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t,r){let n=!this._anyControlsDirty(),i=this.pristine!==n;this.pristine=n,this._parent&&!t.onlySelf&&this._parent._updatePristine(t,r),i&&this._events.next(new lr(this.pristine,r))}_updateTouched(t={},r){this.touched=this._anyControlsTouched(),this._events.next(new hr(this.touched,r)),this._parent&&!t.onlySelf&&this._parent._updateTouched(t,r)}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){Dn(t)&&t.updateOn!=null&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){let r=this._parent&&this._parent.dirty;return!t&&!!r&&!this._parent._anyControlsDirty()}_find(t){return null}_assignValidators(t){this._rawValidators=Array.isArray(t)?t.slice():t,this._composedValidatorFn=gg(this._rawValidators)}_assignAsyncValidators(t){this._rawAsyncValidators=Array.isArray(t)?t.slice():t,this._composedAsyncValidatorFn=mg(this._rawAsyncValidators)}},Sn=class extends On{constructor(t,r,n){super(Ql(r),Zl(n,r)),this.controls=t,this._initObservables(),this._setUpdateStrategy(r),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,r){return this.controls[t]?this.controls[t]:(this.controls[t]=r,r.setParent(this),r._registerOnCollectionChange(this._onCollectionChange),r)}addControl(t,r,n={}){this.registerControl(t,r),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}removeControl(t,r={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}setControl(t,r,n={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],r&&this.registerControl(t,r),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,r={}){vg(this,!0,t),Object.keys(t).forEach(n=>{_g(this,!0,n),this.controls[n].setValue(t[n],{onlySelf:!0,emitEvent:r.emitEvent})}),this.updateValueAndValidity(r)}patchValue(t,r={}){t!=null&&(Object.keys(t).forEach(n=>{let i=this.controls[n];i&&i.patchValue(t[n],{onlySelf:!0,emitEvent:r.emitEvent})}),this.updateValueAndValidity(r))}reset(t={},r={}){this._forEachChild((n,i)=>{n.reset(t?t[i]:null,{onlySelf:!0,emitEvent:r.emitEvent})}),this._updatePristine(r,this),this._updateTouched(r,this),this.updateValueAndValidity(r)}getRawValue(){return this._reduceChildren({},(t,r,n)=>(t[n]=r.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(r,n)=>n._syncPendingControls()?!0:r);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(r=>{let n=this.controls[r];n&&t(n,r)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(let[r,n]of Object.entries(this.controls))if(this.contains(r)&&t(n))return!0;return!1}_reduceValue(){let t={};return this._reduceChildren(t,(r,n,i)=>((n.enabled||this.disabled)&&(r[i]=n.value),r))}_reduceChildren(t,r){let n=t;return this._forEachChild((i,s)=>{n=r(n,i,s)}),n}_allControlsDisabled(){for(let t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(t){return this.controls.hasOwnProperty(t)?this.controls[t]:null}};var bs=new tt("CallSetDisabledState",{providedIn:"root",factory:()=>Cs}),Cs="always";function yg(e,t){return[...t.path,e]}function eh(e,t,r=Cs){th(e,t),t.valueAccessor.writeValue(e.value),(e.disabled||r==="always")&&t.valueAccessor.setDisabledState?.(e.disabled),Cg(e,t),wg(e,t),Eg(e,t),bg(e,t)}function ql(e,t){e.forEach(r=>{r.registerOnValidatorChange&&r.registerOnValidatorChange(t)})}function bg(e,t){if(t.valueAccessor.setDisabledState){let r=n=>{t.valueAccessor.setDisabledState(n)};e.registerOnDisabledChange(r),t._registerOnDestroy(()=>{e._unregisterOnDisabledChange(r)})}}function th(e,t){let r=dg(e);t.validator!==null?e.setValidators(Tl(r,t.validator)):typeof r=="function"&&e.setValidators([r]);let n=fg(e);t.asyncValidator!==null?e.setAsyncValidators(Tl(n,t.asyncValidator)):typeof n=="function"&&e.setAsyncValidators([n]);let i=()=>e.updateValueAndValidity();ql(t._rawValidators,i),ql(t._rawAsyncValidators,i)}function Cg(e,t){t.valueAccessor.registerOnChange(r=>{e._pendingValue=r,e._pendingChange=!0,e._pendingDirty=!0,e.updateOn==="change"&&rh(e,t)})}function Eg(e,t){t.valueAccessor.registerOnTouched(()=>{e._pendingTouched=!0,e.updateOn==="blur"&&e._pendingChange&&rh(e,t),e.updateOn!=="submit"&&e.markAsTouched()})}function rh(e,t){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function wg(e,t){let r=(n,i)=>{t.valueAccessor.writeValue(n),i&&t.viewToModelUpdate(n)};e.registerOnChange(r),t._registerOnDestroy(()=>{e._unregisterOnChange(r)})}function xg(e,t){e==null,th(e,t)}function Og(e,t){if(!e.hasOwnProperty("model"))return!1;let r=e.model;return r.isFirstChange()?!0:!Object.is(t,r.currentValue)}function Sg(e){return Object.getPrototypeOf(e.constructor)===ng}function Mg(e,t){e._syncPendingControls(),t.forEach(r=>{let n=r.control;n.updateOn==="submit"&&n._pendingChange&&(r.viewToModelUpdate(n._pendingValue),n._pendingChange=!1)})}function Dg(e,t){if(!t)return null;Array.isArray(t);let r,n,i;return t.forEach(s=>{s.constructor===Mn?r=s:Sg(s)?n=s:i=s}),i||n||r||null}var Ag={provide:Et,useExisting:xt(()=>Es)},ur=Promise.resolve(),Es=(()=>{class e extends Et{get submitted(){return we(this.submittedReactive)}constructor(r,n,i){super(),this.callSetDisabledState=i,this._submitted=At(()=>this.submittedReactive()),this.submittedReactive=St(!1),this._directives=new Set,this.ngSubmit=new Ot,this.form=new Sn({},vs(r),ys(n))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(r){ur.then(()=>{let n=this._findContainer(r.path);r.control=n.registerControl(r.name,r.control),eh(r.control,r,this.callSetDisabledState),r.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(r)})}getControl(r){return this.form.get(r.path)}removeControl(r){ur.then(()=>{let n=this._findContainer(r.path);n&&n.removeControl(r.name),this._directives.delete(r)})}addFormGroup(r){ur.then(()=>{let n=this._findContainer(r.path),i=new Sn({});xg(i,r),n.registerControl(r.name,i),i.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(r){ur.then(()=>{let n=this._findContainer(r.path);n&&n.removeControl(r.name)})}getFormGroup(r){return this.form.get(r.path)}updateModel(r,n){ur.then(()=>{this.form.get(r.path).setValue(n)})}setValue(r){this.control.setValue(r)}onSubmit(r){return this.submittedReactive.set(!0),Mg(this.form,this._directives),this.ngSubmit.emit(r),r?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(r=void 0){this.form.reset(r),this.submittedReactive.set(!1)}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(r){return r.pop(),r.length?this.form.get(r):this.form}static{this.\u0275fac=function(n){return new(n||e)(I(_s,10),I(Gl,10),I(bs,8))}}static{this.\u0275dir=Q({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(n,i){n&1&&Ne("submit",function(o){return i.onSubmit(o)})("reset",function(){return i.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Dt([Ag]),Ee]})}}return e})();function Ul(e,t){let r=e.indexOf(t);r>-1&&e.splice(r,1)}function Hl(e){return typeof e=="object"&&e!==null&&Object.keys(e).length===2&&"value"in e&&"disabled"in e}var Ng=class extends On{constructor(t=null,r,n){super(Ql(r),Zl(n,r)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(t),this._setUpdateStrategy(r),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Dn(r)&&(r.nonNullable||r.initialValueIsDefault)&&(Hl(t)?this.defaultValue=t.value:this.defaultValue=t)}setValue(t,r={}){this.value=this._pendingValue=t,this._onChange.length&&r.emitModelToViewChange!==!1&&this._onChange.forEach(n=>n(this.value,r.emitViewToModelChange!==!1)),this.updateValueAndValidity(r)}patchValue(t,r={}){this.setValue(t,r)}reset(t=this.defaultValue,r={}){this._applyFormState(t),this.markAsPristine(r),this.markAsUntouched(r),this.setValue(this.value,r),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){Ul(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){Ul(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(t){Hl(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}};var Ig={provide:dr,useExisting:xt(()=>ws)},Bl=Promise.resolve(),ws=(()=>{class e extends dr{constructor(r,n,i,s,o,a){super(),this._changeDetectorRef=o,this.callSetDisabledState=a,this.control=new Ng,this._registered=!1,this.name="",this.update=new Ot,this._parent=r,this._setValidators(n),this._setAsyncValidators(i),this.valueAccessor=Dg(this,s)}ngOnChanges(r){if(this._checkForErrors(),!this._registered||"name"in r){if(this._registered&&(this._checkName(),this.formDirective)){let n=r.name.previousValue;this.formDirective.removeControl({name:n,path:this._getPath(n)})}this._setUpControl()}"isDisabled"in r&&this._updateDisabled(r),Og(r,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(r){this.viewModel=r,this.update.emit(r)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){eh(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(r){Bl.then(()=>{this.control.setValue(r,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(r){let n=r.isDisabled.currentValue,i=n!==0&&zn(n);Bl.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(r){return this._parent?yg(r,this._parent):[r]}static{this.\u0275fac=function(n){return new(n||e)(I(Et,9),I(_s,10),I(Gl,10),I(jl,10),I(Ts,8),I(bs,8))}}static{this.\u0275dir=Q({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Dt([Ig]),Ee,Tn]})}}return e})(),nh=(()=>{class e{static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275dir=Q({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}}return e})();var kg=(()=>{class e{constructor(){this._validator=Pl}ngOnChanges(r){if(this.inputName in r){let n=this.normalizeInput(r[this.inputName].currentValue);this._enabled=this.enabled(n),this._validator=this._enabled?this.createValidator(n):Pl,this._onChange&&this._onChange()}}validate(r){return this._validator(r)}registerOnValidatorChange(r){this._onChange=r}enabled(r){return r!=null}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275dir=Q({type:e,features:[Tn]})}}return e})();var Vg={provide:_s,useExisting:xt(()=>xs),multi:!0};var xs=(()=>{class e extends kg{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=zn,this.createValidator=r=>cg}enabled(r){return r}static{this.\u0275fac=(()=>{let r;return function(i){return(r||(r=Fn(e)))(i||e)}})()}static{this.\u0275dir=Q({type:e,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(n,i){n&2&&Ns("required",i._enabled?"":null)},inputs:{required:"required"},features:[Dt([Vg]),Ee]})}}return e})();var Pg=(()=>{class e{static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275mod=Pn({type:e})}static{this.\u0275inj=Vn({})}}return e})();var ih=(()=>{class e{static withConfig(r){return{ngModule:e,providers:[{provide:bs,useValue:r.callSetDisabledState??Cs}]}}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275mod=Pn({type:e})}static{this.\u0275inj=Vn({imports:[Pg]})}}return e})();var Fg=["messageArea"],Rg=["messageInput"],qg=(e,t,r)=>({"chat-message":e,"own-message":t,"event-message":r});function Ug(e,t){if(e&1){let r=wr();S(0,"div",4)(1,"div",5)(2,"h1",6),W(3,"Type your username to enter the Chatroom"),A(),S(4,"form",7),Ne("ngSubmit",function(i){rt(r);let s=k();return nt(s.connect(i))}),S(5,"div",8)(6,"input",9),Wn("ngModelChange",function(i){rt(r);let s=k();return Gn(s.inputUsername,i)||(s.inputUsername=i),nt(i)}),A()(),S(7,"div",8)(8,"button",10),W(9,"Start Chatting"),A()()()()()}if(e&2){let r=k();x(6),jn("ngModel",r.inputUsername),x(2),H("disabled",!r.inputUsername.trim())}}function Hg(e,t){if(e&1&&(S(0,"div",22),W(1),A()),e&2){let r=k(2);x(),Mt(" ",r.connectingMessage," ")}}function Bg(e,t){if(e&1&&(S(0,"div",23),W(1),A()),e&2){let r=k(2);x(),Mt(" ",r.connectionError," ")}}function Lg(e,t){if(e&1&&(Cr(0),S(1,"i",26),W(2),A(),S(3,"span",27),W(4),A(),Er()),e&2){let r=k(2).$implicit,n=k(2);x(),Is("background-color",n.getAvatarColor(r.sender)),x(),Mt(" ",r.sender?r.sender[0]:"?"," "),x(2),xr(r.sender)}}function jg(e,t){if(e&1&&(Cr(0),Ae(1,Lg,5,4,"ng-container",25),S(2,"p"),W(3),A(),Er()),e&2){let r=k().$implicit,n=k(2);x(),H("ngIf",r.sender!==n.username),x(2),xr(r.content)}}function Gg(e,t){if(e&1&&(Cr(0),S(1,"p"),W(2),A(),Er()),e&2){let r=k().$implicit;x(2),xr(r.content)}}function Wg(e,t){if(e&1&&(S(0,"li",24),Ae(1,jg,4,2,"ng-container",25)(2,Gg,3,1,"ng-container",25),A()),e&2){let r=t.$implicit,n=k(2);H("ngClass",ks(3,qg,r.type==="CHAT",r.type==="CHAT"&&r.sender===n.username,r.type==="JOIN"||r.type==="LEAVE")),x(),H("ngIf",r.type==="CHAT"),x(),H("ngIf",r.type==="JOIN"||r.type==="LEAVE")}}function zg(e,t){if(e&1){let r=wr();S(0,"form",28),Ne("ngSubmit",function(i){rt(r);let s=k(2);return nt(s.sendMessage(i))}),S(1,"div",8)(2,"div",29)(3,"input",30,1),Wn("ngModelChange",function(i){rt(r);let s=k(2);return Gn(s.newMessageContent,i)||(s.newMessageContent=i),nt(i)}),A(),S(5,"button",31),As(),S(6,"svg",32),br(7,"path",33),A()()()()()}if(e&2){let r=k(2);x(3),jn("ngModel",r.newMessageContent),x(2),H("disabled",!r.newMessageContent.trim())}}function $g(e,t){if(e&1){let r=wr();S(0,"div",11)(1,"div",12)(2,"div",13)(3,"h2"),W(4," Angular WebSocket Chat "),A(),S(5,"div",14)(6,"div",15),W(7),A(),S(8,"button",16),Ne("click",function(){rt(r);let i=k();return nt(i.clearChat())}),W(9,"Clear Chat"),A()()(),Ae(10,Hg,2,1,"div",17)(11,Bg,2,1,"div",18),S(12,"ul",19,0),Ae(14,Wg,3,7,"li",20),A(),Ae(15,zg,8,2,"form",21),A()()}if(e&2){let r=k();x(7),Mt("Online Users: ",r.onlineUsersCount,""),x(3),H("ngIf",r.connectingMessage&&!r.connectionError),x(),H("ngIf",r.connectionError),x(3),H("ngForOf",r.messages),x(),H("ngIf",!r.connectionError&&!r.connectingMessage)}}var oh=(()=>{class e{messageArea;messageInput;showUsernamePage=!0;showChatPage=!1;username=null;inputUsername="";newMessageContent="";stompClient=null;connectingMessage="Connecting...";connectionError=null;onlineUsersCount=0;messages=[];colors=["#2196F3","#32c787","#00BCD4","#ff5652","#ffc107","#ff85af","#FF9800","#39bbb0"];scrollToBottomNeeded=!1;constructor(){}ngOnInit(){this.loadMessagesFromLocalStorage()}ngAfterViewChecked(){this.scrollToBottomNeeded&&(this.scrollToBottom(),this.scrollToBottomNeeded=!1)}ngOnDestroy(){this.stompClient&&this.stompClient.active&&(this.username&&this.stompClient.publish({destination:"/app/chat.removeUser",body:JSON.stringify({sender:this.username,type:"LEAVE"})}),this.stompClient.deactivate(),console.log("Disconnected from WebSocket."))}connect(r){if(r.preventDefault(),this.username=this.inputUsername.trim(),this.username){this.showUsernamePage=!1,this.showChatPage=!0,this.connectingMessage="Connecting...",this.connectionError=null;let n=()=>new sh.default("http://localhost:8080/ws");this.stompClient=new Nr({webSocketFactory:n,connectHeaders:{},debug:i=>{console.log("STOMP DEBUG: "+i)},reconnectDelay:5e3,heartbeatIncoming:4e3,heartbeatOutgoing:4e3}),this.stompClient.onConnect=i=>{this.onConnected()},this.stompClient.onStompError=i=>{this.onError("Broker reported error: "+i.headers.message+". Additional details: "+i.body)},this.stompClient.onWebSocketError=i=>{this.onError("WebSocket error: "+i.toString())},this.stompClient.activate()}}onConnected(){console.log("Connected to WebSocket!"),this.connectingMessage="",this.stompClient&&this.username&&(this.stompClient.subscribe("/topic/public",r=>{this.onMessageReceived(JSON.parse(r.body))}),this.stompClient.publish({destination:"/app/chat.addUser",body:JSON.stringify({sender:this.username,type:"JOIN"})}))}onError(r){this.connectionError=`Could not connect to WebSocket server. ${r}. Please refresh this page to try again!`,this.connectingMessage="",console.error(r)}sendMessage(r){r.preventDefault();let n=this.newMessageContent.trim();if(n&&this.stompClient&&this.stompClient.active&&this.username){let i={sender:this.username,content:n,type:"CHAT"};this.stompClient.publish({destination:"/app/chat.sendMessage",body:JSON.stringify(i)}),this.newMessageContent="",this.messageInput&&this.messageInput.nativeElement.focus()}}onMessageReceived(r){console.log("Received message: ",r),r.usersOnline!==void 0&&this.updateOnlineUsers(r.usersOnline);let n=T({},r);r.type==="JOIN"?n.content=r.sender+" joined!":r.type==="LEAVE"&&(n.content=r.sender+" left!"),this.messages.push(n),this.saveMessageToLocalStorage(n),this.scrollToBottomNeeded=!0}updateOnlineUsers(r){console.log("Online users count: "+r),this.onlineUsersCount=r}saveMessageToLocalStorage(r){if(typeof window<"u"&&window.localStorage){let n=JSON.parse(localStorage.getItem("chatMessages")||"[]");n.push(r),localStorage.setItem("chatMessages",JSON.stringify(n))}}loadMessagesFromLocalStorage(){if(typeof window<"u"&&window.localStorage){let r=JSON.parse(localStorage.getItem("chatMessages")||"[]");this.messages=r.map(n=>{let i=T({},n);return n.type==="JOIN"&&!n.content.includes("joined!")?i.content=n.sender+" joined!":n.type==="LEAVE"&&!n.content.includes("left!")&&(i.content=n.sender+" left!"),i}),this.messages.length>0&&(this.scrollToBottomNeeded=!0)}else this.messages=[]}getAvatarColor(r){if(!r)return"#ccc";let n=0;for(let s=0;s<r.length;s++)n=31*n+r.charCodeAt(s);let i=Math.abs(n%this.colors.length);return this.colors[i]}clearChat(){localStorage.removeItem("chatMessages"),this.messages=[]}scrollToBottom(){try{this.messageArea&&this.messageArea.nativeElement&&(this.messageArea.nativeElement.scrollTop=this.messageArea.nativeElement.scrollHeight)}catch(r){console.error("Could not scroll to bottom:",r)}}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=yr({type:e,selectors:[["app-home"]],viewQuery:function(n,i){if(n&1&&(Hn(Fg,5),Hn(Rg,5)),n&2){let s;Bn(s=Ln())&&(i.messageArea=s.first),Bn(s=Ln())&&(i.messageInput=s.first)}},standalone:!0,features:[Or],decls:2,vars:2,consts:[["messageArea",""],["messageInput",""],["id","username-page",4,"ngIf"],["id","chat-page",4,"ngIf"],["id","username-page"],[1,"username-page-container"],[1,"title"],["id","usernameForm","name","usernameForm",3,"ngSubmit"],[1,"form-group"],["type","text","id","name","placeholder","Username","autocomplete","off","name","inputUsername","required","",1,"form-control",3,"ngModelChange","ngModel"],["type","submit",1,"accent","username-submit",3,"disabled"],["id","chat-page"],[1,"chat-container"],[1,"chat-header"],[1,"header-actions"],["id","onlineUsers"],[3,"click"],["class","connecting",4,"ngIf"],["class","connection-error","style","color: red; padding: 10px; text-align: center;",4,"ngIf"],["id","messageArea"],[3,"ngClass",4,"ngFor","ngForOf"],["id","messageForm","name","messageForm",3,"ngSubmit",4,"ngIf"],[1,"connecting"],[1,"connection-error",2,"color","red","padding","10px","text-align","center"],[3,"ngClass"],[4,"ngIf"],[1,"avatar"],[1,"username-display"],["id","messageForm","name","messageForm",3,"ngSubmit"],[1,"input-group","clearfix"],["type","text","id","message","placeholder","Type a message...","autocomplete","off","name","newMessageContent",1,"form-control",3,"ngModelChange","ngModel"],["type","submit","aria-label","Send message",1,"primary","send-button",3,"disabled"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","currentColor","width","20px","height","20px"],["d","M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"]],template:function(n,i){n&1&&Ae(0,Ug,10,2,"div",2)(1,$g,16,5,"div",3),n&2&&(H("ngIf",i.showUsernamePage),x(),H("ngIf",i.showChatPage))},dependencies:[Hs,Rs,qs,Us,ih,nh,Mn,Yl,Jl,xs,ws,Es],styles:["body[_ngcontent-%COMP%]{font-family:Arial,sans-serif;margin:0;background-color:#f4f4f4;color:#333}.hidden[_ngcontent-%COMP%]{display:none!important}.form-group[_ngcontent-%COMP%]{margin-bottom:15px}.form-control[_ngcontent-%COMP%]{width:calc(100% - 22px);padding:10px;border:1px solid #ddd;border-radius:4px;box-sizing:border-box}button[_ngcontent-%COMP%]{padding:10px 15px;border:none;border-radius:4px;cursor:pointer;font-weight:700}button.primary[_ngcontent-%COMP%]{background-color:#007bff;color:#fff}button.primary[_ngcontent-%COMP%]:disabled{background-color:#a0cfff;cursor:not-allowed}button.accent[_ngcontent-%COMP%]{background-color:#28a745;color:#fff}button.accent[_ngcontent-%COMP%]:disabled{background-color:#8fdfa0;cursor:not-allowed}#username-page[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100vh;text-align:center}.username-page-container[_ngcontent-%COMP%]{background:#fff;padding:30px;border-radius:8px;box-shadow:0 0 10px #0000001a}.username-page-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{margin-top:0;color:#555}.username-submit[_ngcontent-%COMP%]{width:100%}#chat-page[_ngcontent-%COMP%]{display:flex;justify-content:center;padding-top:20px}.chat-container[_ngcontent-%COMP%]{width:100%;max-width:700px;background:#fff;border-radius:8px;box-shadow:0 0 15px #00000026;display:flex;flex-direction:column;height:calc(100vh - 40px);max-height:800px}.chat-header[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;padding:15px;border-top-left-radius:8px;border-top-right-radius:8px}.chat-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.2em;display:inline-block}.chat-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-top:8px;font-size:.9em}.chat-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff;padding:5px 10px;font-size:.8em}.connecting[_ngcontent-%COMP%], .connection-error[_ngcontent-%COMP%]{padding:15px;text-align:center;color:#777;font-style:italic}.connection-error[_ngcontent-%COMP%]{color:red;font-weight:700}#messageArea[_ngcontent-%COMP%]{list-style-type:none;padding:15px;margin:0;overflow-y:auto;flex-grow:1;border-bottom:1px solid #eee;border-top:1px solid #eee;display:flex;flex-direction:column;background-color:#e5ddd5}#messageArea[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:10px;padding:8px 12px;border-radius:7.5px;max-width:75%;word-wrap:break-word;line-height:1.4;box-shadow:0 1px .5px #00000021}#messageArea[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;padding:0}#messageArea[_ngcontent-%COMP%]   .chat-message[_ngcontent-%COMP%]:not(.own-message){background-color:#fff;align-self:flex-start;position:relative;padding-left:50px}#messageArea[_ngcontent-%COMP%]   .chat-message[_ngcontent-%COMP%]:not(.own-message)   .avatar[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;color:#fff;text-align:center;line-height:32px;font-style:normal;font-weight:700;position:absolute;left:8px;top:50%;transform:translateY(-50%)}#messageArea[_ngcontent-%COMP%]   .chat-message[_ngcontent-%COMP%]:not(.own-message)   .username-display[_ngcontent-%COMP%]{font-weight:700;display:block;margin-bottom:4px;font-size:.8em;color:#555}#messageArea[_ngcontent-%COMP%]   .chat-message.own-message[_ngcontent-%COMP%]{background-color:#dcf8c6;color:#303030;align-self:flex-end}#messageArea[_ngcontent-%COMP%]   .event-message[_ngcontent-%COMP%]{background-color:#e1f3fb;color:#505050;font-style:italic;font-size:.85em;text-align:center;align-self:center;padding:5px 10px;border-radius:15px;max-width:60%;box-shadow:none}#messageForm[_ngcontent-%COMP%]{padding:10px 15px;border-top:1px solid #ddd;background-color:#f0f0f0;align-items:center}.input-group[_ngcontent-%COMP%]{display:flex;flex-grow:1;align-items:center}#messageForm[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{flex-grow:1;border-radius:20px;padding:10px 15px;border:1px solid #ccc;margin-right:10px;height:40px;box-sizing:border-box}#messageForm[_ngcontent-%COMP%]   button.primary.send-button[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;border-radius:50%;width:40px;height:40px;padding:0;display:flex;align-items:center;justify-content:center;border:none;cursor:pointer;transition:background-color .2s ease}#messageForm[_ngcontent-%COMP%]   button.primary.send-button[_ngcontent-%COMP%]:disabled{background-color:#a0cfff;cursor:not-allowed}#messageForm[_ngcontent-%COMP%]   button.primary.send-button[_ngcontent-%COMP%]:disabled   svg[_ngcontent-%COMP%]{fill:#777}#messageForm[_ngcontent-%COMP%]   button.primary.send-button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px;fill:#fff}#messageForm[_ngcontent-%COMP%]   button.primary.send-button[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#0056b3}"]})}return e})();var ah=[{path:"",component:oh}];var ch={providers:[Ps({eventCoalescing:!0}),$s(ah),Gs(),Bs(Ls())]};var Kg={providers:[Ws()]},uh=Fs(ch,Kg);var Xg=()=>js(Xs,uh),zv=Xg;export{po as a,Co as b,_ as c,ce as d,zv as e};
